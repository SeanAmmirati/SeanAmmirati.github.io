cont_table <- matrix(c(5, 15, 30, 20), nrow = 2,
dimnames = list(c('Has traveled outside US','Has not traveled outside US'), c('Non-Artist','Artist')))
cont_table <- matrix(c(5, 15, 30, 20), nrow = 2,
dimnames = list(c('Has traveled outside US','Has not traveled outside US'),
c('Non-Artist','Artist')))
chi_squared_test <- function(cont_table,
cont_table_exp = t(matrix(rep(apply(cont_table,2,sum)/ncol(cont_table),
ncol(cont_table)),
ncol = ncol(cont_table)))){
df <- (nrow(cont_table) - 1)*(ncol(cont_table) - 1)
zsq <- sum((cont_table - cont_table_exp)^2 / cont_table_exp)
probability <- 1 - pchisq(zsq, df)
return(probability)
}
ret <- constant*(p^obs_rows_w_prior[1,1])*((1 - p)^obs_rows_w_prior[1,2])*\
obs_row_totals = apply(cont_table, 1, sum)
obs_coordinates = c(cont_table)
obs_rows_w_prior = cont_table - 1
constant <- (prod(gamma(obs_row_totals)) / (prod(gamma(obs_coordinates))))
ret <- constant*(p^obs_rows_w_prior[1,1])*((1 - p)^obs_rows_w_prior[1,2])*\
ret <- constant*(p^obs_rows_w_prior[1,1])*((1 - p)^obs_rows_w_prior[1,2])* /
ret <- constant*(p^obs_rows_w_prior[1,1])*((1 - p)^obs_rows_w_prior[1,2])*
(q^obs_rows_w_prior[2,1])*((1 - q)^obs_rows_w_prior[2,2])
posteriorb <- function(p,q, cont_table, num = FALSE){
if (num == TRUE) {
if (p >= q) {
return(0)
}
}
obs_row_totals = apply(cont_table, 1, sum)
obs_coordinates = c(cont_table)
obs_rows_w_prior = cont_table - 1
constant <- (prod(gamma(obs_row_totals)) / (prod(gamma(obs_coordinates))))
ret <- constant*(p^obs_rows_w_prior[1,1])*((1 - p)^obs_rows_w_prior[1,2])*
(q^obs_rows_w_prior[2,1])*((1 - q)^obs_rows_w_prior[2,2])
return(ret)
}
estimb1 <- approx(posteriorc,num = TRUE,
cont_table = cont_table,
sigmasq = 1) /
approx(posteriorc,num = FALSE,
cont_table = cont_table,
sigmasq = 1)
source("../../../statsworks/R/stats_examples/bayesian_analysis/Binomial Discrete Updater/binomial_discrete_updater_functions.R")
