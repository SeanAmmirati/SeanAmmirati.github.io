
<!DOCTYPE HTML>
<!--
	Dopetrope 2.0 by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
			<title>Stats Works</title>
			<meta http-equiv="content-type" content="text/html; charset=utf-8" />
			<meta charset="utf-8" />
			<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,900,300italic" rel="stylesheet" />
				<link rel="stylesheet" href="/theme/css/pygment.css" />
			<noscript>
				<link rel="stylesheet" href="/theme/css/skel-noscript.css" />
				<link rel="stylesheet" href="/theme/css/style.css" />
				<link rel="stylesheet" href="/theme/css/style-desktop.css" />
			</noscript>
	</head>
	<body class="no-sidebar">
		<!-- Header Wrapper -->
			<div id="header-wrapper">
				<div class="container">
					<div class="row">
						<div class="12u">
						
							<!-- Header -->
								<section id="header">
									
									<!-- Logo -->
									<h1><a href="https://seanammirati.github.io/">Stats Works</a></h1>
									
									<!-- Nav -->
										<nav id="nav">
											<ul>
														<li><a href="/">Home</a></li>
														<li><a href="/pages/topics">Topics</a></li>
														<li><a href="/pages/about">About</a></li>
											</ul>
										</nav>

								</section>

						</div>
					</div>
				</div>
			</div>
		
		<!-- Main Wrapper -->
			<div id="main-wrapper">
				<div class="container">
<div class="row">
	<div class="12u">
			<section>
				<div>
					<div class="row">
						<div class="12u skel-cell-mainContent">
							<!-- Content -->
								<article class="box is-post">
									<div class="post-infos">
										<ul class="tags">
											<li><a class="button" href="/category/r_markdown">R_markdown</a></li>
										</ul>
									</div>

									<div class="pennant pennant-alt date">2018-03-09</div>
									<h2>Approaches To Contingency Tables</h2>
									<h1>Chi-Squared Test</h1>
<p>Here we will be investigating a few ways of dealing with contingency tables.</p>
<p>The first two are standard procedures in frequentist statistics, the chi-squared test and the Fischer's Exact test.  </p>
<p>Consider a contingency table that looks like this:</p>
<div class="highlight"><pre><span class="code-line"><span></span>cont_table <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span> <span class="m">15</span><span class="p">,</span> <span class="m">30</span><span class="p">,</span> <span class="m">20</span><span class="p">),</span> nrow <span class="o">=</span> <span class="m">2</span><span class="p">,</span></span>
<span class="code-line">                     dimnames <span class="o">=</span> <span class="kt">list</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="s">&#39;Has traveled outside US&#39;</span><span class="p">,</span><span class="s">&#39;Has not traveled outside US&#39;</span><span class="p">),</span> </span>
<span class="code-line">                                     <span class="kt">c</span><span class="p">(</span><span class="s">&#39;Non-Artist&#39;</span><span class="p">,</span><span class="s">&#39;Artist&#39;</span><span class="p">)))</span></span>
<span class="code-line">cont_table</span>
</pre></div>


<div class="highlight"><pre><span class="code-line"><span></span>##                             Non-Artist Artist</span>
<span class="code-line">## Has traveled outside US              5     30</span>
<span class="code-line">## Has not traveled outside US         15     20</span>
</pre></div>


<p>Consider if we ask the question -- are artists and non-artists equally likely to travel outside of the US...?</p>
<p>The first approach we can take is the chi-squared test, which is an asymptotically accurate. If each was equally likely to travel, we would expect a cont_table like this :</p>
<div class="highlight"><pre><span class="code-line"><span></span>cont_table_exp <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">25</span><span class="p">,</span> <span class="m">25</span><span class="p">),</span> nrow <span class="o">=</span> <span class="m">2</span><span class="p">,</span></span>
<span class="code-line">                         dimnames <span class="o">=</span> <span class="kt">list</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="s">&#39;Has traveled outside US&#39;</span><span class="p">,</span><span class="s">&#39;Has not traveled outside US&#39;</span><span class="p">),</span> </span>
<span class="code-line">                                         <span class="kt">c</span><span class="p">(</span><span class="s">&#39;Non-Artist&#39;</span><span class="p">,</span><span class="s">&#39;Artist&#39;</span><span class="p">)))</span></span>
<span class="code-line"></span>
<span class="code-line">cont_table_exp</span>
</pre></div>


<div class="highlight"><pre><span class="code-line"><span></span>##                             Non-Artist Artist</span>
<span class="code-line">## Has traveled outside US             10     25</span>
<span class="code-line">## Has not traveled outside US         10     25</span>
</pre></div>


<p>If we assume that artistry and travel likelihood are independent, our sum of the differences from this expectation divided by the square root of the expectation
should be roughly normally distributed and so the squared differences will be approximately <span class="math">\(\chi ^{2}\left ( 1 \right )\)</span>.</p>
<p>Here, we assume that the observed counts are Poisson distributed, so that their expectation and variance are defined by <span class="math">\(E_{i}\)</span> and <span class="math">\(\frac{1}{\sqrt{E_{i}}}\)</span>.
As <span class="math">\(n \to \infty\)</span>, this is asymptotically normal GIVEN the hypothesis of independence.</p>
<p>Because we know the row and column totals, in this case we have a degree of freedom of 1 -- when one value is known on this contingency table,
given the row and column totals we can deduce the others. In order to calculate an (approximate) probability of this example given independence
(the null hypothesis), we perform the following calculation.</p>
<div class="highlight"><pre><span class="code-line"><span></span>zsq <span class="o">&lt;-</span> <span class="kp">sum</span><span class="p">((</span>cont_table <span class="o">-</span> cont_table_exp<span class="p">)</span><span class="o">^</span><span class="m">2</span> <span class="o">/</span> cont_table_exp<span class="p">)</span></span>
<span class="code-line"><span class="m">1</span> <span class="o">-</span> pchisq<span class="p">(</span>zsq<span class="p">,</span><span class="m">1</span><span class="p">)</span></span>
</pre></div>


<div class="highlight"><pre><span class="code-line"><span></span>## [1] 0.008150972</span>
</pre></div>


<p>So we would reject the notion of independence based on these observations.</p>
<p>More generally:</p>
<div class="highlight"><pre><span class="code-line"><span></span>chi_squared_test <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>cont_table<span class="p">,</span></span>
<span class="code-line">                             cont_table_exp <span class="o">=</span> <span class="kp">t</span><span class="p">(</span><span class="kt">matrix</span><span class="p">(</span><span class="kp">rep</span><span class="p">(</span><span class="kp">apply</span><span class="p">(</span>cont_table<span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="kp">sum</span><span class="p">)</span><span class="o">/</span><span class="kp">ncol</span><span class="p">(</span>cont_table<span class="p">),</span></span>
<span class="code-line">                                                           <span class="kp">ncol</span><span class="p">(</span>cont_table<span class="p">)),</span> </span>
<span class="code-line">                                                       ncol <span class="o">=</span> <span class="kp">ncol</span><span class="p">(</span>cont_table<span class="p">)))){</span></span>
<span class="code-line">  df <span class="o">&lt;-</span> <span class="p">(</span><span class="kp">nrow</span><span class="p">(</span>cont_table<span class="p">)</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="kp">ncol</span><span class="p">(</span>cont_table<span class="p">)</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span></span>
<span class="code-line">  zsq <span class="o">&lt;-</span> <span class="kp">sum</span><span class="p">((</span>cont_table <span class="o">-</span> cont_table_exp<span class="p">)</span><span class="o">^</span><span class="m">2</span> <span class="o">/</span> cont_table_exp<span class="p">)</span></span>
<span class="code-line">  probability <span class="o">&lt;-</span> <span class="m">1</span> <span class="o">-</span> pchisq<span class="p">(</span>zsq<span class="p">,</span> df<span class="p">)</span></span>
<span class="code-line">  <span class="kr">return</span><span class="p">(</span>probability<span class="p">)</span></span>
<span class="code-line"><span class="p">}</span></span>
</pre></div>


<h1>Fischer Exact Test</h1>
<p>However, the chi-squared test is only asympotically accurate. If we consider the counts to be distributed as a hyper-geometric distribution,
we can use Fisher's Exact Test to calculate the probability of independence.</p>
<p>Given some values in the contingency table, the probability of any distribution of values given independence is as follows:</p>
<div class="highlight"><pre><span class="code-line"><span></span>probfun <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>i<span class="p">,</span> j<span class="p">,</span> n<span class="p">,</span> m<span class="p">){</span></span>
<span class="code-line">  <span class="c1"># i: particular coordinate (for instance, non-artist, has not traveled)</span></span>
<span class="code-line">  <span class="c1"># j: the column total for the particular coordinate (for instance, non-artists)</span></span>
<span class="code-line">  <span class="c1"># n: the row total for particular coordinate (for instance, people who have traveled)</span></span>
<span class="code-line">  <span class="c1"># m: the row total for the other coordinate (for instance, people who have not traveled)</span></span>
<span class="code-line"></span>
<span class="code-line">  <span class="kp">choose</span><span class="p">(</span>m<span class="p">,</span>i<span class="p">)</span><span class="o">*</span><span class="kp">choose</span><span class="p">(</span>n<span class="p">,(</span>j <span class="o">-</span> i<span class="p">))</span><span class="o">/</span><span class="kp">choose</span><span class="p">(</span>m <span class="o">+</span> n<span class="p">,</span>j<span class="p">)</span></span>
<span class="code-line"><span class="p">}</span></span>
</pre></div>


<p>This will give us the exact probability of each coordinate. If we wanted to find the probability that non-artist, people who traveled is
less than or equal to five, we would do the following in this case:</p>
<div class="highlight"><pre><span class="code-line"><span></span><span class="kp">sum</span><span class="p">(</span><span class="kp">sapply</span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="m">5</span><span class="p">,</span><span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> probfun<span class="p">(</span>x<span class="p">,</span> <span class="m">20</span><span class="p">,</span> <span class="m">35</span><span class="p">,</span> <span class="m">35</span><span class="p">)))</span></span>
</pre></div>


<div class="highlight"><pre><span class="code-line"><span></span>## [1] 0.008027371</span>
</pre></div>


<p>This shows that the probability of what we have observed is quite small if the columns and rows are independent. We again reject independence with 1% significance.</p>
<p>The results of this test and the chisquared test are also quite close, which is as expected. As n goes to infinity, the chisquared test converges to the Fischer's Exact test.</p>
<p>This is the hyper geometric distribution, which is included in R. The results are the same:</p>
<div class="highlight"><pre><span class="code-line"><span></span>phyper<span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">35</span><span class="p">,</span><span class="m">35</span><span class="p">,</span><span class="m">20</span><span class="p">)</span><span class="c1">##same result</span></span>
</pre></div>


<div class="highlight"><pre><span class="code-line"><span></span>## [1] 0.008027371</span>
</pre></div>


<p>These are well known tests we can make. However, we can add some bayesian analysis to the mix here!</p>
<h1>Bayesian Approach -- using Beta distributions</h1>
<p>Let us assume that the probability of having traveled for artists and non-artists can be modeled using a Beta distribution. That is
[P(travel \mid nonartist) = p \sim \ {Beta}(\alpha <em 1>{1}, \beta </em>)]  and [P(travel \mid artist) = q \sim \ {Beta}(\alpha <em 2>{2}, \beta </em>)]</p>
<p>We can now make an approximation to determine the probability that <span class="math">\(p &lt; q\)</span>. That is, we want the posterior distribution of <span class="math">\(p\)</span> and <span class="math">\(q\)</span> given
our contingency table. Because our likelihood is multinomial, we know that the posterior distribution is also Beta distributed. After doing some
manipulations, we can write the posterior distribution of <span class="math">\(p\)</span> and <span class="math">\(q\)</span>.</p>
<p>If we assume uninformative priors, we set <span class="math">\(\alpha = \beta = 1\)</span> to get the following:</p>
<div class="highlight"><pre><span class="code-line"><span></span>posteriorb <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>p<span class="p">,</span><span class="kp">q</span><span class="p">,</span> cont_table<span class="p">,</span> num <span class="o">=</span> <span class="kc">FALSE</span><span class="p">){</span></span>
<span class="code-line">  <span class="kr">if</span> <span class="p">(</span>num <span class="o">==</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="p">{</span></span>
<span class="code-line">    <span class="kr">if</span> <span class="p">(</span>p <span class="o">&gt;=</span> <span class="kp">q</span><span class="p">)</span> <span class="p">{</span></span>
<span class="code-line">      <span class="kr">return</span><span class="p">(</span><span class="m">0</span><span class="p">)</span></span>
<span class="code-line">    <span class="p">}</span></span>
<span class="code-line">  <span class="p">}</span></span>
<span class="code-line"></span>
<span class="code-line">  obs_row_totals <span class="o">=</span> <span class="kp">apply</span><span class="p">(</span>cont_table<span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="kp">sum</span><span class="p">)</span></span>
<span class="code-line">  obs_coordinates <span class="o">=</span> <span class="kt">c</span><span class="p">(</span>cont_table<span class="p">)</span></span>
<span class="code-line">  obs_rows_w_prior <span class="o">=</span> cont_table <span class="o">-</span> <span class="m">1</span></span>
<span class="code-line"></span>
<span class="code-line">  constant <span class="o">&lt;-</span> <span class="p">(</span><span class="kp">prod</span><span class="p">(</span><span class="kp">gamma</span><span class="p">(</span>obs_row_totals<span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="kp">prod</span><span class="p">(</span><span class="kp">gamma</span><span class="p">(</span>obs_coordinates<span class="p">))))</span></span>
<span class="code-line">  ret <span class="o">&lt;-</span> constant<span class="o">*</span><span class="p">(</span>p<span class="o">^</span>obs_rows_w_prior<span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">((</span><span class="m">1</span> <span class="o">-</span> p<span class="p">)</span><span class="o">^</span>obs_rows_w_prior<span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">])</span> <span class="o">*</span></span>
<span class="code-line">          <span class="p">(</span><span class="kp">q</span><span class="o">^</span>obs_rows_w_prior<span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">((</span><span class="m">1</span> <span class="o">-</span> <span class="kp">q</span><span class="p">)</span><span class="o">^</span>obs_rows_w_prior<span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">])</span></span>
<span class="code-line">  <span class="kr">return</span><span class="p">(</span>ret<span class="p">)</span></span>
<span class="code-line"><span class="p">}</span></span>
</pre></div>


<p>Note that this will only work for 2x2 contingency tables and assuming an (invalid) prior of <span class="math">\(\alpha = \beta = 1\)</span>  for each prior. If we wanted to include
prior information, we could change these for each prior, which would result in a different number being added/subtracted above.</p>
<p>This joint distribution is somewhat difficult to determine analytically. There are alternative
here to estimate this probability (gtools, MCMCpack, etc), but I have included a numerical approximation.</p>
<div class="highlight"><pre><span class="code-line"><span></span>approx <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>f<span class="p">,</span>num<span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span> <span class="p">{</span></span>
<span class="code-line">  <span class="kp">sum</span><span class="p">(</span><span class="kp">sapply</span><span class="p">(</span><span class="kp">seq</span><span class="p">(</span><span class="m">0.01</span><span class="p">,</span><span class="m">0.99</span><span class="p">,</span><span class="m">0.01</span><span class="p">),</span><span class="kr">function</span><span class="p">(</span>p<span class="p">)</span> <span class="kp">sapply</span><span class="p">(</span><span class="kp">seq</span><span class="p">(</span><span class="m">0.01</span><span class="p">,</span><span class="m">0.99</span><span class="p">,</span><span class="m">0.01</span><span class="p">),</span> <span class="kr">function</span><span class="p">(</span><span class="kp">q</span><span class="p">)</span> f<span class="p">(</span>p<span class="p">,</span><span class="kp">q</span><span class="p">,</span>num<span class="p">,</span><span class="kc">...</span><span class="p">))))</span></span>
<span class="code-line"><span class="p">}</span></span>
<span class="code-line"></span>
<span class="code-line">estim <span class="o">&lt;-</span> approx<span class="p">(</span>posteriorb<span class="p">,</span><span class="kc">TRUE</span><span class="p">,</span> cont_table <span class="o">=</span> cont_table<span class="p">)</span><span class="o">/</span>approx<span class="p">(</span>posteriorb<span class="p">,</span> cont_table <span class="o">=</span> cont_table<span class="p">)</span></span>
<span class="code-line">estim</span>
</pre></div>


<div class="highlight"><pre><span class="code-line"><span></span>## [1] 0.9965571</span>
</pre></div>


<p>We estimate <span class="math">\({P}(p&lt; q) = .9966\)</span>. Here, we individual values of p,q and compare their pdf evaluations at each point.</p>
<h1>Bayesian Approach -- Assuming Dependence Structure</h1>
<p>Let's use another formulation that allows <span class="math">\(p\)</span> and <span class="math">\(q\)</span> to depend on one another. That is, it is unlikely that <span class="math">\(p\)</span> and <span class="math">\(q\)</span> are distributed independently --
there is an underlying 'willing to travel' factor that is prevalent in both groups. We saw this when we considered the earlier tests.<br>
If we assume then that <span class="math">\(\ln \frac{p}{1-p} - \ln \frac{q}{1-q}\)</span>, the difference in their log odds ratios is normally distributed with mean 0 and some arbitrary variance,
we are allowing for some dependencies based on the value of sigma squared that we select.
Selecting a small value of sigmasquared introduces a higher dependency structure.
We can then test, for a certain level of expected variance in their difference, whether they are independent or not.</p>
<div class="highlight"><pre><span class="code-line"><span></span>posteriorc <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>p<span class="p">,</span><span class="kp">q</span><span class="p">,</span> cont_table<span class="p">,</span> num <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> sigmasq <span class="o">=</span> <span class="m">1</span><span class="p">){</span></span>
<span class="code-line">  <span class="kr">if</span> <span class="p">(</span>num <span class="o">==</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="p">{</span></span>
<span class="code-line">    <span class="kr">if</span> <span class="p">(</span>p <span class="o">&gt;=</span> <span class="kp">q</span><span class="p">)</span> <span class="p">{</span></span>
<span class="code-line">      <span class="kr">return</span><span class="p">(</span><span class="m">0</span><span class="p">)</span></span>
<span class="code-line">    <span class="p">}</span></span>
<span class="code-line">  <span class="p">}</span></span>
<span class="code-line"></span>
<span class="code-line">  obs_rows_w_prior <span class="o">=</span> cont_table <span class="o">-</span> <span class="m">1</span></span>
<span class="code-line"></span>
<span class="code-line">  logit1 <span class="o">&lt;-</span> <span class="kp">log</span><span class="p">((</span>p<span class="o">/</span><span class="p">(</span><span class="m">1</span> <span class="o">-</span> p<span class="p">)))</span></span>
<span class="code-line">  logit2 <span class="o">&lt;-</span> <span class="kp">log</span><span class="p">((</span><span class="kp">q</span><span class="o">/</span><span class="p">(</span><span class="m">1</span> <span class="o">-</span> <span class="kp">q</span><span class="p">)))</span></span>
<span class="code-line"></span>
<span class="code-line">  expo <span class="o">&lt;-</span> <span class="kp">exp</span><span class="p">((</span><span class="o">-</span><span class="p">(</span>logit1 <span class="o">-</span> logit2<span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="m">2</span><span class="o">*</span>sigmasq<span class="p">))</span></span>
<span class="code-line">  ret <span class="o">&lt;-</span> expo<span class="o">*</span><span class="p">(</span>p<span class="o">^</span>obs_rows_w_prior<span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">((</span><span class="m">1</span> <span class="o">-</span> p<span class="p">)</span><span class="o">^</span>obs_rows_w_prior<span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">])</span> <span class="o">*</span></span>
<span class="code-line">          <span class="p">(</span><span class="kp">q</span><span class="o">^</span>obs_rows_w_prior<span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">((</span><span class="m">1</span> <span class="o">-</span> <span class="kp">q</span><span class="p">)</span><span class="o">^</span>obs_rows_w_prior<span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">])</span></span>
<span class="code-line">  <span class="kr">return</span><span class="p">(</span>ret<span class="p">)</span></span>
<span class="code-line"><span class="p">}</span></span>
</pre></div>


<p>We then approximate <span class="math">\({P}(p&lt; q)\)</span> given various assumed sigmas in the prior.</p>
<div class="highlight"><pre><span class="code-line"><span></span>estimb1 <span class="o">&lt;-</span> approx<span class="p">(</span>posteriorc<span class="p">,</span></span>
<span class="code-line">                  num <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span></span>
<span class="code-line">                  cont_table <span class="o">=</span> cont_table<span class="p">,</span> </span>
<span class="code-line">                  sigmasq <span class="o">=</span> <span class="m">1</span><span class="p">)</span> <span class="o">/</span></span>
<span class="code-line">           approx<span class="p">(</span>posteriorc<span class="p">,</span>num <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> </span>
<span class="code-line">                  cont_table <span class="o">=</span> cont_table<span class="p">,</span> </span>
<span class="code-line">                  sigmasq <span class="o">=</span> <span class="m">1</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line">estimb2 <span class="o">&lt;-</span> approx<span class="p">(</span>posteriorc<span class="p">,</span></span>
<span class="code-line">                  num <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span></span>
<span class="code-line">                  cont_table <span class="o">=</span> cont_table<span class="p">,</span> </span>
<span class="code-line">                  sigmasq <span class="o">=</span> <span class="m">.25</span><span class="p">)</span> <span class="o">/</span> </span>
<span class="code-line">           approx<span class="p">(</span>posteriorc<span class="p">,</span></span>
<span class="code-line">                  num <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> </span>
<span class="code-line">                  cont_table <span class="o">=</span> cont_table<span class="p">,</span> </span>
<span class="code-line">                  sigmasq <span class="o">=</span> <span class="m">.25</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line">estimb3 <span class="o">&lt;-</span> approx<span class="p">(</span>posteriorc<span class="p">,</span></span>
<span class="code-line">                  num <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span></span>
<span class="code-line">                  cont_table <span class="o">=</span> cont_table<span class="p">,</span> </span>
<span class="code-line">                  sigmasq <span class="o">=</span> <span class="m">4</span><span class="p">)</span> <span class="o">/</span></span>
<span class="code-line">           approx<span class="p">(</span>posteriorc<span class="p">,</span></span>
<span class="code-line">                  num <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span></span>
<span class="code-line">                  cont_table <span class="o">=</span> cont_table<span class="p">,</span> </span>
<span class="code-line">                  sigmasq <span class="o">=</span> <span class="m">4</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1"># sigmasq = 1</span></span>
<span class="code-line">estimb1</span>
</pre></div>


<div class="highlight"><pre><span class="code-line"><span></span>## [1] 0.9902318</span>
</pre></div>


<div class="highlight"><pre><span class="code-line"><span></span><span class="c1">#sigmasq = .25</span></span>
<span class="code-line">estimb2</span>
</pre></div>


<div class="highlight"><pre><span class="code-line"><span></span>## [1] 0.9610614</span>
</pre></div>


<div class="highlight"><pre><span class="code-line"><span></span><span class="c1">#sigma sq = 4</span></span>
<span class="code-line">estimb3</span>
</pre></div>


<div class="highlight"><pre><span class="code-line"><span></span>## [1] 0.9952399</span>
</pre></div>


<div class="highlight"><pre><span class="code-line"><span></span><span class="c1">#sigma sq = 400000 (close to complete independence)</span></span>
<span class="code-line">approx<span class="p">(</span>posteriorc<span class="p">,</span></span>
<span class="code-line">       num <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> </span>
<span class="code-line">       cont_table <span class="o">=</span> cont_table<span class="p">,</span> </span>
<span class="code-line">       sigmasq <span class="o">=</span> <span class="m">400000</span><span class="p">)</span> <span class="o">/</span> </span>
<span class="code-line">approx<span class="p">(</span>posteriorc<span class="p">,</span></span>
<span class="code-line">       num <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> </span>
<span class="code-line">       cont_table <span class="o">=</span> cont_table<span class="p">,</span> </span>
<span class="code-line">       sigmasq <span class="o">=</span> <span class="m">400000</span><span class="p">)</span></span>
</pre></div>


<div class="highlight"><pre><span class="code-line"><span></span>## [1] 0.9965571</span>
</pre></div>


<p>We see that the larger the variance, the higher <span class="math">\({P}(p&lt; q)\)</span> is. When we condsidered them to be independent, we got an estimate of
.9965571. It makes sense, then, that as we increase the variance, and therefore the two become closer to being
what we would consider as independent from one another, it approaches the value when they are assumed to be independent
explicitly. Considering them to have a small variance (.25) will lead to the probability p &lt; q to be smaller than any other
method, including the chisquare and Fischer Exact test. When we have a high variance (even at sigma sq = 4), we obtain a higher
probability that the two probabilities are different. The conclusion then is that the two groups are different from one another.</p>
<p>When the variance is small, we are less confident that the two groups are different from one another, both in prior and posterior distribution.</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
								</article>
						</div>
					</div>
				</div>
			</section>
	</div>
</div>

				</div>
			</div>

		<!-- Footer Wrapper -->
			<div id="footer-wrapper">
				<!-- Footer -->
					<section id="footer" class="container">
						<div class="row">
							<div class="8u">
								<section>
									<header>
										<h2>Latest articles</h2>
									</header>
									<ul class="dates">
										<li>
											<span class="date">Sep <strong>16</strong></span>
											<h3><a href="/category/Factor Analysis.html">Factor Analysis</a></h3>
											<p><p>A project detailing the methodology and use of Factor Analysis.</p></p>
										</li>
										<li>
											<span class="date">Sep <strong>09</strong></span>
											<h3><a href="/category/sumstatsmeasuresofspread.html">Summary Statistics Part 2: Measures of Spread</a></h3>
											<p><p>An overview of statistics and central tendency.</p></p>
										</li>
										<li>
											<span class="date">Sep <strong>02</strong></span>
											<h3><a href="/category/sumstatscentraltendency.html">Summary Statistics Part 1: Central Tendency</a></h3>
											<p><p>An overview of statistics and central tendency.</p></p>
										</li>
										<li>
											<span class="date">Mar <strong>09</strong></span>
											<h3><a href="/category/approaches-to-contingency-tables.html">Approaches To Contingency Tables</a></h3>
											<p><p>Some approaches to contingency tables using R and Bayesian Statistics</p></p>
										</li>
									</ul>
								</section>
							</div>
						</div>
						<div class="row">
							<div class="4u">
								<section>
									<header>
										<h2>Blogroll</h2>
									</header>
									<ul class="divided">
									</ul>
								</section>
							</div>
							<div class="4u">
								<section>
									<header>
										<h2>Categories</h2>
									</header>
									<ul class="divided">
											<li><a href="https://seanammirati.github.io//category/advanced-topics">Advanced Topics</a></li>
											<li><a href="https://seanammirati.github.io//category/r_markdown">r_markdown</a></li>
											<li><a href="https://seanammirati.github.io//category/statistics-beginner">Statistics, Beginner</a></li>
									</ul>
								</section>
							</div>
							<div class="4u">
							
								<section>
									<header>
										<h2>Contact</h2>
									</header>
									<ul class="social">
									</ul>
								</section>
							</div>
						</div>
					</section>
			</div>
		<script src="/theme/js/jquery.min.js"></script>
		<script src="/theme/js/jquery.dropotron.js"></script>
		<script src="/theme/js/config.js"></script>
		<script src="/theme/js/skel.min.js"></script>
		<script src="/theme/js/skel-panels.min.js"></script>
		<!--[if lte IE 8]><script src="js/html5shiv.js"></script><link rel="stylesheet" href="/theme/css/ie8.css" /><![endif]-->
	</body>
</html>