var tipuesearch = {"pages":[{"title":"About This Website","text":"Welcome to Stats Works! This website is dedicated to statistical approaches to various problems. Statistics and the analysis of data are becoming more and more relevant in the world today. With the introduction of machine learning techniques, statistics and computer science have become essential to the ability of business and governments' success. Unleashing the potential of information is more crucial than ever, and is having a remarkable impact on the world. This website is dedicated to personal projects surrounding both statistics and machine learning and shows how we can leverage the wealth of data in the world today to make actionable insights to further improve the world we live in. Parts of this website are also dedicated to explaining some basic statistical concepts to those who may have no background in statistics, or have a background in STEM but need a refresher on these topics. The author, Sean Ammirati, is a Data Scientist with a deep love and passion for statistics, programming and machine learning. The intention of creating this website is to demonstrate practical implementations of theoretical statistics as well as demystify some of the more complex topics in the dicipline. Sean has a Master's degree in Statistics from Hunter College.","tags":"About","url":"pages/about/","loc":"pages/about/"},{"title":"Heteroskedacity with Weighted Least Squares","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } An Approach to Solving Heteroskedacity when the Variance is a Multiplicative Constant One of the most widely known assumptions of linear regression is homoskedacity , that is that the variance of the errors are constant for all of the values (they do not depend on the particular observation). Weighted least squares is a way of dealing with this problem. We will detail the intuition and reasoning behind why this is the case. Consider a scale that measures two objects. For each object, we have some randomized error. Consider the weights of two objects, first alone and then together. That is, consider the following model: $$ y_{1} = \\alpha_{1} + \\varepsilon_{1} $$$$ y_{2} = \\alpha_{2} + \\varepsilon_{2} $$$$ y_{3} = \\alpha_{1} + \\alpha_{2}\\ + \\ \\varepsilon_{3} $$ This is like a regression model, in that we can solve for the alphas (the true weights) by the method of least squares. $${\\mathbf{y = X\\alpha + \\ \\varepsilon} } $$$$\\mathbf{X}&#94;{\\mathbf{T}}\\mathbf{X} = \\begin{bmatrix} 2 & 1 \\\\ 1 & 2 \\\\ \\end{bmatrix}$$$$ {(\\mathbf{X}&#94;{\\mathbf{T}}\\mathbf{X)}}&#94;{- 1} = \\frac{1}{3} \\begin{bmatrix} 2 & - 1 \\\\ -1 & 2 \\\\ \\end{bmatrix} $$$$ {(\\mathbf{X}&#94;{\\mathbf{T}}\\mathbf{X)})}&#94;{- 1}\\mathbf{X}&#94;{\\mathbf{T}}=\\frac{1}{3} \\begin{bmatrix} 2 & -1 & 1 \\\\ -1 & 2 & 1 \\\\ \\end{bmatrix} $$$$ \\widehat{\\mathbf{\\alpha}} = \\frac{1}{3}\\begin{bmatrix} 2y_{1} - y_{2} + y_{3} \\\\ -y_{1} + 2y_{2} + y_{3} \\\\ \\end{bmatrix} $$ Now consider that the random element is not equally variant for the two objects -- that is, that for both weights combined there is some multiplicative factor on the error $> 1$. That is, $$ \\begin{bmatrix} \\varepsilon_{1} \\\\ \\varepsilon_{2} \\\\ \\varepsilon_{3} \\\\ \\end{bmatrix} = \\mathbf{MVN}(0, \\Sigma) \\quad \\text{where } \\Sigma = \\begin{bmatrix} \\sigma&#94;{2} & 0 & 0 \\\\ 0 & \\sigma&#94;{2} & 0 \\\\ 0 & 0 & {k&#94;{2}\\sigma}&#94;{2} \\\\ \\end{bmatrix} $$ Note that this violates the least squares assumptions. One method to fix this issue is to transform the variables so they have equal variance, since $k$ is a numeric value $> 0$. Note that we can transform the third variable as follows: $$\\frac{y_{3}}{k} = \\frac{\\alpha_{1}}{k} + \\frac{\\alpha_{2}}{k}\\ + \\ \\frac{\\varepsilon_{3}}{k}$$ Now, $\\frac{\\varepsilon_{3}}{k}$ has variance $\\sigma&#94;{2}$. Let $$\\mathbf{y}&#94;{\\mathbf{*}} = \\begin{bmatrix} y_{1} \\\\ y_{2} \\\\ y_{3}/k \\\\ \\end{bmatrix} $$ $$ \\mathbf{X}&#94;{\\mathbf{*}} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1/k & 1/k \\\\ \\end{bmatrix} $$$$ \\mathbf{\\alpha}&#94;{\\mathbf{*}} = \\begin{bmatrix} \\alpha_{1} \\\\ \\alpha_{2} \\\\ \\end{bmatrix} $$$$ \\mathbf{\\varepsilon}&#94;{\\mathbf{*}} = \\begin{bmatrix} \\varepsilon_{1} \\\\ \\varepsilon_{2} \\\\ \\varepsilon_{3}/k \\\\ \\end{bmatrix} $$ Then we can solve as in the case of OLS: $${{\\widehat{\\mathbf{\\alpha}}}&#94;{*} = \\left( {\\mathbf{X}&#94;{\\mathbf{*}}}&#94;{\\mathbf{T}}\\mathbf{X}&#94;{\\mathbf{*}} \\right)&#94;{- 1}{\\mathbf{X}&#94;{\\mathbf{*}}}&#94;{\\mathbf{T}}\\mathbf{y}&#94;{\\mathbf{*}} }{{\\mathbf{X}&#94;{\\mathbf{*}}}&#94;{\\mathbf{T}}\\mathbf{X}&#94;{\\mathbf{*}}\\mathbf{= \\ }\\begin{bmatrix} \\frac{k&#94;{2} + 1}{k&#94;{2}} & \\frac{1}{k&#94;{2}} \\\\ \\frac{1}{k&#94;{2}} & \\frac{k&#94;{2} + 1}{k&#94;{2}} \\\\ \\end{bmatrix}}$$$$\\left( {\\mathbf{X}&#94;{\\mathbf{*}}}&#94;{\\mathbf{T}}\\mathbf{X}&#94;{\\mathbf{*}} \\right)&#94;{- 1} = \\frac{k&#94;{4}}{k&#94;{4} + 2k&#94;{2}}\\ \\begin{bmatrix} \\frac{k&#94;{2} + 1}{k&#94;{2}} & \\frac{- 1}{k&#94;{2}} \\\\ \\frac{- 1}{k&#94;{2}} & \\frac{k&#94;{2} + 1}{k&#94;{2}} \\\\ \\end{bmatrix}$$$$\\left( {\\mathbf{X}&#94;{\\mathbf{*}}}&#94;{\\mathbf{T}}\\mathbf{X}&#94;{\\mathbf{*}} \\right)&#94;{- 1}{\\mathbf{X}&#94;{\\mathbf{*}}}&#94;{\\mathbf{T}}\\mathbf{=}\\frac{k&#94;{4}}{k&#94;{4} + 2k&#94;{2}}\\begin{bmatrix} \\frac{k&#94;{2} + 1}{k&#94;{2}} & \\frac{- 1}{k&#94;{2}} & \\frac{1}{k} \\\\ \\frac{- 1}{k&#94;{2}} & \\frac{k&#94;{2} + 1}{k&#94;{2}} & \\frac{1}{k} \\\\ \\end{bmatrix}$$$${\\widehat{\\mathbf{\\alpha}}}&#94;{*}\\mathbf{=}\\frac{k&#94;{4}}{k&#94;{4} + 2k&#94;{2}}\\mathbf{\\ }\\begin{bmatrix} \\frac{k&#94;{2} + 1}{k&#94;{2}}y_{1} - \\frac{y_{2}}{k&#94;{2}} + \\frac{y_{3}}{k&#94;{2}} \\\\ \\frac{{- y}_{1}}{k&#94;{2}} + \\frac{k&#94;{2} + 1}{k&#94;{2}}y_{2} + \\frac{y_{3}}{k&#94;{2}} \\\\ \\end{bmatrix}$$$${\\widehat{\\mathbf{\\alpha}}}&#94;{*}\\mathbf{=}\\frac{k&#94;{2}}{k&#94;{4} + 2k&#94;{2}}\\mathbf{\\ }\\begin{bmatrix} \\mathbf{(}k&#94;{2} + 1)y_{1} - y_{2} + y_{3} \\\\ \\mathbf{-}y_{1}\\mathbf{+ (}k&#94;{2} + 1)y_{2} + y_{3} \\\\ \\end{bmatrix}$$ However, this is not a general solution. Consider instead the following: $$\\begin{bmatrix} \\varepsilon_{1} \\\\ \\varepsilon_{2} \\\\ \\varepsilon_{3} \\\\ \\end{bmatrix}\\mathbf{\\ \\sim\\ MVN(0, \\Sigma)\\ \\ } \\quad \\text{where } \\Sigma = \\begin{bmatrix} {a&#94;{2}\\sigma}&#94;{2} & 0 & 0 \\\\ 0 & b&#94;{2}\\sigma&#94;{2} & 0 \\\\ 0 & 0 & {c&#94;{2}\\sigma}&#94;{2} \\\\ \\end{bmatrix}$$ We could attempt to perform the same procedure, that is, divide $y_{1}$ by $a&#94;{2}$, $y_{2}$ by $b&#94;{2}$ and so on. However, this is arduous, and it would be convenient to use a matrix of weights to solve this. Let W be a matrix of the reciprocals of these constants. Using the same procedure as above, we can express $\\mathbf{y}&#94;{\\mathbf{*}}$ as $\\mathbf{W}&#94;{\\mathbf{1/2}}\\mathbf{\\ }\\mathbf{y}$ and $\\mathbf{X}&#94;{\\mathbf{*}}$ as $\\mathbf{W}&#94;{\\mathbf{1/2}}\\mathbf{X}$ Then our result is: $${\\widehat{\\mathbf{\\alpha}}}&#94;{*} = \\left( {\\mathbf{X}&#94;{\\mathbf{*}}}&#94;{\\mathbf{T}}\\mathbf{X}&#94;{\\mathbf{*}} \\right)&#94;{- 1}{\\mathbf{X}&#94;{\\mathbf{*}}}&#94;{\\mathbf{T}}\\mathbf{y}&#94;{\\mathbf{*}}$$$${\\widehat{\\mathbf{\\alpha}}}&#94;{*} = \\left( \\mathbf{X}&#94;{\\mathbf{T}}\\mathbf{\\text{WX}} \\right)&#94;{- 1}\\mathbf{X}&#94;{\\mathbf{T}}\\mathbf{W}\\mathbf{y}&#94;{\\mathbf{*}}$$ We can see that if W = $\\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & {1/k}&#94;{2} \\\\ \\end{bmatrix}\\mathbf{\\ }$ we get the same result as earlier. Code Implementation In [3]: ols_preds <- function ( X , y ) { return ( solve ( t ( X ) %*% X ) %*% t ( X ) %*% y ) } weighted_ols_preds <- function ( X , y , W ) { return ( solve ( t ( X ) %*% W %*% X ) %*% t ( X ) %*% W %*% y ) } In [6]: y <- c ( 41 , 53 , 97 ) X <- matrix ( c ( 1 , 0 , 1 , 0 , 1 , 1 ), nrow = 3 ) alphahat <- solve ( t ( X ) %*% X ) %*% t ( X ) alphahat %*% y 42 54 This calculates the predictions in the first case. In [7]: k <- 1.25 ystar <- y ystar [ 3 ] <- y [ 3 ] / k xstar <- matrix ( c ( 1 , 0 , 1 / k , 0 , 1 , 1 / k ), nrow = 3 ) alphahat <- solve ( t ( xstar ) %*% xstar ) %*% t ( xstar ) alphahat %*% ystar 41.84211 53.84211 This calculates the predictions in the second case Using the functions we get the same results: In [8]: ols_preds ( X , y ) W <- diag ( c ( rep ( 1 , 2 ), 1 / k &#94; 2 )) weighted_ols_preds ( X , y , W ) 42 54 41.84211 53.84211 if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Linear Models","url":"category/linear-models/heteroskedacity-with-weighted-least-squares.html","loc":"category/linear-models/heteroskedacity-with-weighted-least-squares.html"},{"title":"Constrained Least Squares","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } Consider the following: We wish to constrain the parameters of a linear model to have certain properties, for example, that the last coefficient is equal to 1, or that the sum of the coefficients are equal to one. How can we estimate the Least Squares Estimates using these constraints? Thus is constrained least squares, and this article will explore the theoretical basis for choosing a selection of coefficients that will minimize the least squares given some linear constraints on the coefficients. Constrained Least Squares -- Coefficient Calculation and Simulation We want to maximize the likelihood equation of $\\vec{\\beta}$. We know that $\\vec{y}$ in this context is normally distributed with mean $\\mathbf{X}\\vec{\\beta}$ and variance $\\sigma&#94;2$. This means that the distribution of $y_i$ given a vector of values $\\vec{x_i}$ is as follows: $$f_{Y}\\left( y_i \\middle|\\ \\vec{x}_i \\right) = {(2\\pi\\sigma&#94;{2})}&#94;{- 1/2}e&#94;{\\frac{- (y_i-\\vec{x}_i \\vec{\\beta})}{2\\sigma&#94;{2}}&#94;{2}}$$ So the likelihood of $\\vec{\\beta}$ is therefore: $$ L(\\vec{\\beta}, \\sigma&#94;{2} | \\vec{y}, \\mathbf{X}) = ( 2\\pi\\sigma&#94;{2})&#94;{- \\frac{N}{2}}e&#94;{- \\frac{\\sum_{i}&#94;{N}{(y_{i}-\\vec{x}_{i} \\vec{\\beta})}}{2\\sigma&#94;{2}}&#94;{2}} $$ Taking the natural logarithm gives us the log likelihood: $$l\\left( \\vec{\\beta},\\sigma&#94;{2} \\middle| y,\\mathbf{X} \\right) = - \\frac{1}{2\\sigma&#94;{2}}\\sum_{i}&#94;{N}{{(y_{i}-\\vec{x}_{i}\\vec{\\beta})}&#94;{2}-\\frac{N}{2}\\ln\\left( \\sigma&#94;{2} \\right)+ C}= - \\frac{1}{2\\sigma&#94;{2}}\\left( \\vec{y} - \\mathbf{\\mathbf{X}}\\vec{\\beta}&#94;{c} \\right)&#94;{\\intercal}\\left( \\vec{y} - \\mathbf{\\mathbf{X}}\\vec{\\beta}&#94;{c} \\right) - \\frac{N}{2}\\ln\\left( \\sigma&#94;{2} \\right)+ C$$ Here, I have truncated the result to only those involving $\\vec{\\beta}$ and $\\sigma&#94;{2}$, as we are only interested in maximizing with respect to $\\vec{\\beta}$ . Note that I have transitioned $\\sigma&#94;{2}$ to a constant, as we are assuming the errors are iid with constant variance $\\sigma&#94;{2}$. Here, we obtain the same result as minimizing the least squares estimator, so the MLE and the least squares estimators are the same. If we were unconstrained, we would simply take the partial derivative here with respect to $\\vec{\\beta}$ to estimate $\\vec{\\beta}$ using maximum likelihood. Since $\\sigma&#94;{2}$ is unconstrained, we can find the maximum likelihood estimator directly and use this to maximize with respect to $\\vec{\\beta}$. To do this, we differentiate the above equation with respect to $\\sigma&#94;2$. Doing so yields the normal estimate for $\\sigma&#94;{2}$: $${\\widehat{\\sigma}}&#94;{2} = - \\frac{1}{N}\\sum_{i}&#94;{N}{(y_{i}-x_{i}\\vec{\\beta}&#94;{c})}&#94;{2}=\\frac{1}{N}\\left(\\vec{y}-\\mathbf{\\mathbf{X}}\\vec{\\beta}&#94;{c} \\right)&#94;{\\intercal}\\left(\\vec{y}-\\mathbf{\\mathbf{X}}\\vec{\\beta}&#94;{c} \\right)$$ Where $\\vec{\\beta}&#94;{c}$ is our new constrained estimates. Plugging this back into the log likelihood equation yields: $$ l(\\vec{\\beta}&#94;{c} | \\vec{y},\\mathbf{\\mathbf{X}}) = - \\frac{N}{2}[{(\\vec{y} - \\mathbf{\\mathbf{X}}\\vec{\\beta}&#94;{c})}&#94;{\\intercal}( \\vec{y} - \\mathbf{\\mathbf{X}}\\vec{\\beta}&#94;{c} )]&#94;{-1} ( \\vec{y} - \\mathbf{\\mathbf{X}}\\vec{\\beta}&#94;{c})&#94;{\\intercal} \\vec{y} - \\mathbf{\\mathbf{X}}\\vec{\\beta}&#94;{c}) - \\frac{N}{2}\\ln( \\frac{1}{N}( \\vec{y} - \\mathbf{\\mathbf{X}}\\vec{\\beta}&#94;{c})&#94;{\\intercal}( \\vec{y} - \\mathbf{\\mathbf{X}}\\vec{\\beta}&#94;{c}))+ C $$$$l\\left( \\vec{\\beta} \\middle| \\vec{y},\\mathbf{X} \\right) = - \\frac{N}{2} - \\frac{N}{2}\\ln\\left( \\frac{1}{N}\\left( \\vec{y} -\\mathbf{\\mathbf{X}}\\vec{\\beta}&#94;{c} \\right)&#94;{\\intercal}\\left( \\vec{y} -\\mathbf{\\mathbf{X}}\\vec{\\beta}&#94;{c} \\right) \\right)+ C$$ However, we want to maximize the above equation with the constraint that: M$\\vec{\\beta}$ = $\\vec{d}$, where d is a known vector and M is an r x p matrix of rank $r < p$. This is an equality constraint. We can use the Lagrange multipliers to solve this maximization problem with such a constraint. We can see that, since the natural logarithm is a monotonically increasing function, and the division within the above logarithm is a constant, and that all other terms do not involve $\\beta$, maximizing the above equation with respect to$\\ \\vec{\\beta}&#94;{c}$ is equivalent to minimizing: $$f = \\left(\\vec{y}-\\mathbf{\\mathbf{X}}\\vec{\\beta}&#94;{c} \\right)&#94;{\\intercal}\\left(\\vec{y}-\\mathbf{\\mathbf{X}}\\vec{\\beta}&#94;{c} \\right) - \\vec{\\lambda}&#94;{\\intercal}\\left( M\\vec{\\beta}&#94;{c}\\ –\\ \\vec{d} \\right)$$ Where $\\vec{\\lambda}$ is the Lagrange multiplier (and so $f$ is the Lagrange function). The Lagrange multiplier is especially useful in this case, as we are trying to minimize the least square error with some constraint on the parameters. Multiplying the error by the transpose gives: $$f =\\vec{y}&#94;{\\intercal}\\vec{y} -\\vec{y}&#94;{\\intercal}\\mathbf{X}\\vec{\\beta}&#94;{c}-{{\\vec{\\beta}&#94;{c}}}&#94;{\\intercal}\\mathbf{X}&#94;{\\intercal}\\vec{y} + {{\\vec{\\beta}&#94;{c}}}&#94;{\\intercal}\\mathbf{X}&#94;{\\intercal}\\mathbf{X}\\vec{\\beta}&#94;{c}-\\vec{\\lambda}&#94;{\\intercal}\\left( M\\vec{\\beta}&#94;{c}\\ –\\ \\vec{d} \\right) = =\\vec{y}&#94;{\\intercal}\\vec{y} -2{{\\vec{\\beta}&#94;{c}}}&#94;{\\intercal}\\mathbf{X}&#94;{\\intercal}\\vec{y} + {{\\vec{\\beta}&#94;{c}}}&#94;{\\intercal}\\mathbf{X}&#94;{\\intercal}\\mathbf{X}\\vec{\\beta}&#94;{c}-\\vec{\\lambda}&#94;{\\intercal}\\left( M\\vec{\\beta}&#94;{c}\\ –\\ \\vec{d} \\right)$$ Now we take derivatives with respect to $\\vec{\\beta}&#94;{c}$ and $\\vec{\\lambda}$ to obtain $$\\frac{\\partial{f}}{\\partial{B}}= - 2\\mathbf{X}&#94;{\\intercal}\\vec{y}+2\\mathbf{X}&#94;{\\intercal}\\mathbf{X}\\vec{\\beta}&#94;{c}-M&#94;{\\intercal}\\vec{\\lambda}$$$$\\frac{\\partial{f}}{\\partial{\\lambda}}=M\\vec{\\beta}&#94;{c}\\ –\\ \\vec{d}$$ We can now set both of these equal to zero and solve this system of equations to find the appropriate MLE estimate of $\\vec{\\beta}&#94;{c}$ . However, there is a few simplifying steps which can make the result more useable. The first is to get the expression in terms of the original least squares estimator. If we multiply the first equation above by M(${\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}$, we obtain: $$- \\ 2M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}\\mathbf{X}&#94;{\\intercal}\\vec{y}+\\ 2M{\\widehat{\\beta}}&#94;{c}-\\ M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal}\\vec{\\lambda} = 0$$ The first term on the right is the familiar $\\vec{\\beta}$ from unconstrained OLS (I will denote this $\\vec{\\beta}&#94;{u}$). Substituting, we get $$- \\ 2M\\vec{\\beta}&#94;{u}+\\ 2M{\\widehat{\\beta}}&#94;{c}-\\ M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal}\\vec{\\lambda} = 0$$$$- \\ 2M\\vec{\\beta}&#94;{u}+\\ 2M{\\widehat{\\beta}}&#94;{c}-\\ M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal}\\vec{\\lambda} = 0$$$$M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal}\\vec{\\lambda} = \\ 2M{\\widehat{\\beta}}&#94;{c} - \\ 2M{\\widehat{\\beta}}&#94;{u}$$ Solving for lambda: $$\\vec{\\lambda} = {(M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal})}&#94;{- 1}\\left\\lbrack 2M{\\widehat{\\beta}}&#94;{c} - \\ 2M{\\widehat{\\beta}}&#94;{u} \\right\\rbrack= 2{(M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal})}&#94;{- 1}\\lbrack \\vec{d} - \\text{M}{\\widehat{\\beta}}&#94;{u}\\rbrack$$ Plugging this back into the original equation and solving for ${\\widehat{\\beta}}&#94;{c}$, $$0= - 2\\mathbf{X}&#94;{\\intercal}\\vec{y}+2\\mathbf{X}&#94;{\\intercal}\\mathbf{X}{\\widehat{\\beta}}&#94;{c}-M&#94;{\\intercal}\\vec{\\lambda}$$$$0= - 2\\mathbf{X}&#94;{\\intercal}\\vec{y}+2\\mathbf{X}&#94;{\\intercal}\\mathbf{X}{\\widehat{\\beta}}&#94;{c}-{2(M}&#94;{\\intercal}{(M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal})}&#94;{- 1}\\lbrack \\vec{d} - \\text{M}{\\widehat{\\beta}}&#94;{u}\\rbrack)$$ $$\\mathbf{X}&#94;{\\intercal}\\mathbf{X}{\\widehat{\\beta}}&#94;{c}=\\mathbf{X}&#94;{\\intercal}\\vec{y}+M&#94;{\\intercal}{(M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal})}&#94;{- 1}\\lbrack \\vec{d} - \\text{M}{\\widehat{\\beta}}&#94;{u}\\rbrack$$ $${\\widehat{\\beta}}&#94;{c}= ({{\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}\\mathbf{X}}&#94;{\\intercal}\\vec{y}+{{(\\mathbf{X}}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal}{(M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal})}&#94;{- 1}\\lbrack \\vec{d} - \\text{M}{\\widehat{\\beta}}&#94;{u}\\rbrack$$ $${\\widehat{\\beta}}&#94;{c}=\\vec{\\beta}&#94;{u}+{{(\\mathbf{X}}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal}{(M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal})}&#94;{- 1}\\lbrack \\vec{d} - \\text{M}{\\widehat{\\beta}}&#94;{u}\\rbrack$$ This is the desired result, the maximum likelihood estimator given the constraint M$\\vec{\\beta} =d$. Now, let's look at an example. $$\\vec{\\beta}_{p} = 0$$ Is equivalent to the following constraint. $\\vec{\\alpha}&#94;{\\intercal}\\vec{\\beta} = 0$ where $\\vec{\\alpha}$ is a vector of zeros in all but the last row, which is a 1. So, $$\\vec{\\alpha} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ \\vdots \\\\ 1 \\end{bmatrix}$$ Plugging it into the derived result, we get: $${\\widehat{\\beta}}&#94;{c}={\\widehat{\\beta}}&#94;{u}+{{(\\mathbf{X}}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}\\vec{\\alpha}&#94;{\\intercal}{(\\vec{\\alpha}&#94;{\\intercal}({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}\\vec{\\alpha})}&#94;{- 1}\\lbrack - \\ \\vec{\\alpha}'{\\widehat{\\beta}}&#94;{u}\\rbrack$$$${\\widehat{\\beta}}&#94;{c}={\\widehat{\\beta}}&#94;{u}+{{(\\mathbf{X}}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}\\vec{\\alpha}&#94;{\\intercal}{(\\vec{\\alpha}&#94;{\\intercal}({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}\\vec{\\alpha})}&#94;{- 1}\\lbrack - \\ {{\\widehat{\\beta}}&#94;{u}}_{p}\\rbrack$$ Since $\\vec{\\alpha}&#94;{- 1}= \\vec{\\alpha}$ in this case, we know that $\\vec{\\alpha}&#94;{\\intercal}{(\\vec{\\alpha}&#94;{\\intercal}({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}\\vec{\\alpha})}&#94;{- 1} = \\vec{\\alpha}&#94;{\\intercal}\\left( \\vec{\\alpha}&#94;{\\intercal}\\left(\\mathbf{\\mathbf{X}}&#94;{\\intercal}\\mathbf{X} \\right)\\vec{\\alpha} \\right) = {\\mathbf{X}&#94;{\\intercal}\\mathbf{X}}_{p,p}$ which is a scalar that is the bottom right element of the $\\mathbf{\\mathbf{X}}&#94;{\\intercal}\\mathbf{X}$ matrix. So we can simplify this to: $${\\widehat{\\beta}}&#94;{c}={\\widehat{\\beta}}&#94;{u}+{{(\\mathbf{X}}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}{\\mathbf{X}&#94;{\\intercal}\\mathbf{X}}_{p,p}\\lbrack - \\ {{\\widehat{\\beta}}&#94;{u}}_{p}\\rbrack$$ Since ${\\mathbf{X}&#94;{\\intercal}\\mathbf{X}}_{p,p}\\lbrack 1 - \\ {\\beta&#94;{u}}_{p}\\rbrack$ is a constant: $${\\widehat{\\beta}}&#94;{c}={\\widehat{\\beta}}&#94;{u}-{\\mathbf{X}&#94;{\\intercal}\\mathbf{X}}_{p,p}(\\left\\lbrack \\ {\\beta&#94;{u}}_{p} \\right\\rbrack){{(\\mathbf{X}}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}$$ So, if we compute the unconstrained ${\\widehat{\\beta}}&#94;{u}$ and ${{(\\mathbf{X}}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}$, we can solve directly for the constrained $\\vec{\\beta}$. Now, for the second part of part a), this is equivalent to M being a vector of 1s, lets call it ϕ. Then $d=1$ and $$ \\vec{\\phi} = \\begin{bmatrix} 1 \\\\ 1 \\\\ 1 \\\\ \\vdots \\\\ 1 \\end{bmatrix}$$ Plugging it into the derived result, we get: $${\\widehat{\\beta}}&#94;{c}={\\widehat{\\beta}}&#94;{u}+{{(\\mathbf{X}}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}\\vec{\\phi}&#94;{\\intercal}{(\\vec{\\phi}&#94;{\\intercal}({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}\\vec{\\phi})}&#94;{- 1}\\lbrack 1 - \\vec{\\phi}'{\\widehat{\\beta}}&#94;{u}\\rbrack$$ The residual sum of squares is defined as: $$\\text{RSS} = \\ {(\\vec{y} -\\widehat{y})}&#94;{\\intercal}(\\vec{y} -\\widehat{y})$$ In this case, $$ \\widehat{y} =\\mathbf{\\mathbf{X}}{\\widehat{\\beta}}&#94;{c} = \\vec{\\beta}&#94;{u}+{{(\\mathbf{X}}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal}{(M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal})}&#94;{- 1}\\lbrack \\vec{d} - \\text{M}{\\widehat{\\beta}}&#94;{u}) =\\mathbf{\\mathbf{X}}\\vec{\\beta}&#94;{u}+\\mathbf{X}{{(\\mathbf{X}}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal}{(M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal})}&#94;{- 1}\\lbrack \\vec{d} - \\text{M}{\\widehat{\\beta}}&#94;{u}\\rbrack $$ So it follows that $$ \\left(\\vec{y}-\\widehat{y_{c}} \\right) =\\vec{y}- \\mathbf{\\mathbf{X}}\\vec{\\beta}&#94;{u}+\\mathbf{X}{{(\\mathbf{X}}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal}{(M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal})}&#94;{- 1}\\lbrack \\vec{d} - \\text{M}{\\widehat{\\beta}}&#94;{u}\\rbrack =\\vec{\\varepsilon} +\\mathbf{X}{{(\\mathbf{X}}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal}{(M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal})}&#94;{- 1}\\lbrack \\vec{d} - \\text{M}{\\widehat{\\beta}}&#94;{u}\\rbrack $$ where $\\vec{\\varepsilon}$ is the error in the unconstrained case. So $$\\text{RSS}_c - \\text{RSS} =\\lbrack \\vec{d} - \\text{M}{\\widehat{\\beta}}&#94;{u}\\rbrack&#94;{\\intercal}{(M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal})}&#94;{- 1}\\lbrack \\vec{d} - \\text{M}{\\widehat{\\beta}}&#94;{u}\\rbrack)$$ Each of the errors are normally distributed with mean 0 and variance sigma squared. This implies that: $$ (y - \\check{y})\\ I\\frac{1}{\\sigma}\\sim\\text{MVN}(0,I) \\text{, i.i.d} $$ Where the estimator is the estimator from the restrained equation. We can write the sum of squares of the above as: $$\\left(\\vec{y}- \\widehat{y} \\right)&#94;{\\intercal}(I\\frac{1}{\\sigma&#94;{2}})\\left(\\vec{y}- \\widehat{y} \\right) = \\left(\\vec{y}- \\check{y} \\right)&#94;{\\intercal}(I\\frac{1}{\\sigma&#94;{2}})\\left(\\vec{y}- \\check{y} \\right) + \\ \\left( \\check{y}-\\widehat{y} \\right)&#94;{\\intercal}\\left( I\\frac{1}{\\sigma&#94;{2}} \\right)\\left( \\check{y}-\\widehat{y} \\right)+ 2(\\check{y}-\\widehat{y})'\\left( I\\frac{1}{\\sigma&#94;{2}} \\right)(y -\\check{y})$$ Where$\\ {\\check{y}}_{i}\\ $is the estimator of the unconstrained model. To show this, we remove the identical identity matrices and see that: $$\\left(\\vec{y}- \\widehat{y} \\right)&#94;{\\intercal}\\left(\\vec{y}- \\widehat{y} \\right) = \\left(\\vec{y}- \\check{y} + \\check{y} - \\widehat{y} \\right)&#94;{\\intercal}\\left(\\vec{y}- \\check{y} + \\check{y} - \\widehat{y} \\right) = \\left(\\vec{y}- \\check{y} \\right)&#94;{\\intercal}\\left(\\vec{y}- \\check{y} \\right) + \\ \\left( \\check{y} - \\widehat{y} \\right)&#94;{\\intercal}\\left( \\check{y} - \\widehat{y} \\right) + 2(y - \\check{y})'\\left( \\check{y} - \\widehat{y} \\right)$$ Now, $$\\left( \\check{y} - \\widehat{y} \\right) = \\left(\\vec{y}- \\widehat{y} - \\left(\\vec{y}- \\check{y} \\right) \\right) = \\left( \\ \\left(\\vec{y}- \\widehat{y} \\right) - \\vec{\\varepsilon} \\right)$$ which we know from the above is $(\\mathbf{X}{{(\\mathbf{X}}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal}{(M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal})}&#94;{- 1}\\lbrack \\vec{d} - \\text{M}{\\widehat{\\beta}}&#94;{u}\\rbrack$)' Rewriting, we have: $$\\left(\\vec{y}- \\check{y} \\right)'\\left( \\left(\\vec{y}- \\widehat{y} \\right) - \\vec{\\varepsilon} \\right) = \\vec{\\varepsilon}'(\\mathbf{X}{{(\\mathbf{X}}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal}{(M({\\mathbf{X}&#94;{\\intercal}\\mathbf{X})}&#94;{- 1}M&#94;{\\intercal})}&#94;{- 1}\\left\\lbrack \\vec{d} - \\ M{\\widehat{\\beta}}&#94;{u} \\right\\rbrack)$$ Using the fact that $\\vec{\\varepsilon}&#94;{\\intercal}\\mathbf{X} = 0$ , we can remove this to obtain. $${\\left(\\vec{y}- \\widehat{y} \\right)&#94;{\\intercal}\\left(\\vec{y}- \\widehat{y} \\right) = \\left(\\vec{y}- \\check{y} \\right)}&#94;{\\intercal}\\left(\\vec{y}- \\check{y} \\right) + \\ \\left( \\check{y} - \\widehat{y} \\right)&#94;{\\intercal}\\left( \\check{y} - \\widehat{y} \\right)$$ Thus the original standardized normal variable can be represented as a sum of $Q_1$, and $Q_2$ where: $$Q_1 = \\left(\\vec{y}-\\check{y} \\right)&#94;{\\intercal}\\left(\\vec{y}-\\check{y} \\right)$$$$Q_2 = \\left( \\check{y}-\\widehat{y} \\right)&#94;{\\intercal}\\left( \\check{y}-\\widehat{y} \\right) $$ $Q_1$ is the sum of squared errors for the unconstrained model, and therefore has rank $n - p$. $Q_2$ has rank $p - r$, as it is the differences between the two estimators. Thus rank($Q_1$) + rank ($Q_2$) = $n-r$ which is the rank of the errors of the constrained model, since $r<p$. Thus by Cochran's Theorem, the two are independently distributed. I have also produced simulations to prove that this is the case. I create three normal random variables, two of which are related to the others linearly and randomly. I compute the beta unconstrained, and then use this to compute the beta constrained. I then produce the errors for the constrained beta, and check the correlations in 100 samples of 100 each. The mean correlation is very close to zero, which is the expected result. This is included below. In [2]: const <- vector () unconst <- vector () correl <- vector () for ( j in 1 : 100 ) { for ( i in 1 : 100 ) { y <- rnorm ( 100 ) x1 <- y + rnorm ( 100 , 0 , .2 ) x2 <- rnorm ( 100 , 0 , .01 ) - .3 * y Xmat <- matrix ( c ( rep ( 1 , length ( x1 )), x1 , x2 ), ncol = 3 ) data2 <- data.frame ( y , x1 , x2 ) mod.sim.1 <- lm ( y ~ x1 + x2 , data = data2 ) constraint <- matrix ( 1 , nrow = nrow ( data2 ), ncol = 1 ) d = 1 M = matrix ( rep ( 1 , 3 ), ncol = 1 ) mod.sim.1 BetaUnconstr <- summary ( mod.sim.1 ) $ coef [, 1 ] b <- d - t ( M ) %*% BetaUnconstr a <- t ( Xmat ) %*% Xmat c <- solve ( t ( M ) %*% solve ( a ) %*% M ) const [ i ] <- b * c * b unconst [ i ] <- sum ( resid ( mod.sim.1 ) &#94; 2 ) } correl [ j ] <- cor ( const , unconst ) } correl mean ( correl ) -0.0531688267764585 -0.114464495425658 0.030905848126332 -0.0804090923830123 -0.0282214216966975 0.194785864859665 0.0830930039710045 0.0724914248601695 0.0829089181916613 0.0288906516772889 0.0279474715925631 -0.0533135707611509 0.0658332419742044 -0.0799946756911054 -0.0941441499229167 -0.024909668515204 0.0714084573952652 -0.0455394491591305 0.166193108785476 -0.077429232110221 -0.128495293842719 -0.0786313087721033 -0.135204615732129 0.00402444738581924 -0.210414921426846 -0.0466002337555276 -0.0744914482523485 0.0253724403628865 -0.144593000144071 -0.0558067022331745 0.0941802108323231 -0.0326002696533416 0.1191407256456 0.0742989188901125 0.0498008210293263 0.02980912239177 -0.132207185159464 -0.154762140608869 -0.0311445812733598 0.0213674326991292 -0.0563900846752629 0.113499475702925 -0.125719333220632 0.0434611514397736 0.202868180728299 -0.113919008868015 -0.0382369212754716 0.0491389841646633 -0.0198221517858243 0.0175352131496739 0.0264657952051942 0.119278436715872 -0.218521793800235 0.0159366944834975 0.194276086012615 -0.121180977909389 -0.165054100432551 -0.0651733446635078 -0.07680468077657 -0.0503302517530004 0.00823376132659068 0.00388666785680694 -0.00915532185917745 -0.0930607404292774 -0.171362738860478 -0.0310668331585724 -0.0210004347148357 0.0549900820264029 -0.0468877624516252 0.0868626310356565 0.0532565684252016 -0.168838788927617 0.0339257077316963 0.0762184886512164 -0.0890754231460831 -0.0647727147695691 -0.0889513202649563 0.000667073625725037 0.0509714346818621 -0.0940193584932185 -0.0839669876254321 0.106982624440368 0.145030507757848 -0.0757386310783636 0.161739345883223 0.214585243128979 -0.0764856927072532 0.0477290142665558 0.0126102486334496 -0.0741476392314046 -0.0725679361079652 -0.0807334358109478 0.0186774645788979 0.0234449247050084 0.0176989561150896 0.0516204767156866 0.120367846574953 0.0233333600272549 -0.00113490805336294 0.118557812809982 -0.00814363230874542 if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Linear Models","url":"category/linear-models/constrained-least-squares.html","loc":"category/linear-models/constrained-least-squares.html"},{"title":"Hidden Markov Models","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } In my previous project, I developed the reasoning behind Hidden Markov Models (HMM) and developed a way of determining the most likely sequence of states that resulted in an observed sequence of emissions using the Viterbi algorithm. This project will explore extensions to the Hidden Markov Model, such as the Forwards-Backwards algorithm and the Baum-Welch algorithm. Consider a discrete time, discrete state-space Hidden Markov chain with: $\\pi_{t}$ : the state at time t (unknown in the HMM) of n possible states $\\pi_{t} = 1,2,\\ldots,n$ $x_{\\text{t}}$: the emission at time t of m possible emissions, $x_{\\text{t}} = 1,2,\\ldots,m$ P(0) : initial probabilities of being in the states. P : a nxn transition matrix of transitions between states, giving P($\\pi_{t} = i\\left| \\pi_{t - 1} = j \\right)$ for the ith row and jth column. E : a nxm matrix containing P($x_{\\text{t}} = j\\ \\left| \\ \\pi_{t} = i \\right)$ in the ith row, jth column, the emission probabilities. Note that the row sums must sum to 1. Given a set of observed emissions, $x_{1,\\ldots,\\ T}$, the Viterbi algorithm gives us the most likely sequence of states, $\\pi_{1,\\ldots,\\ T}$ that resulted in the observed emissions, given P and E. Although this decoding algorithm is very useful, there may be other aspects of the HMM we are interested in. One such problem is, given a set of observed emissions $x_{1,\\ldots,\\ T}$, what is the probability of the observed emissions? This problem can be solved using the law of total probability, i.e.: $$P\\left( x_{1},\\ \\ldots,x_{T} \\right) = \\ \\sum_{\\mathbf{\\pi}}&#94;{}{P(x_{1},\\ \\ldots,x_{T}}\\left| \\ \\mathbf{\\pi} \\right)P(\\mathbf{\\pi})\\ $$ where $\\mathbf{\\pi}$ refers to any vector of state sequences. This can be computationally intensive -- for many steps, this will involve summing over an exponentially large number of possible state sequences. Thus, an algorithmic approach will be useful to make this result practical to obtain for large T. This is a similar problem to the Viterbi algorithm, but not exactly the same. This can be solved using the forward algorithm , as described below. Note that we can also write the above as: $$P\\left( x_{1},\\ \\ldots,x_{T} \\right) = \\ \\sum_{\\mathbf{\\pi}}&#94;{}{P(x_{1},\\ \\ldots,x_{T}},\\mathbf{\\pi})\\ $$ Let's call $\\alpha_{t}(\\pi_{t})$ = $P\\left( x_{1},\\ \\ldots,x_{t},\\ \\pi_{t} \\right) = \\ \\sum_{\\pi_{t - 1}}&#94;{}{P(x_{1},\\ \\ldots,x_{T},\\ \\pi_{t},\\pi_{t - 1})}$ It follows that our desired probability of the sequence is equal to the sum over all states of the above quantity. $$\\alpha_{t}(\\pi_{t}) = \\ \\sum_{\\mathbf{\\pi}_{t - 1}}&#94;{}{P(x_{t}|x_{1},\\ \\ldots,x_{t - 1},\\ \\pi_{t},\\ \\pi_{t - 1})P(\\pi_{t}|x_{1},\\ \\ldots,x_{t - 1},\\ \\pi_{t - 1}})P(x_{1},\\ \\ldots,x_{t - 1},\\ \\pi_{t - 1})$$ But $x_{t}$ is conditionally independent of everything but $\\pi_{t},\\ $and $\\pi_{t}$conditionally independent on everything but $\\pi_{t - 1}$. So we can write this simply as: $$\\alpha_{t}(\\pi_{t}) = \\ P(x_{t}|\\pi_{t})\\sum_{\\mathbf{\\pi}_{t - 1}}&#94;{}{P(\\pi_{t}|\\pi_{t - 1}})P(x_{1},\\ \\ldots,x_{t - 1},\\ \\pi_{t - 1})$$$$= \\ P(x_{t}|\\pi_{t})\\sum_{\\mathbf{\\pi}_{t - 1}}&#94;{}{P(\\pi_{t}|\\pi_{t - 1}})\\alpha_{t - 1}(\\pi_{t - 1})$$ It follows, then, that we can compute each $\\alpha_{t}$ recursively. This will eliminate the need to look at the probability of all states. This has a computation time of $O(\\text{nm}&#94;{2})$ which is far faster than doing it for each possible sequence, which is$\\ O(\\text{nm}&#94;{n})$. After computing this for each possible state at time T, we sum the probabilities to get the probability of the observed sequence. Note that $\\alpha_{1}\\left( \\pi_{1} \\right) = P(x_{1}|\\pi_{1})\\sum_{x_{0}}&#94;{}{P(\\pi_{1}|\\pi_{0}})P(\\pi_{0}) = \\ \\ P(x_{1}|\\pi_{1})P(\\pi_{1})$, where $P\\left( \\pi_{1} \\right)$ is to be considered the initial probabilities of entering the chain, predefined by the problem. Consider the following example of a fair and biased coin, where: Initial probabilities are equal, .5 for fair and .5 for biased $$\\mathbf{P = \\ }\\begin{matrix} .9 & .1 \\\\ .05 & .95 \\\\ \\end{matrix}$$$$\\mathbf{E = \\ }\\begin{matrix} .5 & .5 \\\\ .25 & .75 \\\\ \\end{matrix}$$ We observe the sequence HTHHTTHH and want to determine the probability of this sequence occurring given our HMM. First, $$\\alpha_{1}\\left( \\pi_{1} = F \\right) = \\ P\\left( x_{1} \\middle| \\pi_{1} = F \\right)P\\left( \\pi_{1} = F \\right) = \\left( 0.5 \\right)\\left( 0.5 \\right) = \\ .25$$$$\\alpha_{1}\\left( \\pi_{1} = B \\right) = P\\left( x_{1} \\middle| \\pi_{1} = B \\right)P\\left( \\pi_{1} = B \\right) = \\left( 0.25 \\right)\\left( 0.5 \\right) = \\ .135$$ So it follows that the probability of a head being observed, alone, is the sum of these partial probabilities, or .385. To determine the probability of the full sequence, we continue this recursively, considering the results of the function at the last time step. We can also simplify this using matrix multiplication. If we consider $\\mathbf{\\alpha}_{\\mathbf{t}}$ as a nx1 vector pertaining to each of the n states, we can calculate the following: $${\\mathbf{\\alpha}_{\\mathbf{t}}\\mathbf{= \\ E}}_{\\mathbf{.,j}} x \\mathbf{P'\\alpha}_{\\mathbf{t - 1}}$$ Where j refers to a row vector of the jth column pertaining to the observed value at time t . This can help to simplify the calculations. Here, x refers to component-wise multiplication. I have included a user-defined function to determine this probability recursively for the problem at hand: In [6]: forwardalgor <- function ( obs , trans , emissions , init ){ alphas <- list ( 1 , init * emissions [, obs [ 1 ]]) for ( i in 2 : ( length ( obs ) + 1 )){ alphasum <- as.numeric ( trans %*% alphas [[ i ]]) alphas [[ i + 1 ]] <- emissions [, obs [ i -1 ]] * alphasum } print ( \"Sequences:\" ) print ( alphas ) print ( \"Final Probability\" ) print ( sum ( alphas [[ length ( obs ) +1 ]])) return ( sum ( alphas [[ length ( obs ) +1 ]])) } forwardalgor ( c ( 1 , 2 , 1 , 1 , 2 , 2 , 1 , 1 ), rbind ( c ( .9 , .1 ), c ( .95 , .05 )), rbind ( c ( .5 , .5 ), c ( .25 , .75 )), c ( .5 , .5 )) [1] \"Sequences:\" [[1]] [1] 1 [[2]] [1] 0.250 0.125 [[3]] [1] 0.1187500 0.0609375 [[4]] [1] 0.05648438 0.08689453 [[5]] [1] 0.02976270 0.01450122 [[6]] [1] 0.014118274 0.007249905 [[7]] [1] 0.006715719 0.010331142 [[8]] [1] 0.003538630 0.005172367 [[9]] [1] 0.0018510021 0.0009050793 [[10]] [1] 0.0008782049 0.0004509265 [1] \"Final Probability\" [1] 0.002756081 0.00275608136978746 This gives us our result -- there is about a .2% chance of this observation being output by this particular HMM. This can be useful for numerous applications: consider if one was testing against n possible HMMs. We could then find which HMM is the more likely fit by considering $\\text{argmax}_{i}(P\\left( \\text{HMM}_{i} \\middle| x_{1},\\ \\ldots,x_{T} \\right))$. Bayes' Rule tells us that: $$P\\left( \\text{HMM}_{i} \\middle| x_{1},\\ \\ldots,x_{T} \\right) \\propto \\ P\\left( x_{1},\\ \\ldots,x_{T} \\middle| \\text{HMM}_{i} \\right)P(\\text{HMM}_{i})$$ If we consider our n models as equally likely, we can then determine which model is most probable given the observations simply by considering the likelihood in the fashion calculated above. That is, $\\operatorname{}\\left( P\\left( \\text{HMM}_{i} \\middle| x_{1},\\ \\ldots,x_{T} \\right) \\right) = \\text{argmax}_{i}(\\ P\\left( x_{1},\\ \\ldots,x_{T} \\middle| \\text{HMM}_{i} \\right))$. This relatively simple result and simple algorithm gives us a method of comparing and optimizing our fit. Also, since the probabilities here can become quite small, the fact that a logarithmic function is monotonically increasing means we can also compare the logarithms, in order to avoid machine zeros. The closely related, but not exactly equivalent, Forwards-Backwards algorithm attempts to find probability of a particular state of a particular time point given all of the observations, i.e. : $$P({\\pi_{k}|x}_{1},\\ \\ldots,x_{T})$$$$P\\left( {\\pi_{k}|x}_{1},\\ \\ldots,x_{k,\\ }x_{k + 1},\\ldots,x_{T} \\right) = \\ \\frac{P\\left( x_{k + 1},\\ldots,x_{T}|{\\pi_{k},x}_{1},\\ \\ldots,x_{k} \\right)P\\left( {\\pi_{k}|x}_{1},\\ \\ldots,x_{k} \\right)}{P\\left( x_{k + 1},\\ldots,x_{T} \\right)}$$ $$\\propto P\\left( x_{k + 1},\\ldots,x_{T}|\\pi_{k} \\right)P\\left( {\\pi_{k}|x}_{1},\\ \\ldots,x_{k} \\right)$$ This is due to the fact that $x_{k + 1},\\ldots,x_{T}$ is conditionally independent of $x_{1},\\ \\ldots,x_{k}$ given $\\pi_{k}$ and that $P\\left( x_{k + 1},\\ldots,x_{T} \\right)$ is a multiplicative constant which does not change with a selection of $\\pi_{k}$. This means we can normalize this probability at each point to ensure that $\\sum_{}&#94;{}{P\\left( {\\pi_{k}|x}_{1},\\ \\ldots,x_{k,\\ }x_{k + 1},\\ldots,x_{T} \\right) = 1}$. Notice that $P\\left( {\\pi_{k}|x}_{1},\\ \\ldots,x_{k} \\right)\\ \\propto \\ P\\left( x_{1},\\ \\ldots,x_{k},\\ \\pi_{k} \\right) = \\ \\alpha_{k}\\mathbf{(}\\pi_{k})$ as described earlier. Notice that $P\\left( x_{k + 1},\\ldots,x_{T}|\\pi_{k} \\right)$ is a similar proposition, but backwards. That is, we can call $$b_{k}(\\pi_{k})$$ $$= \\sum_{\\pi_{k + 1}}&#94;{}{P\\left( \\pi_{k + 1},x_{k + 1},\\ldots,x_{T}|\\pi_{k} \\right)}$$ $$= \\sum_{\\pi_{k + 1}}&#94;{}{P\\left( x_{k + 2},\\ldots,x_{T}|{x_{k + 1},\\pi}_{k + 1},\\pi_{k} \\right)P(x_{k + 1}|\\pi_{k + 1},\\pi_{k})P(\\pi_{k + 1}|\\pi_{k})}$$ $$= \\sum_{\\pi_{k + 1}}&#94;{}{P\\left( x_{k + 2},\\ldots,x_{T}|\\pi_{k + 1} \\right)P(x_{k + 1}|\\pi_{k + 1})P(\\pi_{k + 1}|\\pi_{k})}$$ This is obtained using the chain rule and the conditional independencies of the HMM. Notice now that $P\\left( x_{k + 2},\\ldots,x_{T}|\\pi_{k + 1} \\right) = \\ b_{k + 1}\\left( \\pi_{k + 1} \\right)$ and we can now see the recursive nature of this function. That is, $$b_{k}\\left( \\pi_{k} \\right) = \\ \\sum_{\\pi_{k + 1}}&#94;{}{b_{k + 1}\\left( \\pi_{k + 1} \\right)P(x_{k + 1}|\\pi_{k + 1})P(\\pi_{k + 1}|\\pi_{k})}$$ We take $b_{T}\\left( \\pi_{T} \\right) = 1$ for all states, as this can be considered the exit probability. Intuitively, this means that we are considering, for some intermediate time step, the probabilities of getting there from zero and the probabilities of \"back tracking\" from T. This gives us the total probability of an intermediate state based on our observations. The implementation is as follows: Compute the forward probabilities (by the previously stated algorithm) until time step k. For each step, normalize the results so that the probabilities sum to 1. Then, compute the backward probabilities from T to k. Normalize these at each step as well. Then, multiply the two results and normalize to get the probabilities of being in each state after k time steps. To calculate this, we may use the following formula: $${\\mathbf{b}_{\\mathbf{t}}\\mathbf{= \\ P(E}}_{\\mathbf{.,j}} x \\mathbf{b}_{\\mathbf{t + 1}}\\mathbf{)}$$ Notice that this is similar to the formula from before for the forwards portion, but the multiplications are \"flipped.\" Thus we can implement the Forward-Backwards algorithm as follows: In [7]: bkforwardalgor <- function ( obs , k , trans , emissions , init ) { alphas <- list ( 1 , init * emissions [, obs [ 1 ]] / sum ( init * emissions [, obs [ 1 ]])) betas <- list ( rep ( 1 , nrow ( trans ))) for ( i in 3 : ( k + 1 )) { alphasum <- as.numeric ( t ( trans ) %*% alphas [[ i - 1 ]]) alphas [[ i ]] <- emissions [, obs [ i - 1 ]] * alphasum alphas [[ i ]] <- alphas [[ i ]] / sum ( alphas [[ i ]]) } for ( i in 2 : ( length ( obs ) - k + 1 )) { betasum <- emissions [, obs [ length ( obs ) - i + 2 ]] * betas [[ i - 1 ]] betas [[ i ]] <- as.numeric ( trans %*% betasum ) betas [[ i ]] <- betas [[ i ]] / sum ( betas [[ i ]]) } pointalph <- alphas [[( k + 1 )]] pointbet <- betas [[( length ( obs ) - k + 1 )]] return ( list ( forward = alphas , backward = betas , probstates = pointalph * pointbet / sum ( pointalph * pointbet ))) } bkforwardalgor ( c ( 1 , 2 , 1 , 1 , 2 , 2 , 1 , 1 ), 3 , rbind ( c ( 0.9 , 0.1 ), c ( 0.95 , 0.05 )), rbind ( c ( 0.5 , 0.5 ), c ( 0.25 , 0.75 )), c ( 0.5 , 0.5 )) $forward 1 0.666666666666667 0.333333333333333 0.88 0.12 0.950682056663169 0.0493179433368311 $backward 1 1 0.493506493506494 0.506493506493506 0.493683851143735 0.506316148856265 0.50646857940524 0.49353142059476 0.505577910274165 0.494422089725835 0.493357500634704 0.506642499365296 $probstates 0.949421205954081 0.0505787940459189 So, at the third time step, we are close to 95% certain that we were in the first state (Heads), given all of the observations. This all leads us to the Baum-Welch algorithm, which is a way of estimating parameters of a HMM given a sequence of emissions. Let $\\gamma_{i}\\left( t \\right) = P\\left( \\pi_{t} \\middle| \\theta,x_{1},\\ \\ldots,x_{T} \\right)$ where $\\theta$ is the parameters of the distribution (the transition matrix, the emission matrix and the initial probabilities.) Note that we have already calculated this in the previous exercise using the forwards backwards algorithm. Further, let $$\\xi_{i,j}\\left( t \\right) = \\ P\\left( \\pi_{t}\\ ,\\pi_{t + 1}\\ \\middle| \\theta,x_{1},\\ \\ldots,x_{T} \\right) = \\frac{\\alpha_{t}\\left( \\pi_{t} = i \\right)\\mathbf{P}_{\\text{ij}}b_{t + 1}\\left( \\pi_{t + 1} = j \\right)\\mathbf{E}_{{j,x}_{t + 1}}}{\\sum_{}&#94;{}{\\alpha_{t}\\left( \\pi_{t} = i \\right)\\mathbf{P}_{\\text{ij}}b_{t + 1}\\left( \\pi_{t + 1} = j \\right)\\mathbf{E}_{{j,x}_{t + 1}}}}$$ This represents the probability of entering state i from the left, going from state i to j, exiting state j from the right, and emitting the emission at the t+1 time step from state j. All of this culminates in the joint probability of two consecutive states. Then, using an initial set of parameters we can calculate these values and update our parameters to find a local maxima. Our updates are as follows: Initial probabilities = $\\gamma_{i}\\left( 1 \\right)$. This is the expected frequency spent in state i at time 1. The new transition matrix, P' , will have entries: $$\\mathbf{P'}_{\\text{ij}} = \\frac{\\sum_{t = 1}&#94;{T - 1}{\\ \\xi_{i,j}\\left( t \\right)}\\ }{\\sum_{t = 1}&#94;{T - 1}{\\gamma_{i}\\left( t \\right)}}$$ This is the expected number of transitions from state i to j compared to the expected total number of transitions away from state i (including itself). The new emission matrix, E' , will have entries: $\\mathbf{E'}_{\\text{ij}} = \\frac{\\sum_{t = 1}&#94;{T}1_{x_{t} = j}\\gamma_{i}\\left( t \\right)}{\\sum_{t = 1}&#94;{T}{\\gamma_{i}\\left( t \\right)}}$ Where $1_{x_{t} = j}$ is an indicator function which is 1 if the emission was the jth emission and zero otherwise. This calculates the average amount of time an emission j was emitted in state i divided by the average amount of time it was in state i in general. We then iterate this process until we are within a threshold to determine the optimal parameters for the model given only an observed sequence. While I have not implemented this algorithm directly here, I have used the HMM package in R to determine this. Here is the output: In [8]: library ( HMM ) chk <- initHMM ( States = c ( \"F\" , \"B\" ), Symbols = c ( \"H\" , \"T\" ), startProbs = c ( .5 , .5 ), transProbs = rbind ( c ( .9 , .1 ), c ( .95 , .05 )), emissionProbs = rbind ( c ( .5 , .5 ), c ( .25 , .75 ))) baumWelch ( chk , c ( \"H\" , \"T\" , \"H\" , \"H\" , \"T\" , \"T\" , \"H\" , \"H\" )) $hmm $States 'F' 'B' $Symbols 'H' 'T' $startProbs F 0.5 B 0.5 $transProbs F B F 0.8356626 1.643374e-01 B 1.0000000 4.663436e-19 $emissionProbs H T F 0.530374 4.696260e-01 B 1.000000 8.442496e-29 $difference 0.508902752112227 0.240556572158092 0.175367150726267 0.125799629747644 0.0789866075573572 0.0430462501906644 0.0220242002384686 0.0120457248068965 0.00797054223724487 0.00648938284089056 0.00596923716449372 0.00573434947770014 0.00556884788402301 0.00541435766962771 0.00525534145586094 0.0050878669619669 0.00491154731418667 0.0047272548854208 0.00453636210810545 0.00434044024235019 0.00414111692008325 0.0039399973466488 0.00373861517021827 0.00353839967199841 0.00334065357605126 0.00314653876626508 0.00295706838232949 0.00277310422503745 0.00259535857201991 0.00242439957307494 0.00226065943795158 0.00210444467891964 0.00195594773481778 0.00181525938160172 0.00168238142175776 0.00155723923619973 0.00143969387155143 0.0013295534195225 0.00122658352013238 0.00113051688536663 0.00104106179381376 0.000957909549977724 0.000880740935187623 0.000809231701136347 0.000743057173680575 0.00068189604460203 0.000625433433944128 0.000573363306621804 0.000525390324947385 0.00048123121464055 0.000440615716505618 0.000403287189561262 0.000369002924884535 0.0003375342226381 0.000308666278318049 0.00028219791808662 0.000257941217349493 0.000235721031633014 0.000215374464079931 0.000196750289868947 0.000179708354205615 0.000164118957457245 0.000149862238244094 0.000136827563139715 0.000124912929580535 0.000114024387063381 0.000104075480274582 9.49867167999181e-05 8.66850610378905e-05 7.91034553396986e-05 7.21803686502851e-05 6.58593726685694e-05 6.00887450076778e-05 5.48210986672737e-05 5.00130368923791e-05 4.56248323759889e-05 4.16201296418831e-05 3.79656693828655e-05 3.46310335586279e-05 3.1588409960111e-05 2.88123750393403e-05 2.62796938294031e-05 2.39691357210852e-05 2.18613050690297e-05 1.99384854986017e-05 1.81844969456332e-05 1.65845644250734e-05 1.51251977163732e-05 1.37940810142869e-05 1.25799718653171e-05 1.14726085741031e-05 1.04626254579159e-05 9.54147526764379e-06 8.70135822614897e-06 7.93515712464892e-06 7.23637797002243e-06 6.59909573466095e-06 6.0179047717908e-06 5.48787350674592e-06 5.00450304905593e-06 Here, we see that the algorithm suggests changing the transition probabilities to almost never transition when in the Biased state, and to transition more frequently when in the fair state. It also suggests that the emission probabilities be heads nearly in all cases when it is biased. This is troublesome, since we knew (by our definition) that the emissions would be fair for the fair coin and biased otherwise. Still, this generalizes the problem and allows us to attempt to fit optimal HMMs to a given set of emissions. Using the Viterbi algorithm is known as \"decoding\" -- we are attempting to determine the most likely state sequence given a sequence of observed emissions. Determining the most likely state at a time step is known as \"filtering\" (when the step is the final step, T) or \"smoothing\" (for some intermediate step, k ). This is what the forward-backward algorithm was used for. Attempting to determine the best fitting parameters is known as \"training\". This is the motivation of the Baum-Welch algorithm. Together, these three algorithms provide the basis for many applications of the HMM model. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Markov Chains","url":"category/markov-chains/hidden-markov-models.html","loc":"category/markov-chains/hidden-markov-models.html"},{"title":"HMMs: Viterbi Algorithm","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } This investigates HMMs (Hidden Markov Models) with two possible states and six possible emissions using the viterbi algorithm. Given a Markov process with two states (state 1 and state 2) and an arbitrary number of possible observed emissions , with transition probabilities and emission probabilities given for each state, we can find the most likely sequence of states given some observed emissions using the viterbi algorithm. This algorithm is an example of dynamic programming which produces results far faster than a brute force approach. This takes less time to run than considering all possible sequences of states -- we only need to consider the state probabilities forwards, rejecting paths that are unlikely at each point. The example which the following function defaults to is the case of a fair and loaded die, each with some probability of values 1-6. The roller does not show you what die he is using, but we know that he will generally switch between the two die with some transition probs. The goal is then to find the most likely sequence of fair and loaded die given the observed sequence of emissions (for example 1,2,2,1,3). In [12]: viterbialgorithm <- function ( values , initprobstates = c ( .5 , .5 ), probvectorstate1 = c ( rep ( 1 / 6 , 6 )), probvectorstate2 = c ( rep ( 1 / 10 , 5 ), 1 / 2 ), Ps1s2 = 0.05 , Ps2s1 = .1 ){ ## values (vector): a series of observed values of two emissions. ## initprobstates (vector, len 2): the probabilities of entering the system in either state. (assuming .5, .5 is the least informative) ## probvectorstate1 (vector): the emission probabilities of the first state. ## probvectorstate2 (vector): the emission probabilities of the second state. ## Ps1s2 (numeric): probability of entering state 2 from state 1. ## Ps2s1 (numeric): probability of entering state 1 from state 2. iterations <- length ( values ) initprobstate1 = initprobstates [ 1 ] initprobstate2 = initprobstates [ 2 ] P11 <- 1 - Ps1s2 P22 <- 1 - Ps2s1 if ( iterations < 1 ) { stop ( \"Length of vector must be a positive integer.\" ) } # Initializes the ret list for the first sequence. ret <- list ( c ( s0 = 0 , s1 = - Inf , s2 = - Inf , st = 0 , prevst = NA )) ## Creates the transition matrix. transmatrix <- matrix ( c ( 0 , 0 , 0 , initprobstate1 , P11 , Ps2s1 , initprobstate2 , Ps1s2 , P22 ), ncol = 3 ) maxfun <- function ( potentialstate , prevvector ){ ## potentialstate (integer): integer referring to the potential state (1 or 2) ## prevvector (vector): previous probability of states. trans <- transmatrix [, potentialstate + 1 ] mx <- max ( prevvector [ 1 : 3 ] + log ( trans )) prevst <- which.max ( prevvector [ 1 : 3 ] + log ( trans )) - 1 return ( list ( val = mx , state = prevst )) } for ( i in 1 : iterations ) { maxst1 <- maxfun ( 1 , ret [[ i ]]) maxst2 <- maxfun ( 2 , ret [[ i ]]) ekst1 <- log ( probvectorstate1 [ values [ i ]]) ekst2 <- log ( probvectorstate2 [ values [ i ]]) V1 <- maxst1 [[ 'val' ]] + ekst1 V2 <- maxst2 [[ 'val' ]] + ekst2 end <- which.max ( c ( V1 , V2 )) ret [[ i + 1 ]] <- c ( s0 = - Inf , s1 = V1 , s2 = V2 , st = end , prevst = c ( maxst1 [[ 'state' ]], maxst2 [[ 'state' ]])) } finalstate <- ret [[ iterations + 1 ]][ 'st' ] path <- c ( rep ( 0 , iterations + 1 )) path [ iterations + 1 ] <- finalstate for ( i in ( iterations ) : 2 ) { path [ i ] <- ret [[ i + 1 ]][ 5 : 6 ][ path [ i + 1 ]] } res <- as.data.frame ( ret [ -1 ]) colnames ( res ) <- c ( values ) return ( list ( steps = res , path = path )) } In [13]: observed <- c ( 6 , 5 , 1 , 1 , 6 , 6 , 4 , 5 , 3 , 1 , 3 , 2 , 6 , 5 , 1 , 2 , 4 , 5 , 3 , 6 , 6 , 6 , 4 , 6 , 3 , 1 , 6 , 3 , 6 , 6 , 6 , 3 , 1 , 6 , 2 , 3 , 2 , 6 , 4 , 5 , 5 , 2 , 3 , 6 , 2 , 6 , 6 , 6 , 6 , 6 , 6 , 2 , 5 , 1 , 5 , 1 , 6 , 3 , 1 ) results <- viterbialgorithm ( observed ) resultswords <- c ( \"Fair\" , \"Loaded\" )[ results $ path ] resultswords 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Loaded' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' 'Fair' So this tells us that given the observed die rolls, the most likely sequence of states is as shown above. This did not have to be done manually -- we can use the HMM package to do this. It will serve as a check. In [14]: require ( HMM ) mod <- initHMM ( c ( \"Fair\" , \"Loaded\" ), c ( 1 , 2 , 3 , 4 , 5 , 6 ), startProbs = c ( .5 , .5 ), transProbs = rbind ( c ( .95 , .05 ), c ( .1 , .90 )), emissionProbs = rbind ( c ( rep ( 1 / 6 , 6 )), c ( rep ( 1 / 10 , 5 ), 1 / 2 ))) viterbi ( mod , observed ) == resultswords ## :) TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Markov Chains","url":"category/markov-chains/hmms-viterbi-algorithm.html","loc":"category/markov-chains/hmms-viterbi-algorithm.html"},{"title":"Hotelling's T-Test Example","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } Here's an example of the Hotelling's MV T-test with responses and hypothesized means. Hotelling's MV T-test allows us to use a multivariate analogue of the t-test, comparing the observed values with some hypothesized mean. In this, similar to the univariate case, we assume that the population is Multivariate Normally Distributed, that is: $$ \\vec{x} \\sim MVN(\\vec{\\mu}, \\Sigma) $$ where $\\Sigma$ is a square, symmetric matrix. This test is implemented below. In [4]: ## Hotelling's t-test for multivariate normal. prob_null <- function ( data , hypothesized_mean_vector ) { n = nrow ( data ) p = ncol ( data ) tsqobs <- hotellings_tsq_statistic ( data , hypothesized_mean_vector ) f_dist <- hotellings_f_statistic_trans ( tsqobs , n , p ) return ( 1 - pf ( f_dist [ 'f' ], f_dist [ 'df1' ], f_dist [ 'df2' ])) } hotellings_f_statistic_trans <- function ( tsqobs , n , p ) { f <- (( n - p ) / ( p * ( n - 1 ))) * tsqobs df1 <- p df2 <- n - p return ( c ( f = f , df1 = df1 , df2 = df2 )) } hotellings_tsq_statistic <- function ( data , hypothesized_mean_vector ) { sample_mean <- apply ( data , 2 , mean ) sample_covar <- cov ( data ) S_inv <- solve ( sample_covar ) n <- nrow ( data ) mu <- hypothesized_mean_vector tsqobs <- n * t ( sample_mean - mu ) %*% S_inv %*% ( sample_mean - mu ) return ( tsqobs ) } find_discriminant <- function ( data , hypothesized_mean_vector ) { sample_mean <- apply ( data , 2 , mean ) sample_covar <- cov ( data ) discriminant <- solve ( sample_covar ) %*% ( sample_mean - hypothesized_mean_vector ) return ( discriminant ) } In [5]: response_data <- matrix ( c ( 51 , 27 , 37 , 42 , 27 , 43 , 41 , 38 , 36 , 26 , 29 , 36 , 20 , 22 , 36 , 18 , 32 , 22 , 21 , 23 , 31 , 20 , 50 , 26 , 41 , 32 , 33 , 43 , 36 , 31 , 27 , 31 , 25 , 35 , 17 , 37 , 34 , 14 , 35 , 25 , 20 , 25 , 32 , 26 , 42 , 27 , 30 , 27 , 29 , 40 , 38 , 16 , 28 , 36 , 25 ), ncol = 5 ) hypothesized_mean <- c ( 30 , 25 , 40 , 25 , 30 ) response_data prob_null ( response_data , hypothesized_mean ) find_discriminant ( response_data , hypothesized_mean ) 51 36 50 35 42 27 20 26 17 27 37 22 41 37 30 42 36 32 34 27 27 18 33 14 29 43 32 43 35 40 41 22 36 25 38 38 21 31 20 16 36 23 27 25 28 26 31 31 32 36 29 20 25 26 25 f: 0.00669952528414886 0.5298893 -0.2659554 -0.6946549 0.1483265 0.3206404 From this, because the p value is less than .05, we reject the hypothesis that this data comes from a normally distributed population with mean vector: $$ \\vec{\\mu} = \\begin{bmatrix} 30 \\\\ 25 \\\\ 40 \\\\ 25 \\\\ 30 \\end{bmatrix} $$ The discriminant indicates that the third variable contributes most to the difference between the hypothesized and sample mean. In [6]: require ( MASS ) ex <- mvrnorm ( 11 , mu = hypothesized_mean , Sigma = cov ( response_data )) prob_null ( ex , hypothesized_mean ) find_discriminant ( ex , hypothesized_mean ) f: 0.684532555387565 -0.03199313 -0.07721548 0.09417471 0.09898568 -0.13109563 Now we see that a multivariate normal distribution sampled with mean equal to the hypothesized mean and Sigma equal to the covariance of the observed data provides unsignificant results -- as expected. Now, let's see the t-test for the equality of means, assuming an equal covariance matrix and sample sizes. In [7]: differences <- response_data - ex prob_null ( differences , rep ( 0 , 5 )) find_discriminant ( differences , rep ( 0 , 5 )) f: 0.00818771246890448 0.35457592 -0.09934875 -0.70226005 0.01886289 0.33948696 We see the expected result: that the two samples produce significant results -- meaning that there is evidence to reject the null hypothesis that they come from a distribution with the same mean vector. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Multivariate Analysis","url":"category/multivariate-analysis/hotellings-t-test-example.html","loc":"category/multivariate-analysis/hotellings-t-test-example.html"},{"title":"Generalized Linear Models","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } Here we will consider the marathon runners listed in this wikipedia page . This post will consider various generalized linear models (GLMS) with different families. In [10]: timesm <- c ( 123.98 , 128.633 , 134.266 , 139.484 , 139.533 , 156.5 , 161.95 , 174.8 , 184.9 , 195.9 , 236.567 , 340.017 , 505.283 ) timesf <- c ( 139.316 , 144.893 , 149.00 , 151.083 , 170.55 , 181.5 , 192.95 , 215.483 , 233.7 , 252.733 , 314.433 , 533.133 ) agem <- c ( 35 , 40 , 45 , 50 , 55 , 60 , 65 , 70 , 75 , 80 , 85 , 90 , 100 ) agef <- c ( 35 , 40 , 45 , 50 , 55 , 60 , 65 , 70 , 75 , 80 , 85 , 90 ) agemsq <- agem &#94; 2 time <- c ( timesf , timesm ) age <- c ( agef , agem ) gender <- c ( rep ( 1 , 12 ), rep ( 0 , 13 )) marathon <- data.frame ( time , age , gender ) head ( marathon ) time age gender 139.316 35 1 144.893 40 1 149.000 45 1 151.083 50 1 170.550 55 1 181.500 60 1 First, let's do an ordinary linear regression model with a Gaussian response variable assumption. Linear Regression (Gaussian) In [3]: lin1 <- lm ( timesm ~ agem , data = marathon ) lin2 <- lm ( timesm ~ agem + agemsq , data = marathon ) summary ( lin1 ) summary ( lin2 ) Call: lm(formula = timesm ~ agem, data = marathon) Residuals: Min 1Q Median 3Q Max -70.80 -47.41 -15.95 28.83 149.61 Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept) -89.203 62.054 -1.438 0.17841 agem 4.449 0.910 4.889 0.00048 *** --- Signif. codes: 0 ‘***' 0.001 ‘**' 0.01 ‘*' 0.05 ‘.' 0.1 ‘ ' 1 Residual standard error: 63.52 on 11 degrees of freedom Multiple R-squared: 0.6848, Adjusted R-squared: 0.6562 F-statistic: 23.9 on 1 and 11 DF, p-value: 0.0004801 Call: lm(formula = timesm ~ agem + agemsq, data = marathon) Residuals: Min 1Q Median 3Q Max -47.811 -15.503 5.468 19.742 40.354 Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept) 498.57207 98.79145 5.047 0.000502 *** agem -14.89307 3.13305 -4.754 0.000776 *** agemsq 0.14557 0.02335 6.233 9.72e-05 *** --- Signif. codes: 0 ‘***' 0.001 ‘**' 0.01 ‘*' 0.05 ‘.' 0.1 ‘ ' 1 Residual standard error: 30.14 on 10 degrees of freedom Multiple R-squared: 0.9355, Adjusted R-squared: 0.9226 F-statistic: 72.49 on 2 and 10 DF, p-value: 1.118e-06 Based on the summary, it appears that the quadratic term is quite important, it increases the R-squared significantly. So there does appear to be a quadratic effect of age on the time (or at the very least, a non-linear one). In [4]: lin3 <- lm ( time ~ age + gender ) summary ( lin3 ) Call: lm(formula = time ~ age + gender) Residuals: Min 1Q Median 3Q Max -74.18 -42.85 -14.10 26.96 181.20 Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept) -104.3254 48.9768 -2.130 0.0446 * age 4.6801 0.6979 6.706 9.68e-07 *** gender 35.0534 25.7576 1.361 0.1873 --- Signif. codes: 0 ‘***' 0.001 ‘**' 0.01 ‘*' 0.05 ‘.' 0.1 ‘ ' 1 Residual standard error: 64.15 on 22 degrees of freedom Multiple R-squared: 0.6749, Adjusted R-squared: 0.6454 F-statistic: 22.84 on 2 and 22 DF, p-value: 4.285e-06 Here, the model shows that gender has some part in determining the time (in seconds) of completion, but it is not significant. If the coefficient is correct, it means that, holding age constant, a man will have 35.0534 faster time (or a woman will take 35.0534 additional seconds) to finish the race. Comparing the intercepts in the models shows a pretty large difference in the predictions. The reason why the male-only intercept is different from the intercept in the second model is because the second model is not considering the interaction of age and gender. When you account for this in the model, the intercepts will be the same. The gender coefficient in the model assumes that you are holding everything else constant, that is, the difference between a 35 year old male and female, for instance. When you consider the interaction term as well, this problem is eliminated. Gamma Distribution In [5]: gammalin1 <- glm ( timesm ~ agem , family = \"Gamma\" ) summary ( gammalin1 ) Call: glm(formula = timesm ~ agem, family = \"Gamma\") Deviance Residuals: Min 1Q Median 3Q Max -0.169540 -0.067254 0.001897 0.092610 0.116811 Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept) 1.275e-02 5.748e-04 22.17 1.76e-10 *** agem -1.057e-04 6.839e-06 -15.46 8.30e-09 *** --- Signif. codes: 0 ‘***' 0.001 ‘**' 0.01 ‘*' 0.05 ‘.' 0.1 ‘ ' 1 (Dispersion parameter for Gamma family taken to be 0.009790868) Null deviance: 2.42365 on 12 degrees of freedom Residual deviance: 0.10997 on 11 degrees of freedom AIC: 116.42 Number of Fisher Scoring iterations: 4 The link function here is the canonical link function for the Gamma distribution, which is the inverse ($\\frac{1}{\\mu}$). All variables come up as significant. The model can be written as follows $Y = X\\beta + \\epsilon$ where Y follows a Gamma distribution with link function $g(\\mu) = \\frac{1}{\\mu}$ Inverse-Gaussian distribution The exponential family has the following form: $$ f(y,\\theta ,\\phi ) = e&#94;{\\frac{y \\theta - b(\\theta )}{a(\\phi )} + c(y, \\phi)} $$ The inverse-Gaussian distribution is defined as: $$ f(y) = \\exp (-\\frac{\\lambda (y - \\mu )&#94;2)}{2\\mu &#94;2y} - \\frac{1}{2} \\log (\\frac{2\\pi y&#94;3}{\\lambda})) $$ $$ f(y) = \\exp (-\\frac{\\lambda (y&#94;2 - 2y\\mu + \\mu &#94;2)}{2\\mu &#94;2y} - \\frac{1}{2} \\log (\\frac{2\\pi y&#94;3}{\\lambda})) $$ $$ f(y) = \\exp (\\lambda [-\\frac{y}{2\\mu &#94;2} + \\frac{1}{\\mu}] - \\frac{\\lambda }{2y} - \\frac {1}{2}\\log(\\frac {2\\pi y&#94;3}{\\lambda})) $$ $$ f(y) = \\exp (\\frac {[-\\frac{y}{2\\mu &#94;2} + \\frac{1}{\\mu}]}{\\frac {1}{\\lambda}} - \\frac{\\lambda }{2y} - \\frac {1}{2}\\log(\\frac {2\\pi y&#94;3}{\\lambda})) $$ This is in the exponential form, that is, $$\\theta = - \\frac {1} {2 \\mu &#94;2}$$ $$a(\\phi) = \\frac {1}{\\lambda} = { \\phi}$$ $$b(\\theta) = - \\frac {1}{\\mu} = -\\sqrt{2 \\theta}$$ $$c(y,\\theta) = - \\frac{\\lambda}{2y} - \\frac{1}{2}\\log(\\frac{2\\pi y&#94;3}{\\lambda}) = - \\frac{1}{y\\phi} - \\frac{1}{2}\\log(2\\pi \\phi y&#94;3)$$ $b'(\\theta) = {\\sqrt {\\frac{2}{\\theta }}} = \\mu$ , which is $\\text{E}(Y)$. The canonical link function is $g(\\text{E}(Y))$ = $\\theta$. So, the canonical link is proportional to $\\frac {1}{\\mu &#94;2}$, which is equivalent to $X\\beta$. The model is then $Y = X\\beta + \\epsilon$ where Y follows a inverse Gaussian distribution with link function $g(\\text{E}(Y))$ = 1/$\\mu &#94;2$ In [7]: invgauslin1 <- glm ( timesm ~ agem , family = \"inverse.gaussian\" ) summary ( invgauslin1 ) Call: glm(formula = timesm ~ agem, family = \"inverse.gaussian\") Deviance Residuals: Min 1Q Median 3Q Max -0.0048497 -0.0023005 -0.0000681 0.0005923 0.0123111 Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept) 9.958e-05 3.892e-06 25.59 3.75e-11 *** agem -9.617e-07 4.179e-08 -23.01 1.18e-10 *** --- Signif. codes: 0 ‘***' 0.001 ‘**' 0.01 ‘*' 0.05 ‘.' 0.1 ‘ ' 1 (Dispersion parameter for inverse.gaussian family taken to be 2.180685e-05) Null deviance: 0.01111018 on 12 degrees of freedom Residual deviance: 0.00020857 on 11 degrees of freedom AIC: 102.69 Number of Fisher Scoring iterations: 4 Both are quite difficult to interpret by themselves, as the response variables are transformed via the link function. The predictions for the gamma are as follows: In [8]: predict ( gammalin1 ) pred1 <- 1 / predict ( gammalin1 ) pred2 <- 1 / (( predict ( invgauslin1 ))) &#94; .5 pred3 <- predict ( lin1 ) sum (( pred1 - timesm ) &#94; 2 ) sum (( pred2 - timesm ) &#94; 2 ) sum (( pred3 - timesm ) &#94; 2 ) sum (( predict ( lin2 ) - timesm ) &#94; 2 ) 1 0.00904503120484234 2 0.00851640593952094 3 0.00798778067419954 4 0.00745915540887814 5 0.00693053014355673 6 0.00640190487823533 7 0.00587327961291393 8 0.00534465434759253 9 0.00481602908227113 10 0.00428740381694972 11 0.00375877855162832 12 0.00323015328630692 13 0.00217290275566411 6398.61022699518 5598.12999367698 44389.3243635469 9086.8812639335 Here, we can see the sum squared error of the transformed predictions from the models. We can see that the model using the gamma distribution does an exceptional job at predicting the response variable, time. It is better than both the linear and quadratic simple linear regression models. The inverse-gaussian performs the best out of the three candidate distributions. Below, I do the same thing, except using the identity function. This produces more easily interpretable coefficients, but they are less efficient at predicting the model. That is, when we take the sum of squares, the identity links are less successful at determining the response. In [9]: gammalin2 <- glm ( timesm ~ agem , family = \"Gamma\" ( link = \"identity\" )) summary ( gammalin2 ) invgauslin2 <- glm ( timesm ~ agem , family = \"inverse.gaussian\" ( link = identity )) summary ( invgauslin2 ) predict ( gammalin2 ) predict ( invgauslin2 ) sum (( predict ( gammalin2 ) - timesm ) &#94; 2 ) sum (( predict ( invgauslin2 ) - timesm ) &#94; 2 ) Call: glm(formula = timesm ~ agem, family = Gamma(link = \"identity\")) Deviance Residuals: Min 1Q Median 3Q Max -0.21209 -0.18853 -0.09241 0.08858 0.54268 Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept) -8.3100 38.5463 -0.216 0.833256 agem 3.1548 0.6898 4.574 0.000799 *** --- Signif. codes: 0 ‘***' 0.001 ‘**' 0.01 ‘*' 0.05 ‘.' 0.1 ‘ ' 1 (Dispersion parameter for Gamma family taken to be 0.06523248) Null deviance: 2.42365 on 12 degrees of freedom Residual deviance: 0.60806 on 11 degrees of freedom AIC: 138.73 Number of Fisher Scoring iterations: 9 Call: glm(formula = timesm ~ agem, family = inverse.gaussian(link = identity)) Deviance Residuals: Min 1Q Median 3Q Max -0.012827 -0.011721 -0.006183 0.004403 0.032956 Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept) 10.6841 32.6336 0.327 0.749516 agem 2.7958 0.6252 4.472 0.000944 *** --- Signif. codes: 0 ‘***' 0.001 ‘**' 0.01 ‘*' 0.05 ‘.' 0.1 ‘ ' 1 (Dispersion parameter for inverse.gaussian family taken to be 0.000289055) Null deviance: 0.0111102 on 12 degrees of freedom Residual deviance: 0.0024039 on 11 degrees of freedom AIC: 134.47 Number of Fisher Scoring iterations: 10 1 102.107169679271 2 117.881054509177 3 133.654939339083 4 149.428824168989 5 165.202708998895 6 180.976593828801 7 196.750478658707 8 212.524363488613 9 228.29824831852 10 244.072133148426 11 259.846017978332 12 275.619902808238 13 307.16767246805 1 108.535713328251 2 122.514520425568 3 136.493327522885 4 150.472134620202 5 164.45094171752 6 178.429748814837 7 192.408555912154 8 206.387363009471 9 220.366170106788 10 234.344977204105 11 248.323784301422 12 262.302591398739 13 290.260205593373 52728.0806590428 58577.3835961494 if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Linear Models","url":"category/linear-models/generalized-linear-models.html","loc":"category/linear-models/generalized-linear-models.html"},{"title":"MANOVA","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } Here we will be doing MANOVA for the dataset below. We want to know if the means of tear, gloss and opacity are statistically significantly different from one another depending on the rate groups -- Low or High. Data from manova example: Krzanowski (1998, p. 381) In evaluating MANOVA (Multivariate Analysis of Variance), we can consider a few different approaches to estimating the \"size\" of deviance from the between (the matrix $H$) and the within (the matrix $E$) distances. Each matrix represents something similar to the univariate ANOVA example, but we are now comparing the differences in matrices rather than in vectors. This makes the task more difficult, as we cannot simply use the F-distribution as a comparison of squared differences -- our results will also look like matrices, not single numbers. There have been four proposed solutions to this problem, named after Wilks, Roys, Pillai and Hotelling respectively. Each of these attempts to quantify the magnitude of the between matrix divided by the within matrix using the determinant or the eigenvalues of the product of these two matrices. If this value is greater than a certain threshold, we conclude that the groups are different, via a similar intuition with ANOVA. However, unlike ANOVA, no such simple distribution exists to describe the two error matrices. We also implement here the F approximations for each of these statistics to quantify our results. In [2]: return_MANOVA_results <- function ( dataset , group_column ) { F_dists <- find_approx_F_dist ( dataset , group_column ) results <- 1 - sapply ( X = F_dists [ c ( 'Wilks' , 'Roy' , 'Pillai' , 'Hotelling' )], FUN = function ( obj ) pf ( obj [ 1 ], obj [ 2 ], obj [ 3 ])) results <- rbind ( p_f = results , statistic = F_dists $ untransformed [ 1 : 4 ], data.frame ( F_dists [ c ( 'Wilks' , 'Roy' , 'Pillai' , 'Hotelling' )], row.names = c ( 'F Approx.' , 'df1' , 'df2' ))) return ( results ) } find_approx_F_dist <- function ( dataset , group_column ) { # dataset (dataframe): dataset with groupings as integer values. # group_column (string): string name of column with group entries, integer values. MANOVA_stat_lst <- find_MANOVA_statistics ( dataset , group_column ) Vh <- MANOVA_stat_lst [ 'n_groups' ] - 1 p <- ncol ( dataset ) - 1 Ve <- nrow ( dataset ) - Vh - 1 s <- min ( Vh , p ) Wilks_approx_F <- FforWilks ( Lambda = MANOVA_stat_lst [ 'Wilks' ], Vh = Vh , p = p , Ve = Ve ) Roy_approx_F <- FBoundforRoy ( R = MANOVA_stat_lst [ 'Roys' ], Vh = Vh , p = p , Ve = Ve ) Pillai_approx_F <- FapproxforPillai ( P = MANOVA_stat_lst [ 'Pillai' ], Vh = Vh , p = p , Ve = Ve , s = s ) Hotelling_approx_F <- FapproxforHotelling ( H = MANOVA_stat_lst [ 'Hotelling' ], Vh = Vh , p = p , Ve = Ve ) return ( list ( untransformed = MANOVA_stat_lst , Wilks = Wilks_approx_F , Roy = Roy_approx_F , Pillai = Pillai_approx_F , Hotelling = Hotelling_approx_F )) } find_MANOVA_statistics <- function ( dataset , group_column ){ # dataset (dataframe): dataset with groupings as integer values. # group_column (string): string name of column with group entries, integer values. grouped_ds_lst <- lapply ( 1 : length ( unique ( dataset [, group_column ])), function ( i ) dataset [ dataset [, group_column ] == i , ! names ( dataset ) %in% c ( group_column )]) H <- Reduce ( \"+\" , lapply ( grouped_ds_lst , function ( g ) hypothesis_iv ( g , dataset ))) E <- Reduce ( \"+\" , lapply ( grouped_ds_lst , function ( g ) error_iv ( g , dataset ))) Einv <- solve ( E ) HoverE <- H %*% Einv eigen_det <- eigen ( HoverE ) ev <- eigen_det $ values Wilks <- 1 / ( prod ( 1 + ev )) Roys <- ( max ( ev )) / ( 1 + max ( ev )) Pillai <- sum ( ev / ( 1 + ev )) Hotelling <- sum ( ev ) return ( c ( Wilks = Wilks , Roys = Roys , Pillai = Pillai , Hotelling = Hotelling , n_groups = length ( grouped_ds_lst ))) } hypothesis_iv <- function ( group , dataset ) { A <- sapply ( group , mean ) B <- sapply ( dataset [, 1 : ( ncol ( dataset ) - 1 )], mean ) dif <- A - B return (( dif %*% t ( dif )) * nrow ( group )) } error_iv <- function ( group , dataset ) { A <- sapply ( group , mean ) mattimestranspose <- function ( A ) return ( A %*% t ( A )) mylist <- lapply ( 1 : nrow ( group ), function ( i ) mattimestranspose ( t ( as.matrix ( group [ i ,] - A )))) a1 <- Reduce ( '+' , mylist ) return ( a1 ) } FforWilks <- function ( Lambda , Vh , p , Ve ) { t <- ((( p &#94; 2 ) * ( Vh &#94; 2 ) - 4 ) / (( p &#94; 2 ) + ( Vh &#94; 2 ) - 5 )) &#94; .5 df1 <- p * Vh w <- Ve + Vh - (( p + Vh + 1 ) / 2 ) df2 <- w * t - ((( p * Vh ) - 2 ) / 2 ) Fapprox <- (( 1 - ( Lambda &#94; ( 1 / t ))) / ( Lambda &#94; ( 1 / t ))) * ( df2 / df1 ) return ( c ( Fapprox = Fapprox , df1 = df1 , df2 = df2 )) } FBoundforRoy <- function ( R , Vh , p , Ve ) { v1 <- ( Ve - p - 1 ) / 2 v2 <- ( p - Vh - 1 ) / 2 return ( c ( Fapprox = R * v1 / v2 , df1 = 2 * v1 + 2 , df2 = 2 * v2 + 2 )) } FapproxforPillai <- function ( P , Vh , p , Ve , s ) { N <- ( Ve - Vh + s ) / 2 m <- ( abs ( Vh - p ) - 1 ) / 2 num <- ( 2 * N + s + 1 ) * P den <- ( 2 * m + s + 1 ) * ( s - P ) Fapprox <- num / den df1 <- s * ( 2 * m + s + 1 ) df2 <- s * ( 2 * N + s + 1 ) return ( c ( Fapprox = Fapprox , df1 = df1 , df2 = df2 )) } FapproxforHotelling <- function ( H , Vh , p , Ve ) { a <- p * Vh B <- (( Ve + Vh - p - 1 ) * ( Ve - 1 )) / (( Ve - p - 3 ) * ( Ve - p )) b <- 4 + (( a + 2 ) / ( B - 1 )) cnum <- a * ( b - 2 ) cden <- b * ( Ve - p + 1 ) Fapprox <- ( H * cden ) / cnum return ( c ( Fapprox = Fapprox , df1 = a , df2 = b )) } In [3]: tear <- c ( 6.5 , 6.2 , 5.8 , 6.5 , 6.5 , 6.9 , 7.2 , 6.9 , 6.1 , 6.3 , 6.7 , 6.6 , 7.2 , 7.1 , 6.8 , 7.1 , 7.0 , 7.2 , 7.5 , 7.6 ) gloss <- c ( 9.5 , 9.9 , 9.6 , 9.6 , 9.2 , 9.1 , 10.0 , 9.9 , 9.5 , 9.4 , 9.1 , 9.3 , 8.3 , 8.4 , 8.5 , 9.2 , 8.8 , 9.7 , 10.1 , 9.2 ) opacity <- c ( 4.4 , 6.4 , 3.0 , 4.1 , 0.8 , 5.7 , 2.0 , 3.9 , 1.9 , 5.7 , 2.8 , 4.1 , 3.8 , 1.6 , 3.4 , 8.4 , 5.2 , 6.9 , 2.7 , 1.9 ) rate <- gl ( 2 , 10 , labels = c ( \"Low\" , \"High\" )) Y <- data.frame ( cbind ( tear , gloss , opacity , rate )) return_MANOVA_results ( Y , 'rate' ) Wilks Roy Pillai Hotelling p_f 0.002273044 0.05409917 4.282064e-04 0.001220981 statistic 0.413619230 0.58638077 5.863808e-01 1.417682561 F Approx. 7.560973658 8.20933078 9.451217e+00 8.641112752 df1 3.000000000 16.00000000 3.000000e+00 3.000000000 df2 16.000000000 3.00000000 2.000000e+01 16.000000000 We see that all four methods approximately agree that this would be unlikely if the two groups followed the same Multivariate Normal Distribution. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Multivariate Analysis","url":"category/multivariate-analysis/manova.html","loc":"category/multivariate-analysis/manova.html"},{"title":"Determining Sampling Schemes for Hierarchies","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } First, we will treat the csv \"schools_ds\" as the population that follows a random intercept model based on the group. We will use this to investigate the sampling strategies that one could use and see how the models compare. This data considers scores from various schools, with the score representing a students' score on a test, and the grpID represeting the school. In [2]: data <- read.csv ( \"./schools_ds.csv\" ) head ( data ) require ( lme4 ) mod1 <- lmer ( score ~ 1 + ( 1 | grpID ), data = data ) summary ( mod1 ) X score grpID 1 100 1 2 110 1 3 96 1 4 80 1 5 83 1 6 76 1 Loading required package: lme4 Loading required package: Matrix Linear mixed model fit by REML ['lmerMod'] Formula: score ~ 1 + (1 | grpID) Data: data REML criterion at convergence: 9142.6 Scaled residuals: Min 1Q Median 3Q Max -2.9995 -0.6230 -0.0388 0.6663 3.7416 Random effects: Groups Name Variance Std.Dev. grpID (Intercept) 32.01 5.658 Residual 233.57 15.283 Number of obs: 1100, groups: grpID, 10 Fixed effects: Estimate Std. Error t value (Intercept) 101.298 1.876 53.99 This exercise will be investigating the effect of sampling schema on the effectiveness of HLMS by looking at school data. Each school has a different number of students, and we wish to fit a random intercept model based on the school. I first create some functions that will be useful for me in creating the samples. The first creates a sample from a group of n elements. The second transfers a list into a data frame. I then create the samples by first randomly selecting 11 from each group, then selecting i*2 from each group (so 2 from group 1, 4 from group 2, etc.). Helper functions In [3]: samplefromgroup <- function ( grp , n ){ j = sample ( 1 : length ( data [ data $ grpID == grp , 1 ]), n ) return ( data [ data $ grpID == grp ,][ j ,]) } lt2df <- function ( l ){ return ( as.data.frame ( do.call ( rbind.data.frame , l ))) } Simulation In [4]: simresults <- list () for ( sim in 1 : 10 &#94; 3 ) { sample1 <- list () nschool <- length ( unique ( data $ grpID )) for ( i in 1 : nschool ){ sample1 [[ i ]] <- samplefromgroup ( i , 11 ) } sample1 <- lt2df ( sample1 ) sample1 sample2 <- list () for ( i in 1 : nschool ){ sample2 [[ i ]] <- samplefromgroup ( i , 2 * i ) } sample2 <- lt2df ( sample2 ) sample2 sample3 <- list () randomschool <- sample ( 1 : nschool , 5 ) trigger <- any ( randomschool == 1 ) if ( trigger ){ remaining <- ! randomschool == 1 remsch <- randomschool [ remaining ] randomselect23 <- sample ( remsch , 2 ) schoolselect22 <- remsch [ remsch != randomselect23 [ 1 ] & remsch != randomselect23 [ 2 ]] sample3 [[ 1 ]] <- data [ data $ grpID == 1 ,] for ( i in 1 : 2 ){ sample3 [[ i +1 ]] <- samplefromgroup ( randomselect23 [ i ], 23 ) sample3 [[ i +3 ]] <- samplefromgroup ( schoolselect22 [ i ], 22 ) } } else { for ( i in 1 : length ( randomschool )){ sample3 [[ i ]] <- samplefromgroup ( randomschool [ i ], 22 ) } } sample3 <- lt2df ( sample3 ) sample3 sample4 <- list () weights <- vector () for ( i in 1 : nschool ){ weights [ i ] <- length ( data [ data $ grpID == i , 1 ]) / nrow ( data ) } randomschool2 <- sample ( 1 : nschool , 5 , prob = weights ) trigger2 <- any ( randomschool2 == 1 ) if ( trigger2 ){ remaining2 <- ! randomschool2 == 1 remsch2 <- randomschool2 [ remaining2 ] randomselect232 <- sample ( remsch2 , 2 ) schoolselect222 <- remsch2 [ remsch2 != randomselect232 [ 1 ] & remsch2 != randomselect232 [ 2 ]] sample4 [[ 1 ]] <- data [ data $ grpID == 1 ,] for ( i in 1 : 2 ){ sample4 [[ i +1 ]] <- samplefromgroup ( randomselect232 [ i ], 23 ) sample4 [[ i +3 ]] <- samplefromgroup ( schoolselect222 [ i ], 22 ) } } else { for ( i in 1 : length ( randomschool )){ sample4 [[ i ]] <- samplefromgroup ( randomschool2 [ i ], 22 ) } } sample4 <- as.data.frame ( do.call ( rbind.data.frame , sample4 )) sample4 listofsamples <- list ( sample1 , sample2 , sample3 , sample4 ) parameters <- matrix ( nrow = 3 , ncol = 4 ) rownames ( parameters ) <- c ( \"Gamma00\" , \"Sigma\" , \"Tao0\" ) colnames ( parameters ) <- c ( \"Model 1\" , \"Model 2\" , \"Model 3\" , \"Model 4\" ) models <- list () for ( i in 1 : length ( listofsamples )){ models [[ i ]] <- lmer ( score ~ 1 + ( 1 | grpID ), data = listofsamples [[ i ]]) parameters [ 1 , i ] <- summary ( models [[ i ]]) $ coef [ 1 ] parameters [ 2 , i ] <- summary ( models [[ i ]]) $ sigma parameters [ 3 , i ] <- as.data.frame ( VarCorr ( models [[ i ]]))[ 1 , 5 ] } simresults [[ sim ]] <- parameters } fullmodelparameters <- matrix ( rep ( c ( summary ( mod1 ) $ coef [ 1 ], summary ( mod1 ) $ sigma , as.data.frame ( VarCorr ( mod1 ))[ 1 , 5 ]), 4 ), nrow = 3 ) simresults [[ 1 ]] - fullmodelparameters Warning message in optwrap(optimizer, devfun, getStart(start, rho$lower, rho$pp), : \"convergence code 3 from bobyqa: bobyqa -- a trust region step failed to reduce q\" Model 1 Model 2 Model 3 Model 4 Gamma00 -0.0801288 -2.981430985 -0.3801288 -0.9437652 Sigma 0.7517267 -0.005658724 -0.8614719 1.1448531 Tao0 2.2040381 -2.554488338 -0.4333093 -0.3124444 I then create a list of samples, and use each of these samples to sample using the models. I create a matrix that will store the parameters in parameters , and it stores the fixed effect ($\\gamma_{0,0}$) and the variances of the random effects ($\\sigma&#94;2$ and $\\tau&#94;2$) for each model, using each sample. It then stores this information for each simulation, which is done $10&#94;5$ times. This means the samples are created differently each time, and then the model is fit using each sample, and the information is stored in a list for each simulation. I then compare this to the model using the full population, which are the full model parameters. As an example, we can see the bias from the first simulation of each model, for each variable. I then compute the mean bias, mean squared error, and mean variance for each of the samples. I do this by summing all of the individual biases, squared errors, and variances, and dividing by the total number of simulations. In [5]: indbias <- lapply ( simresults , function ( x ) x - fullmodelparameters ) indsquarederror <- lapply ( simresults , function ( x ) ( x - fullmodelparameters ) &#94; 2 ) mean <- Reduce ( '+' , simresults ) / 10 &#94; 5 indvariance <- lapply ( simresults , function ( x ) ( x - mean ) &#94; 2 ) mse <- Reduce ( '+' , indsquarederror ) / 10 &#94; 5 variance <- Reduce ( '+' , indvariance ) / 10 &#94; 5 fullbias <- Reduce ( '+' , indbias ) / 10 &#94; 5 mse variance fullbias Model 1 Model 2 Model 3 Model 4 Gamma00 0.01748752 0.02072217 0.05179054 0.04740217 Sigma 0.01140245 0.01069759 0.01055099 0.01016488 Tao0 0.03968227 0.02583796 0.04847282 0.04262270 Model 1 Model 2 Model 3 Model 4 Gamma00 100.2610814 101.440250 100.5597129 101.5455572 Sigma 2.2049334 2.290984 2.2154111 2.2687420 Tao0 0.3043728 0.366400 0.2977824 0.3723673 Model 1 Model 2 Model 3 Model 4 Gamma00 -0.001651197 0.0042711199 -0.000320029 0.004667134 Sigma -0.003194664 -0.0002994215 -0.002816646 -0.001024023 Tao0 -0.004419130 0.0024195585 -0.005803453 0.001443499 Discussion The components of the MSE can be decomposed into the variance and the bias (MSE = $b&#94;2$ + $\\sigma&#94;2$). This discussion is especially important to application because it is often expensive or impossible to gather data from the entire population (thus why we sample in the first place), and in the same vein, it may be expensive or difficult to gather data from all of the subsequent groups. Sampling the schools may be seen as desirable in this instance, as it will likely require less resources to acquire information from 5 groups rather than 10. However, we can see from the above that the effects of this on the models are somewhat large, and sampling from the number of schools does not produce the same results as sampling from each school directly. While it may not be immediately obvious from this problem, if you were to try to sample from, say, 100,000 schools, 1,000 students in each school, this could become extremely expensive and difficult to do. Thus the importance of the results here cannot be stressed enough - it is not equivalent to randomly sample 5 (or any number) groups and select a comparable number of students. Due to the structure of the HLMs, a great deal of information is lost if we neglect to look at all of the groups. This is reflected in the results above. Models 3 and 4 show considerably worse results than the first two models. This suggest that sampling from the number of schools, which may be less expensive, is less accurate at predicting the true model underlying the data. That is, using more groups will produce more favorable results in the application of HLM, even though the number of students is exactly the same in all cases. We see that the estimates of $\\sigma$ are more accurate in terms of mse. This makes sense, as we can more accurately account for the individual differences, as there are less groups. However, this is a consequence of the sampling - and therefore, the $\\tau_{0}$ estimates are much, much worse for the later two models. Since we have constructed the HLM's to account for variations within groups, and we are often interested in the level 2 variations as well, gaining a small amount of accuracy in sigma for a large drop in accuracy of $\\tau_0$ is unfavorable. If we were that much more concerned with estimating $\\sigma$ than $\\tau$, we wouldn't be using a HLM in the first place. We also see a larger difference in the estimates for $\\gamma_0$ for the later two models. The other structure that is included here involves weighting the models by the number of students in each school. Thus Model 2 and Model 4 weigh the results by the number of students, while Model 1 and Model 3 treat them all as if they are equivalent. We see that using the weighing strategy produces worse results for the fixed coefficients, but in general is better for the random coefficients. This makes sense, since this weighing is based on the groups themselves, which will introduce more bias and variance in the fixed coefficients for the intercept. However, there is a trade off here, as the mse for both $\\sigma$ and $\\tau_0$ decreases, which suggests that the random components of the models are closer to the true random parameters. The weighed models produce more variance in estimating sigma, but less bias, and produce better results for both for $\\tau_0$. This makes sense, as weighing the groups will produce less biased estimates for the individual random effect, but produce a higher variance as these results have different amounts of students sampled. $\\tau_0$ will be more accurate in terms of both variance and bias, as we are accounting for the differences in the groups, which is reflected in the full model in a similar way. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Linear Models","url":"category/linear-models/determining-sampling-schemes-for-hierarchies.html","loc":"category/linear-models/determining-sampling-schemes-for-hierarchies.html"},{"title":"ANOVA","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } A common argument against ANOVA is non-normality -- when the variables in question do not follow a normal distribution. This exercise will explore that contention in more detail. I will be comparing simulated exponential and beta distributed variables to results of the F distribution of ANOVA to determine how inaccurate ANOVA is when used on variables that are independent and identically distributed to a non-Normal distribution. Helper Functions First, let's define some helper functions -- these define the sum of squares for the treatment and error. In [2]: sst <- function ( a , n , r ) { a <- matrix ( a , n , r ) rowmean <- apply ( a , 2 , mean ) sum ( n * ( rowmean - mean ( rowmean )) &#94; 2 ) } sse <- function ( a , n , r ) { a <- matrix ( a , n , r ) rowmean <- apply ( a , 2 , mean ) b <- numeric () for ( i in 1 : n ) { b [ i ] <- sum (( a [ i ,] - rowmean ) &#94; 2 ) } sum ( b ) } The following code creates $10&#94;5$ sets of 4 groups of 3, finds the $F$ statistic associated with each and stores it in an R object. So exemp1 has the empirical F statistics for $10&#94;5$ such sets using an exponential distribution, and bemp has the empirical $F$ statistics for $10&#94;5$ sets using a beta distribution. In [4]: help ( rexp ) In [3]: expemp1 <- numeric ( 10 &#94; 5 ) for ( l in 1 : 10 &#94; 5 ){ a <- rexp ( 12 , 1 ) f <- ( sst ( a , 3 , 4 ) / 3 ) / ( sse ( a , 3 , 4 ) / 8 ) expemp1 [ l ] <- f } expemp2 <- numeric ( 10 &#94; 5 ) for ( l in 1 : 10 &#94; 5 ){ a <- rexp ( 120 , 1 ) f <- ( sst ( a , 30 , 4 ) / 3 ) / ( sse ( a , 30 , 4 ) / 116 ) expemp2 [ l ] <- f } bemp1 <- numeric ( 10 &#94; 5 ) for ( l in 1 : 10 &#94; 5 ){ a <- rbeta ( 12 , 5 , 2 ) f <- ( sst ( a , 3 , 4 ) / 3 ) / ( sse ( a , 3 , 4 ) / 8 ) bemp1 [ l ] <- f } bemp2 <- numeric ( 10 &#94; 5 ) for ( l in 1 : 10 &#94; 5 ){ a <- rbeta ( 120 , 5 , 2 ) f <- ( sst ( a , 30 , 4 ) / 3 ) / ( sse ( a , 30 , 4 ) / 116 ) bemp2 [ l ] <- f } This has created all of the $F$ statistics needed to determine. This then uses $exp(12)$ with 4 groups of 3 and 30, and $beta(5,2)$ with 4 groups of 3 and 30. Below I create a table F to compare them with the true mean of the $F$ distribution ($\\frac{df_2}{df_2-2}$) and the quantiles (the median and 95th quantile.) In [5]: f1mean <- 9 / 7 f2mean <- 116 / 114 table_F <- matrix ( c ( f1mean , mean ( expemp1 ), mean ( bemp1 ), f2mean , mean ( expemp2 ), mean ( bemp2 ), qf ( .5 , 3 , 9 ), median ( expemp1 ), median ( bemp1 ), qf ( .5 , 3 , 116 ), median ( expemp2 ), median ( bemp2 ), qf ( .95 , 3 , 9 ), quantile ( expemp1 , .95 ), quantile ( bemp1 , .95 ), qf ( .95 , 3 , 116 ), quantile ( expemp2 , .95 ), quantile ( bemp2 , .95 )), 6 ) colnames ( table_F ) <- c ( \"Mean\" , \"Median\" , \"95th Percentile\" ) rownames ( table_F ) <- c ( \"F,3,9\" , \"Empirical Exp,3,4\" , \"Empirical Beta,3,4\" , \"F,3,116\" , \"Empirical Exp,30,4\" , \"Empirical Beta,30,4\" ) table_F Mean Median 95th Percentile F,3,9 1.285714 0.8516840 3.862548 Empirical Exp,3,4 1.319407 0.8701090 3.778306 Empirical Beta,3,4 1.353786 0.8590901 4.150790 F,3,116 1.017544 0.7933195 2.682809 Empirical Exp,30,4 1.013416 0.8021038 2.628236 Empirical Beta,30,4 1.017539 0.7929869 2.691883 Discussion We can see that, for the mean, the true F distribution has a lower mean than the empirical beta and exponential using 4 groups of 3. This suggests that if we were to use ANOVA with data with an exponential or beta distribution, the mean would be underestimated. That is, the true mean would be higher than that given by the F-distribution. For the median, the true F distribution again would underestimate the empirical results from the beta and exponential distributions. This implies that if we were to use ANOVA and found a P-value of .5 using the F-distribution, the true p-value would be lower than this. So our estimations would be skewed in favor of not rejecting the null hypothesis if we were to set the significance to .5. The 95th percentile is perhaps the most interesting case, where we can see some difference between the two empirical distributions. In the case of the exponential distribution, we can see that the empirical exponential F statistic produced lower 95th quantiles than the true F distribution. Suppose we were to run ANOVA on data that was exponentially distributed and got an F statistic of 3.8. Using the true F distribution, we would conclude that we cannot reject the null hypothesis that the two groups behave the same with 95% confidence. However, the true exponential distribution would have a 95th percentile of 3.72, meaning we would reject the null hypothesis that the groups are the same. It results in a type II error - we fail to reject the null hypothesis when it is false. The reverse is true for the beta distribution. Let's say we run ANOVA with data coming from an underlying beta(5,2) distribution and we get an F statistic of 4. The true F distribution would suggest that we reject the null that the groups are the same with 95% confidence - however, the empirical F using beta has a 95th percentile of 4.12, leading us to a Type I error, we have rejected the null hypothesis when it is true. When we increase the value of n, we see that the discrepancies between the true F distribution and the empirical distributions shrink. This makes sense intuitively; due to the central limit theorem, we would expect this to occur as we increase the number in each group. There are still some discrepancies, but the difference is not very large and would likely not give very different results except at the margin (when it is exactly one of the values of the other distributions). Interestingly, the beta distribution produces a lower F empirical than the true distribution for the 95th percentile and the median in this case. This seems preferable, because it means that Type I error (a false positive) is no more likely (in fact, less likely) using the true F distribution, as it is in fact more conservative than the actual distributions. So if we have a large sample size (n=120), and we are able to reject the null hypothesis, knowing only that the original distribution of each data point was either exponential, beta(5,2) or normally distributed (as is the normal case in ANOVA), we can be confident that our conclusion is correct regardless of which distribution it originally followed. It is in this sense that the original assumption of normality for ANOVA is perhaps not so important - compared to the independent and identically distributed assumption which has a larger effect if it is not satisfied. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Linear Models","url":"category/linear-models/anova.html","loc":"category/linear-models/anova.html"},{"title":"Summary Statistics Part 2: Measures of Spread","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } Measures of Spread In the last post on central tendency , we discussed the basics of what a statistic and a population is as well as the common measures of central tendency, the mean , median and mode . In this post, we will dive deeper into how to describe sample and population data using Measures of Spread. When we talked about central tendency, we discussed the idea behind the \"average\" observation in a pool of data. When it comes to describing a dataset, the central tendency is a great place to start -- it gives us a sense of the location of our data. For instance, if we had the weight of a variety of individuals, we can get a sense of what a \"typical\" weight might be using measures of central tendency. Alien Brains Imagine you are an observer who knows nothing about a particular subject. Let's say this subject is the number of neurons in a sample of aliens' brains. Or, you know, something. Based on this information alone, an ordinary, human observer would have absolutely no sense of where to begin. That is, we have absolutely no prior information about aliens' brains. Let's say the sample of neurons in 100 aliens found in the first UFO crashing ever known to man look something like this: In [1]: import numpy as np import pandas as pd import scipy.stats import plotly.offline as plt import plotly.graph_objs as go plt . init_notebook_mode ( connected = True ) window.PlotlyConfig = {MathJaxConfig: 'local'}; if (window.MathJax) {MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});} if (typeof require !== 'undefined') { require.undef(\"plotly\"); requirejs.config({ paths: { 'plotly': ['https://cdn.plot.ly/plotly-latest.min'] } }); require(['plotly'], function(Plotly) { window._Plotly = Plotly; }); } In [47]: alien_neurons = pd . Series ( np . random . negative_binomial ( 424242 , . 0042 , 100 )) In [48]: data = [ go . Histogram ( x = alien_neurons . tolist ())] layout = go . Layout ( title = 'Alien Brains' , xaxis = dict ( title = 'Number of Neurons' ), yaxis = dict ( title = 'Number of Aliens' ), bargap = 0.2 , bargroupgap = 0.1 ) fig = go . Figure ( data = data , layout = layout ) plt . iplot ( fig ) require([\"plotly\"], function(Plotly) { window.PLOTLYENV=window.PLOTLYENV || {}; window.PLOTLYENV.BASE_URL='https://plot.ly'; if (document.getElementById(\"09ae3301-bd44-49a0-9519-dfd56c1467c5\")) { Plotly.newPlot( '09ae3301-bd44-49a0-9519-dfd56c1467c5', [{\"type\": \"histogram\", \"uid\": \"5e303c3d-e696-4e70-9952-95d4879c4f01\", \"x\": [100507682, 100601005, 100336496, 100623165, 100754041, 100856570, 100702398, 100729273, 100411299, 100556471, 100697638, 100540953, 100411717, 100478614, 100574488, 100499210, 100852747, 100651745, 100697942, 100484243, 100397057, 100552299, 100388278, 100785268, 100546213, 100522820, 100426863, 100282560, 100397992, 100590144, 100248387, 100545909, 100517592, 100687610, 100657954, 100568996, 100569742, 100442644, 100411784, 100579139, 100520273, 100738283, 100342396, 100445818, 100624941, 100764764, 100430309, 100737396, 100761735, 100353133, 100467783, 100533562, 100415755, 100564377, 100444869, 100578210, 100630623, 100761510, 100550665, 100546729, 100360033, 100672311, 100472937, 100750441, 100616384, 100577225, 100397447, 100554639, 100617736, 100420158, 100568391, 100779155, 100415724, 100318415, 100496400, 100483601, 100511965, 100398418, 100613111, 100467889, 100696693, 100689413, 100656193, 100412745, 100548172, 100419812, 100603947, 100631853, 100453490, 100657843, 100290953, 100387413, 100512580, 100223744, 100436972, 100392013, 100836090, 100636159, 100540619, 100668141]}], {\"bargap\": 0.2, \"bargroupgap\": 0.1, \"title\": {\"text\": \"Alien Brains\"}, \"xaxis\": {\"title\": {\"text\": \"Number of Neurons\"}}, \"yaxis\": {\"title\": {\"text\": \"Number of Aliens\"}}}, {\"showLink\": false, \"linkText\": \"Export to plot.ly\", \"plotlyServerURL\": \"https://plot.ly\", \"responsive\": true} ).then(function(){ var gd = document.getElementById('09ae3301-bd44-49a0-9519-dfd56c1467c5'); var x = new MutationObserver(function (mutations, observer) {{ var display = window.getComputedStyle(gd).display; if (!display || display === 'none') {{ console.log([gd, 'removed!']); Plotly.purge(gd); observer.disconnect(); }} }}); // Listen for the removal of the full notebook cells var notebookContainer = gd.closest('#notebook-container'); if (notebookContainer) {{ x.observe(notebookContainer, {childList: true}); }} // Listen for the clearing of the current output cell var outputEl = gd.closest('.output'); if (outputEl) {{ x.observe(outputEl, {childList: true}); }} }) }; }); Woah! These values are in the hundreds of millions! Well actually, the human brain has over 100,000,000,000 neurons! So, this alien is not the most sophisticated in terms of neurons. Is there a way to see this, the location, more quantitatively? Your answer should be ... yes! Using the techniques we learned last time, we can find the mean and median of this distribution. To spare the agony of performing this arithmetic on such huge numbers, we can use pandas to find these values. In [49]: alien_mean , alien_median = alien_neurons . aggregate ([ 'mean' , 'median' ]) print ( '''Mean of Alien Neurons: {} , Median of Alien Neurons: {} ''' . format ( alien_mean , alien_median )) Mean of Alien Neurons: 100544873.04, Median of Alien Neurons: 100546471.0 This means that the mean of this sample is 100,584,186.03 and the median is 100,592,749. These values are quite \"close\", which is expected because we see that the distribution is somewhat symmetric. But... wait a minute! How are we certain that these two values are \"close\"? We can look at our histogram to see if this assertion is correct. In [50]: alien_mean - alien_median Out[50]: -1597.9599999934435 In [51]: data = [ go . Histogram ( x = alien_neurons . tolist ())] shapes = [{ 'type' : 'line' , 'name' : 'Mean' , 'line' : { 'color' : 'red' }, 'xref' : 'x' , 'yref' : 'y' , 'x0' : alien_mean , 'y0' : 0 , 'x1' : alien_mean , 'y1' : 20 , }, { 'type' : 'line' , 'name' : 'Median' , 'line' : { 'color' : 'black' }, 'xref' : 'x' , 'yref' : 'y' , 'x0' : alien_median , 'y0' : 0 , 'x1' : alien_median , 'y1' : 20 , }] layout = go . Layout ( title = 'Alien Brains' , xaxis = dict ( title = 'Number of Neurons' ), yaxis = dict ( title = 'Number of Aliens' ), bargap = 0.2 , bargroupgap = 0.1 , shapes = shapes ) fig = go . Figure ( data = data , layout = layout ) plt . iplot ( fig ) require([\"plotly\"], function(Plotly) { window.PLOTLYENV=window.PLOTLYENV || {}; window.PLOTLYENV.BASE_URL='https://plot.ly'; if (document.getElementById(\"3e5aed8e-0899-454d-b71a-f03f955e1bc1\")) { Plotly.newPlot( '3e5aed8e-0899-454d-b71a-f03f955e1bc1', [{\"type\": \"histogram\", \"uid\": \"0d4397e6-67cb-403d-8f39-c79630522a63\", \"x\": [100507682, 100601005, 100336496, 100623165, 100754041, 100856570, 100702398, 100729273, 100411299, 100556471, 100697638, 100540953, 100411717, 100478614, 100574488, 100499210, 100852747, 100651745, 100697942, 100484243, 100397057, 100552299, 100388278, 100785268, 100546213, 100522820, 100426863, 100282560, 100397992, 100590144, 100248387, 100545909, 100517592, 100687610, 100657954, 100568996, 100569742, 100442644, 100411784, 100579139, 100520273, 100738283, 100342396, 100445818, 100624941, 100764764, 100430309, 100737396, 100761735, 100353133, 100467783, 100533562, 100415755, 100564377, 100444869, 100578210, 100630623, 100761510, 100550665, 100546729, 100360033, 100672311, 100472937, 100750441, 100616384, 100577225, 100397447, 100554639, 100617736, 100420158, 100568391, 100779155, 100415724, 100318415, 100496400, 100483601, 100511965, 100398418, 100613111, 100467889, 100696693, 100689413, 100656193, 100412745, 100548172, 100419812, 100603947, 100631853, 100453490, 100657843, 100290953, 100387413, 100512580, 100223744, 100436972, 100392013, 100836090, 100636159, 100540619, 100668141]}], {\"bargap\": 0.2, \"bargroupgap\": 0.1, \"shapes\": [{\"line\": {\"color\": \"red\"}, \"name\": \"Mean\", \"type\": \"line\", \"x0\": 100544873.04, \"x1\": 100544873.04, \"xref\": \"x\", \"y0\": 0, \"y1\": 20, \"yref\": \"y\"}, {\"line\": {\"color\": \"black\"}, \"name\": \"Median\", \"type\": \"line\", \"x0\": 100546471.0, \"x1\": 100546471.0, \"xref\": \"x\", \"y0\": 0, \"y1\": 20, \"yref\": \"y\"}], \"title\": {\"text\": \"Alien Brains\"}, \"xaxis\": {\"title\": {\"text\": \"Number of Neurons\"}}, \"yaxis\": {\"title\": {\"text\": \"Number of Aliens\"}}}, {\"showLink\": false, \"linkText\": \"Export to plot.ly\", \"plotlyServerURL\": \"https://plot.ly\", \"responsive\": true} ).then(function(){ var gd = document.getElementById('3e5aed8e-0899-454d-b71a-f03f955e1bc1'); var x = new MutationObserver(function (mutations, observer) {{ var display = window.getComputedStyle(gd).display; if (!display || display === 'none') {{ console.log([gd, 'removed!']); Plotly.purge(gd); observer.disconnect(); }} }}); // Listen for the removal of the full notebook cells var notebookContainer = gd.closest('#notebook-container'); if (notebookContainer) {{ x.observe(notebookContainer, {childList: true}); }} // Listen for the clearing of the current output cell var outputEl = gd.closest('.output'); if (outputEl) {{ x.observe(outputEl, {childList: true}); }} }) }; }); Well, they look pretty close. However, this is far too hand-wavy of an answer. In determining the \"closeness\" of these two statistics, we would like to have an objective measure relative to scale. The actual difference is around {{alien_mean - alien_median}}! With just that information alone, we would likely not say that the two are \"close\". If the difference between what you got in a paycheck was \\$8,563 less than what you expected, you would definitely be upset! The more we think about it, relative differences like these are reliant of the <b> scale </b> of the numbers we're talking about. 8,000 stars may be astronomically small compared to the total number of stars, but \\$8,000 is significant to most people! However, because of the scale of this distribution, this is not a large difference relative to the differences in observations. Imagine we had a distribution that looked like this instead: In [52]: log_norm_sigma = 1.158 log_norm_mu = np . log (( alien_mean - alien_median ) / ( 1 - np . exp ( ( log_norm_sigma ** 2 ) / 2 ))) sim = pd . Series ( np . random . lognormal ( mean = log_norm_mu , sigma = log_norm_sigma , size = 100 )) In [53]: data = [ go . Histogram ( x = sim . tolist ())] shapes = [{ 'type' : 'line' , 'name' : 'Mean' , 'line' : { 'color' : 'red' }, 'xref' : 'x' , 'yref' : 'y' , 'x0' : sim . mean (), 'y0' : 0 , 'x1' : sim . mean (), 'y1' : 50 , }, { 'type' : 'line' , 'name' : 'Median' , 'line' : { 'color' : 'black' }, 'xref' : 'x' , 'yref' : 'y' , 'x0' : sim . median (), 'y0' : 0 , 'x1' : sim . median (), 'y1' : 50 , }] layout = go . Layout ( title = 'Not Alien Brains' , xaxis = dict ( title = 'Counts' ), yaxis = dict ( title = 'Volume' ), bargap = 0.2 , bargroupgap = 0.1 , shapes = shapes ) fig = go . Figure ( data = data , layout = layout ) plt . iplot ( fig ) require([\"plotly\"], function(Plotly) { window.PLOTLYENV=window.PLOTLYENV || {}; window.PLOTLYENV.BASE_URL='https://plot.ly'; if (document.getElementById(\"4cd22171-3ebd-468e-8ae1-f7c03abd1a07\")) { Plotly.newPlot( '4cd22171-3ebd-468e-8ae1-f7c03abd1a07', [{\"type\": \"histogram\", \"uid\": \"6bf4918b-be79-4c0a-9ccb-068d3fd435da\", \"x\": [1815.2961130358603, 2320.218549594198, 1774.238950351985, 10129.329569604373, 1291.3107998367987, 223.3226019797967, 511.1190584745391, 2539.1462070254247, 1691.7984992130866, 3932.300750670352, 6793.957503120814, 1535.0287569346979, 2022.8973728018339, 1053.8154762349425, 973.5181073035899, 323.6513923572703, 9726.847031775475, 7135.352086198367, 3512.474945472328, 6227.505350176736, 13244.888216522466, 2867.9361099027983, 807.5146428567614, 2894.549648576427, 2244.178387714029, 3257.1038221480812, 1736.2230124900836, 924.3957750430835, 3939.8535567342283, 203.32884083827767, 14045.997332778845, 546.2147123850925, 417.5538715626165, 107.90409001348492, 1704.8438615097614, 113.8419174685519, 2439.006413127879, 1843.269218713016, 808.3472313135118, 866.3462227327186, 1505.053252145675, 1046.5330708322601, 2068.027719683339, 251.17616713782976, 141.12043094440338, 819.6818612377483, 2020.2503585291886, 417.7717118081688, 1978.642699972511, 4152.00901968332, 7141.121777756109, 294.25439730884705, 5055.263403490116, 2359.4096263832603, 737.0583169703585, 756.5588683955067, 1688.1995118447353, 1200.3525822057034, 5537.486837091894, 3052.5661838992432, 716.0370763823562, 9048.079440812544, 235.87876321395117, 779.4247291113422, 376.7574206190164, 1871.9125744152384, 1405.5064649823244, 1715.8137527463932, 8766.403226820257, 21225.42670423942, 4486.2549196354785, 416.20474169790657, 1517.5508166911504, 1267.3033729274018, 1133.9330477820738, 389.8746550213425, 67.45747393366179, 486.5432413205892, 7031.818751334337, 2086.3679690315575, 2097.541446182641, 2840.221558126296, 2919.222008028245, 5299.136151360571, 14501.064835070783, 1688.2746230691446, 3801.6947174533625, 1643.3099010076398, 204.99257950344463, 8409.984220817802, 1017.3364757112194, 1338.7638173892342, 404.5430086683285, 2607.930463755532, 171.50491673765143, 464.69817123005356, 2333.719993719836, 8551.131279451381, 8005.88791102838, 945.8413547396598]}], {\"bargap\": 0.2, \"bargroupgap\": 0.1, \"shapes\": [{\"line\": {\"color\": \"red\"}, \"name\": \"Mean\", \"type\": \"line\", \"x0\": 2970.40312379684, \"x1\": 2970.40312379684, \"xref\": \"x\", \"y0\": 0, \"y1\": 50, \"yref\": \"y\"}, {\"line\": {\"color\": \"black\"}, \"name\": \"Median\", \"type\": \"line\", \"x0\": 1710.3288071280772, \"x1\": 1710.3288071280772, \"xref\": \"x\", \"y0\": 0, \"y1\": 50, \"yref\": \"y\"}], \"title\": {\"text\": \"Not Alien Brains\"}, \"xaxis\": {\"title\": {\"text\": \"Counts\"}}, \"yaxis\": {\"title\": {\"text\": \"Volume\"}}}, {\"showLink\": false, \"linkText\": \"Export to plot.ly\", \"plotlyServerURL\": \"https://plot.ly\", \"responsive\": true} ).then(function(){ var gd = document.getElementById('4cd22171-3ebd-468e-8ae1-f7c03abd1a07'); var x = new MutationObserver(function (mutations, observer) {{ var display = window.getComputedStyle(gd).display; if (!display || display === 'none') {{ console.log([gd, 'removed!']); Plotly.purge(gd); observer.disconnect(); }} }}); // Listen for the removal of the full notebook cells var notebookContainer = gd.closest('#notebook-container'); if (notebookContainer) {{ x.observe(notebookContainer, {childList: true}); }} // Listen for the clearing of the current output cell var outputEl = gd.closest('.output'); if (outputEl) {{ x.observe(outputEl, {childList: true}); }} }) }; }); As a sidenote, the way this distribution was simulated was using the fact that we want a relative difference in the mean and median in the population to be equal to 4,692, but on a completely different scale. This was using the lognormal distribution, which is a skewed distribution, so it works well for this purpose! In [54]: sim . mean () - sim . median () Out[54]: 1260.074316668763 We can now clearly see that the absolute differences in the mean and median (and in fact, any of the observations) is not sufficient to describe their \"closeness\" to one another. We have an idea of the location, but we need a sense of scale. Why does spread matter? We can already see why the measures of central tendency are insufficient to give us an idea of what a distribution looks like. To investigate further, suppose we know only that the mean of some observations is 100. What else can we say? Well, not much. Consider the two distributions below. Both populations have mean 100, and we sample 100 values from them. The resulting samples have means very close to one another (and to 100), but they are quite different from one another. In [55]: ex_1 = np . random . normal ( 100 , 2 , 1000 ) ex_2 = np . random . normal ( 100 , 10 , 1000 ) data = [ go . Histogram ( x = ex_1 . tolist (), name = 'Less Variant' ), go . Histogram ( x = ex_2 . tolist (), name = 'More Variant' ) ] layout = go . Layout ( title = 'Mean of 100' , xaxis = dict ( title = 'Value' ), yaxis = dict ( title = 'Volume' ), ) figure = go . Figure ( data = data , layout = layout ) plt . iplot ( figure ) require([\"plotly\"], function(Plotly) { window.PLOTLYENV=window.PLOTLYENV || {}; window.PLOTLYENV.BASE_URL='https://plot.ly'; if (document.getElementById(\"a88eee82-3b22-4b01-91c5-078e071902a1\")) { Plotly.newPlot( 'a88eee82-3b22-4b01-91c5-078e071902a1', [{\"name\": \"Less Variant\", \"type\": \"histogram\", \"uid\": \"cd804516-5933-4b30-8d43-5368731efb3d\", \"x\": [99.38985063430285, 101.57786997499045, 97.72968143733631, 99.86580330462117, 100.60960920723952, 100.19453843583749, 96.14296686632719, 100.59489116884787, 100.79960125344947, 96.78428505718558, 100.88431320876047, 101.52795885924196, 105.11729638701253, 99.78278860078109, 101.94979113335262, 101.30040677656582, 100.7981603365975, 98.11092706313588, 103.81120439531075, 99.99592649465478, 99.54972840142521, 102.14961489695646, 97.84711040334989, 98.69080905636176, 100.9285751715484, 98.62453699252728, 103.01285415600354, 98.51624277879884, 103.72942185391707, 101.17529057976235, 95.98686715938096, 101.31601098895142, 102.49229107346395, 101.4496615249436, 98.80405885552159, 98.49051805196775, 99.1399871367666, 97.8015925835382, 100.84652325966319, 100.08310020142484, 98.4132768693645, 101.54316396735918, 97.30493791107776, 96.27348748649298, 100.13335813121893, 100.3285548025085, 98.84662985037437, 100.7272311527272, 98.47490870962213, 99.2967072141941, 102.73220474008569, 100.50081336942448, 99.77013647996544, 101.92007881250333, 101.22863755101332, 100.47705319838887, 101.70007801886027, 98.07547145042764, 99.40716146133559, 99.20009011505581, 101.72254567906432, 98.9121627309853, 97.06266852781866, 101.723942091344, 99.58394184180534, 99.3516411315752, 101.58884664569797, 105.56907438054824, 98.36756472424071, 98.18507409242244, 101.39468099483311, 100.89643536907528, 97.21583832914551, 99.4366972547168, 101.56147268571033, 100.99359050057646, 97.80383323203893, 100.46753304561882, 97.85746988561115, 98.93940422866456, 98.79150309498202, 103.72196238766342, 96.99136684807735, 101.05279092687236, 102.89765018866271, 99.26834347235435, 98.55094513307607, 104.52169863583735, 97.63532300996613, 99.75189898076216, 100.23984726502461, 98.84189611017986, 101.63368523942097, 96.85284210396466, 99.46999277861187, 98.12674874974371, 98.4091133525268, 101.62117678084844, 99.27677781645458, 99.93389848055523, 102.5062027779343, 96.55330998287909, 98.68351558318946, 104.1711586949174, 101.03496544300732, 101.62148895462812, 103.00024738394939, 99.55614965720176, 103.80997939430576, 100.87167421615271, 101.70229155966388, 99.91308548809646, 99.49549951820755, 102.79181315903448, 96.17116110917587, 97.79067974752527, 102.74617561525653, 96.66871571457919, 99.1607132887049, 101.83161724885281, 96.0129604044558, 97.51391480090884, 96.29772688396284, 98.43796151550445, 97.11723356238775, 96.15608356592425, 99.72072112381368, 100.96750319612829, 99.505567696941, 99.6656175745221, 99.7183349290162, 100.43341128038664, 103.40035099307175, 102.09688998317591, 101.32034204842762, 99.40172373750859, 98.39276036743551, 99.66487517521014, 101.59480697847606, 102.54589543087482, 101.93713263714861, 95.61246206553875, 100.69716286410907, 99.029911189909, 100.27780808146564, 94.173961800972, 100.99349036602196, 101.43583825200591, 100.94988246844945, 101.25404674309202, 101.1007803130729, 95.10587506534067, 100.85073978945994, 102.12400481116265, 102.60955713919762, 98.63148176716241, 99.22846570364533, 100.61379184814345, 99.70628421920621, 99.10080879523, 100.65035861733317, 98.86669309287747, 97.75766042088495, 102.11468618583919, 98.60685660364614, 99.64878848555192, 97.53216473840615, 98.25047360104763, 105.54288676491058, 103.06478809457082, 100.71820388038027, 101.3352752958592, 99.29257430914025, 100.94241524441804, 100.23680808021493, 96.90249696657793, 102.54083618174684, 98.2575379266819, 101.47707679903044, 98.7041491136464, 101.69008569282404, 101.27086844816654, 98.68325487430484, 101.78641689543791, 98.98825416098006, 100.68480852497868, 99.19211460990238, 100.64985453384712, 102.95819317571875, 104.71870102075711, 99.90446033369464, 99.40382857029161, 101.16048706698407, 103.58267934515808, 97.73543165193128, 103.77932755658756, 96.12319334624699, 101.75256301505203, 99.4433331869735, 99.51306927927915, 98.03976409346427, 102.17778311826139, 103.74564685462627, 100.88172143972355, 100.36263088554712, 97.58709007419745, 97.93215566853766, 101.11746627207349, 96.81493430582243, 96.93476084702779, 96.57692387504544, 102.29198305004198, 102.35121757128967, 99.5945522341328, 101.75077102491686, 100.8783991372796, 104.27648255371912, 103.3267478840224, 99.54426756994106, 97.68029934799867, 103.50830704716047, 99.88903754198299, 101.37723905897502, 99.55543683116076, 98.74017739979784, 103.48809657776664, 99.47290101615138, 101.78034177036876, 100.88917456891747, 97.69012039623199, 97.6344340810314, 103.27833978446438, 101.7158807674536, 100.92447460533202, 99.78490232596889, 102.83420392480559, 96.98579021427527, 100.60814903386371, 95.82667224781564, 99.01403610388188, 102.07455726724085, 97.34168517627394, 101.39903042091802, 99.69456459799996, 101.35609040451165, 101.43134801620165, 98.68912976735274, 95.21497197212017, 94.88363130156515, 96.39217313800576, 102.91228768856787, 96.57508716010578, 98.1949369042508, 101.04704445803841, 98.49112943560789, 97.6046381020529, 102.46079688884342, 99.73944643548506, 98.67100311455246, 99.8468777375295, 100.03333844424816, 101.63047325286024, 102.93234042331521, 100.5009207527822, 101.3431042122024, 100.62038551017115, 102.4085215760305, 102.1160868650908, 99.38171051077725, 102.08341059846808, 97.75684560166783, 99.35427795597039, 99.5452753032954, 95.77086439217383, 97.20703300825522, 98.7438172557698, 98.36634150431308, 102.38512962078077, 100.17412707667064, 98.48837546829563, 101.54963561627676, 97.76789756713804, 100.15355281899447, 100.36645694121574, 102.74409147206804, 100.6313196999039, 98.61278933824977, 97.38891258407467, 100.40734505473472, 99.80484281826254, 101.02517097096992, 102.35962003100316, 99.49032226929641, 98.06666684169309, 101.64087693367004, 98.62577514868852, 100.87658338132968, 99.30592439267039, 98.43856922341368, 103.4636633169931, 99.71181310716688, 100.81781835518514, 99.58770638841585, 100.80038570842196, 100.86762070290507, 103.28332743893915, 100.1607176177553, 100.31484534553036, 101.01432413293583, 99.8811180780776, 103.60818540966935, 102.10043223096135, 100.2779602631504, 100.35047003957315, 99.22115207477287, 100.08390595479887, 100.87122191893741, 99.16484591229346, 100.28285738924258, 102.00696455205868, 100.68511317487807, 97.38285515611902, 97.67305629443642, 101.61251112673274, 97.17573478863653, 99.47868644657257, 97.38589854017475, 102.73059516777913, 99.4593507146707, 104.47452751400799, 99.82033180952534, 102.3040890894644, 99.36933579076445, 99.08985027562214, 101.23989227292012, 106.24502704866094, 100.72527936594945, 100.13385293552886, 101.4959486237657, 102.11770573436651, 99.96010773701137, 101.77041621599915, 101.13548099329466, 98.92398503737643, 100.35911861106213, 101.69194268493204, 102.63158081233063, 99.09438796024295, 99.33111904717236, 101.41903699964948, 99.78998664885303, 102.35203933812204, 101.16490942359496, 100.49766257928351, 99.93923283419822, 96.90225921991666, 100.87582653862667, 100.88171775951172, 99.36192062599764, 100.74845986708647, 100.91889405546378, 99.03758521615718, 98.36789343326531, 98.66670201509233, 103.34758971151857, 106.55770337242518, 98.27284560806446, 99.347990419899, 99.78139630131685, 99.94254867780775, 101.62249855588288, 98.64949067173895, 98.08339234007401, 97.25167901011757, 94.5798212594745, 98.72240648471643, 100.0050822184239, 104.1812302669573, 99.6947434633773, 98.67857796184133, 97.95774204927216, 98.3541574715511, 99.33632515851536, 102.85274195603499, 97.21871324389701, 101.30894287913416, 100.81563311958479, 101.98549412865911, 97.97501909626597, 100.90917611867204, 99.00210493890044, 98.70774312106819, 99.19279908743121, 100.99045475577248, 102.04906538675885, 99.1763686465721, 100.86276524853365, 101.47716742648687, 98.28592773895535, 100.91217143933379, 98.14694801004852, 99.77624104409315, 97.893532825537, 97.43891975267452, 101.9263509033096, 99.35976290884923, 104.48173631370707, 101.91901117994045, 104.4595411234753, 100.98854270139636, 97.1746067199248, 99.78043447160283, 100.51523579242537, 101.2264566096604, 98.74928116606486, 101.52153831515398, 96.96280729869083, 98.22098196246709, 96.77498923687752, 98.83833585358136, 100.77561794988961, 104.13793997029916, 102.79542639776308, 98.98656584473403, 98.21796583800881, 100.91374125686251, 97.38070129406147, 97.48643945184662, 101.36607514545595, 99.15451271656823, 100.49957733276968, 100.66716314538684, 102.12273296373348, 99.37979737373347, 102.60361862611946, 99.17960170517313, 100.55573747272209, 100.8585646167549, 96.64495611092951, 99.32575321221765, 99.54544781340738, 98.83552147514112, 97.8970108117513, 101.64053366968191, 101.13937787010374, 100.11681555365764, 99.38937447237033, 101.28456566898025, 99.04539153726344, 101.83592968278927, 101.5313887994313, 98.9324490693168, 97.74944919059396, 97.78175555251148, 99.36822352977467, 100.33888405632806, 99.3738813071264, 100.86860219252678, 100.98937760019795, 99.26336324882813, 99.49533334999863, 98.61036351981988, 103.55722613021084, 100.4162739709045, 105.5069583997027, 98.93390669472325, 99.26254586811466, 100.31061347393239, 102.57257699178996, 99.26090046380818, 100.98871634710281, 100.81822650259971, 99.85194274457025, 103.60539019316558, 100.06484016983435, 99.28110510530183, 97.82837288045641, 103.37478276801026, 102.40013347268514, 100.11282381576821, 98.39614246571278, 102.67748606003913, 99.28146954847341, 101.49130339759203, 101.62596325250713, 100.81261657152808, 98.77990610617516, 96.30138212833116, 104.0112237453227, 99.88265112546786, 97.62169612833395, 100.9213783339792, 101.90307860628455, 99.9182077851164, 101.55917717627453, 101.03462186416988, 101.71351001362152, 103.08309855421226, 102.26418046478173, 102.29516309990201, 98.89865320344028, 98.93088840748827, 100.97689264562227, 100.67826491130853, 99.13413358080992, 99.75091536439571, 101.65043065983896, 100.87718247265718, 101.27492961000188, 98.27675812834838, 99.38738396323687, 99.77387739865502, 99.0903465384263, 100.28494909613575, 103.70326881739322, 100.94601602292532, 99.7129099380836, 98.32436911157251, 101.4180143287251, 98.0492490228789, 100.67328036468105, 97.49622566908269, 102.02767937073554, 99.83429771642737, 101.9543617748643, 99.43475739466726, 100.31904518706824, 100.77971641629671, 99.46078720120413, 98.27016704394465, 99.9234835169607, 100.30410855999112, 100.05029929041832, 103.26717001368236, 98.32623942494408, 93.62358933294006, 99.04126220755256, 98.75970938834075, 100.23379802446668, 100.45047554080844, 101.75819611517646, 102.88783682728902, 100.88963349435524, 99.92221279379625, 101.83033483834137, 101.2559326750179, 95.02740943516469, 97.898264393683, 98.67906379646166, 100.3509145743557, 100.81948064477966, 101.80668501465112, 99.85989623465892, 99.63132266233644, 99.28665265127385, 98.58029538344553, 99.17994183742063, 93.75904575239618, 98.76789213830028, 98.14306520961989, 102.38067036515652, 100.42566956031217, 99.12183653000109, 96.68069216325586, 99.85224507092212, 101.18188315832421, 99.45022962825392, 101.19784588842327, 101.62937515016753, 100.4049314891664, 103.22282107576792, 98.04180628156497, 98.0928767158373, 103.34548239988806, 98.43043027197606, 97.07757107607893, 99.1243640324516, 100.47832975925232, 99.83857115735982, 98.40578762898326, 97.35777656339476, 99.82208493144468, 99.63309800114808, 100.52973691932871, 96.71775495427305, 100.67404434019907, 103.15502239924292, 104.7916618665655, 98.39881742018808, 98.45918184555572, 101.90771292350625, 100.7707777026058, 101.4076371045119, 97.77045498290032, 102.64881012611676, 97.76031380750241, 101.71615333215797, 97.7156710162573, 103.03349595101525, 97.2926868618868, 98.59062315027161, 98.877704675408, 100.41649888219139, 100.13155090048349, 102.31595679995252, 98.17498698124868, 95.01601211173302, 97.51049834204254, 100.01676844327905, 101.10727181301822, 100.14836551559526, 97.77592282087936, 99.94885490625572, 96.89588772275155, 99.70285691761075, 99.58830887250369, 99.49870945181159, 98.04741192935208, 98.4614102176901, 99.26789346026494, 101.5580854039631, 97.45651703313172, 102.33904980053693, 101.22168316783294, 99.35492954180818, 97.17505240264828, 104.25328027662601, 104.44256167458394, 96.72059079645769, 99.75754314133385, 98.59959794832868, 101.62871630006268, 98.09591979720423, 95.88818898602703, 98.25039715293131, 98.5755528602176, 99.57637060554296, 103.45667366629691, 99.11051786180218, 97.02226670159, 99.92301813389513, 99.77942042910868, 103.68433790432925, 99.90679202570266, 97.76415791987922, 99.90831800628598, 95.57929322350526, 99.60621459719027, 100.03005128357036, 98.29587594572389, 98.72292490141422, 101.4688796614303, 100.37960247595015, 100.80422786971772, 99.16930820267523, 98.61321638524902, 99.23875360163228, 100.94723164282942, 97.71412611628936, 98.28869446245601, 100.9131820930372, 102.30921956871968, 98.39499089766095, 98.82091433186633, 97.63708305898354, 102.07823385326711, 99.26039472437175, 97.26053323198799, 97.04725591372595, 100.40205156754601, 98.86477933847449, 98.65000119332848, 102.02884674249006, 102.81776482946498, 100.75544268467496, 101.37888894677748, 96.01404062705686, 100.10577004876725, 99.10167416571409, 99.6774047515595, 95.2980516008471, 100.41723692241435, 97.74225988094896, 103.64724743301255, 103.50865823704702, 96.9172929805946, 98.41813791808312, 101.17533227708496, 106.09416040212925, 99.13051427005648, 96.81198419760112, 99.00830989958351, 99.46314710501565, 98.68271181921239, 100.1440025874165, 102.97997657871089, 99.12479608800425, 102.88196589921971, 99.14103832525625, 98.7632585204249, 102.60664159173912, 99.97194613194513, 102.24922483884366, 100.61564841485225, 96.7755798694279, 102.625665936032, 100.79104112325916, 102.66959011988621, 98.52443917391811, 98.55871675603794, 102.82066502980274, 98.44412382367933, 96.63085895880951, 99.6839087191096, 100.71995988427484, 100.37623256270693, 101.25664304939815, 100.20172583280429, 101.13576747038711, 99.43801110025132, 100.91093143857995, 96.13459933658928, 99.14247119517346, 99.96140240179555, 101.06911899864218, 101.65502163740598, 98.31925543251852, 99.59074809853715, 98.17064324711095, 102.30688771331724, 101.38180411111806, 100.6633245407797, 99.43798533190244, 102.42747825082942, 95.47622669311582, 100.05266853002402, 98.71119720301516, 97.22961810789967, 101.55434720574833, 99.96552774737069, 99.69552680260489, 101.4457926203741, 100.53857261911766, 99.92389194317278, 103.01039853384009, 101.00421022437018, 103.48986695715325, 100.03042181028154, 99.46427802480613, 99.60528050340311, 98.88232872146052, 99.3544166402612, 98.25017783284716, 101.22881943093486, 100.94435141584121, 97.99150609880763, 98.39629441452117, 98.48254257559621, 98.51285209636008, 99.28448952373479, 97.76473074997762, 100.39535868171448, 99.92000452027355, 99.07121565390005, 101.63717413983336, 96.26065237737464, 102.44315909250055, 99.38402098666157, 100.76996373732672, 100.53955161947239, 100.62631570319476, 98.52104581926025, 100.35931973405867, 99.75010232245866, 100.28446226730011, 97.33693496262333, 98.5062891608646, 101.42939618652935, 100.77489320797991, 97.631227142456, 100.73857004321258, 99.91888936986497, 101.03429017013336, 101.81045394501724, 101.03143881491486, 97.85550833109582, 98.16765616590695, 99.48780924497802, 98.95770649495104, 94.70770007128019, 97.25100472909536, 100.99492644347802, 102.24374249341842, 103.87602458214405, 103.91724635534719, 101.01985269866296, 102.96856349271745, 98.63183408477016, 98.18549188191174, 98.92740505017291, 100.89179483531132, 97.94771938856475, 99.88936357072124, 98.02952264394911, 101.5653187583849, 98.01969998472917, 97.61329650129136, 102.40977464116575, 104.76071773012167, 98.52312491398152, 99.94567952115986, 98.48537766344938, 97.53459727861524, 98.1962681293708, 101.19401571073887, 102.84566104276622, 100.82161518254439, 103.83586872903409, 102.16742832662715, 101.87929733108254, 98.2088838733555, 97.91501257267805, 103.21497993593348, 103.07466790476981, 99.55803329585153, 99.46906985515224, 101.70471714175642, 97.48700800144323, 99.53535548609038, 102.20967756989165, 103.15450413486283, 102.02150032472504, 100.7065287269127, 101.34056671079004, 100.0495790497201, 102.25865145950883, 100.47098948898915, 102.78116983592648, 102.49083008274206, 101.62607766198123, 100.98649245325495, 101.58342363980758, 106.32774536965324, 101.96469149950062, 99.46826394172547, 97.95590203974027, 101.70810049278599, 100.08795799156391, 103.64780598705636, 100.72443645573189, 98.50184301073419, 98.63727783208606, 100.09200036089116, 104.2421324141655, 99.73635114289027, 100.19184101786858, 102.27727183814822, 96.54000733351884, 100.37673072856398, 95.49155323435575, 99.68242572489858, 100.03769209684891, 102.47377829428662, 102.94722514107482, 102.02432926220952, 96.6430482571296, 96.80621617701182, 99.87773239753466, 100.0100852613154, 105.72057776718337, 101.59906303309113, 97.3597676623383, 97.98057574573741, 97.89238219978132, 99.95880769929038, 97.61275859035455, 102.39086979779798, 101.50387463124618, 103.74954812121433, 101.21889102016567, 98.89404302312282, 98.95538478002682, 96.27860635943603, 104.0790044211415, 96.99007544790693, 101.71782585470766, 99.13854685228705, 100.14542366344857, 100.65409485329279, 103.56158010244285, 98.26398480996168, 101.4500193986171, 93.63377169219267, 96.86222741191332, 101.97705770570327, 97.53330035454753, 98.46928681303606, 100.27931865670142, 102.73720486894896, 96.72935291049387, 97.34169465613353, 98.54229825144327, 98.06343628524019, 98.07293091448469, 102.96540222138368, 99.14742066468561, 102.19690168526294, 101.28752509169945, 99.65470634826258, 102.47383033882984, 102.91058312856082, 99.93021324657109, 102.85306611213167, 98.2540801576289, 97.72312850456207, 101.51696003279982, 101.20610652722807, 102.88529164401575, 103.17500262481379, 96.9891192395991, 99.71072719290865, 99.7110004064626, 101.87323056701152, 99.77434153574104, 99.13291791474181, 99.6086767768662, 101.06977936759814, 97.82393070908353, 101.47724014795251, 100.83061135499392, 100.5205915266927, 97.78588005089883, 98.93902583741536, 99.28110442563933, 98.18825266649893, 100.52744080082157, 98.1535793620085, 103.57176868672094, 99.02887311972175, 100.2128738168785, 102.2566301068492, 102.41333998877303, 99.0410423052204, 105.34365738005079, 105.57137081938636, 100.47333246007602, 98.23176887588689, 99.29846460708637, 102.58928605981232, 103.04822754789994, 100.87836673237045, 95.13672106076618, 100.46950682959506, 99.15953357473168, 99.26006268983078, 98.80745540516448, 99.23974752885275, 101.4211908911432, 98.35699321387358, 97.67817156091888, 99.06003833914254, 98.0682197340053, 101.59450650854446, 101.61679068394028, 99.04060507801879, 98.67991184158336, 103.68554176298888, 99.2828106844531, 97.97146650442455, 101.73611298014386, 99.6952166728384, 100.91809125238481, 103.23136502483011, 99.55757098604833, 100.23135010215795, 101.86467144931186, 103.9175692244389, 99.22584623213167, 101.79576829979048, 102.57397313404253, 97.44349599566824, 100.21719517087908, 99.69545628984405, 96.30246704935443, 103.95179021780909, 103.01991787873197, 100.14853782149376, 99.52986684722848, 100.73625374764349, 101.10597902573235, 103.33459926569985, 98.09322653190652, 100.32225684377046, 99.68522745970458, 101.5362375349285, 98.10405412540206, 100.30714721175792, 102.9162226516634, 101.62168518677501, 97.61470292622283]}, {\"name\": \"More Variant\", \"type\": \"histogram\", \"uid\": \"66e02907-240e-4641-b0f0-97f86b8dc16c\", \"x\": [97.66366664139018, 87.38447186601921, 102.7494148767289, 102.07369067427656, 90.26630379919476, 105.30096874331593, 103.52963782818391, 96.0572052206448, 99.50395791058112, 90.39337051910128, 100.49675353640528, 104.35361553969268, 107.84107384298183, 99.6164861791607, 99.22891595296873, 93.24034384546177, 105.40629609576034, 108.88086302813024, 86.59357635781737, 105.61708355113194, 113.13439436090447, 115.20267005580563, 98.99881813653802, 93.42632433300994, 88.88472481164713, 88.70468058736773, 100.4660817646027, 104.85097173822516, 94.44793074898934, 93.77981209815187, 89.30800685622974, 99.23088852783522, 98.18224866149592, 109.57203940528191, 109.92068021773825, 94.2367559220184, 98.19260158718893, 98.0346549836032, 112.4375473209152, 88.51027346215206, 86.06642408185807, 112.2921007578181, 97.31430138322253, 95.51224526742415, 96.0974706441647, 113.81204916758448, 100.21022937938822, 91.62546826971396, 107.25140677581359, 93.61965704486273, 95.47169534372043, 109.74273666093013, 107.61134177818965, 101.63202660732884, 95.12824083279453, 92.59983177957416, 103.97033609112043, 100.97336253207311, 87.98650690662325, 108.63036730785534, 86.54251821927222, 100.91327759104887, 99.99123020977129, 115.9327565062966, 99.00184791768373, 98.36501929615281, 91.49553520184509, 93.8170466792964, 95.0823329318259, 104.92170141743438, 97.48351646876672, 120.52190057047859, 93.26244503074906, 109.35024494171871, 108.23710196618958, 92.46134369523858, 98.92755988396394, 98.31458139526293, 93.83529938520816, 88.94959946695936, 110.39942886800947, 98.36211331370339, 84.62879052327128, 73.56401538987971, 92.56960582696105, 108.60273504475535, 96.23521547468177, 116.24574981952262, 105.59898973956076, 101.67164792467152, 94.25685248824641, 104.30831798345322, 94.22285985131103, 101.70000904733016, 97.07635550218075, 98.19135314242916, 89.18269999164096, 85.25015788738095, 110.51098281503171, 92.79777916117014, 94.71270164547893, 88.47805040392387, 88.04182206527001, 100.60290059061442, 78.20055450240454, 94.56915580806691, 106.22718346332671, 97.01028446238271, 91.77819939440484, 103.72984470329736, 93.10441027846747, 87.82781539177961, 99.52468700669952, 111.1327213519731, 123.96372581887164, 108.49497948824073, 80.61932152856707, 99.24687935812422, 85.6791483128564, 91.01679156881076, 100.48399474767457, 115.86731316059488, 98.61482930250614, 84.38439438359256, 111.77682998335085, 106.18939007345817, 99.57067701890067, 100.95149468667863, 94.0101316449476, 114.51414014592046, 102.46101193772125, 114.52465169487652, 98.86333920712198, 105.64989390354697, 94.79511538823773, 95.68724036809097, 95.30148895258861, 106.86583323154042, 88.65418810267083, 88.01023196765304, 112.61283431211405, 102.39160424695265, 100.92276695281795, 108.53726692722616, 93.01653897639788, 95.45678417866978, 106.97523246007967, 93.73265457166515, 106.91257665199619, 109.77824429786547, 104.27828451836854, 105.6416712591479, 105.45967096554187, 105.81411190064104, 105.88377997453955, 107.14390467751312, 96.72152078393755, 105.83154538152596, 113.23282846739829, 107.92806515702257, 105.57912506893729, 104.0834858883012, 82.96280311907933, 93.386051793556, 110.14726599602417, 102.94052520599877, 89.97711590246195, 109.01417645383785, 101.44076579391611, 78.79027298506338, 97.02587418505722, 98.85787869195079, 104.15998917502718, 92.49927702770701, 87.49185977735964, 99.99318258067882, 109.62371411330747, 104.56134858027805, 116.2327871183686, 110.88225739267693, 97.72677245826584, 101.49651409027213, 109.35122254458409, 94.16843044648785, 98.93818163605205, 102.29981197620769, 98.69543988771598, 101.01003060205623, 110.37412120088851, 116.90873505899602, 92.54467982122081, 106.29281248261509, 95.94189094402878, 85.43497467316189, 94.34708563356519, 104.91847783226191, 91.905277522641, 84.49383557897855, 107.6961107790224, 77.44821479201, 108.8430531351773, 100.29871302140887, 101.88401422892917, 93.83223261139084, 106.5711652734692, 103.30308074173615, 107.79355854134326, 91.27266599722594, 105.97612001294722, 106.25365604660225, 104.11704400221822, 112.22493389156679, 81.96486950434169, 102.33162620941049, 82.40798551049474, 113.69239386599227, 118.43169075081367, 94.11852315062957, 120.26738529871655, 90.62236715760078, 118.50519465584824, 104.91181961942404, 99.55109995233892, 100.76184729894347, 84.70141340962296, 93.27459210893882, 105.85298682351467, 103.69523905070025, 107.80342838662136, 83.03733932983934, 106.46735014692548, 110.7117129189612, 89.07931547281461, 109.37525623862206, 95.74979807890773, 108.26050738264094, 95.87840013285089, 89.33986098320658, 102.35798352761877, 119.55089597424089, 97.76431769723587, 91.99567039290751, 108.37041258348884, 99.62798452028298, 104.10954360174044, 91.18053505091005, 91.46428773567861, 78.54854562258873, 99.55223811989646, 107.026788866833, 96.40337182255487, 91.17234922891323, 105.48772997555587, 97.90859581794652, 101.34225322351215, 116.38600304880607, 98.524500293988, 112.93806543620008, 119.74255188664483, 93.63653078773635, 94.9401920345937, 103.6718570875326, 105.82662828404276, 112.1992817856409, 105.33465239018743, 107.57235857057177, 100.16565346533513, 94.43288644043892, 122.72274480085903, 94.54712547107333, 103.5224844829207, 98.23491516597753, 110.8739865214539, 107.70859490123698, 98.98784283102152, 80.92316035560954, 109.40897889619734, 111.95030022166321, 102.51764815670015, 107.18017336641987, 105.09423252830162, 81.09080392149569, 109.4450582093059, 94.505344058794, 99.89430484389983, 98.51350932780086, 116.35104779864386, 110.1450928838124, 107.73154358785962, 82.27009616282032, 90.97449564385032, 100.74853400272833, 92.18079246796925, 85.8468687995672, 107.29694449041328, 98.21360741007359, 90.8227787927233, 75.16505264359017, 101.48547505489931, 108.55988815719338, 108.4831549459743, 107.04930706484897, 111.84912999723414, 91.03345059624357, 79.42724709523334, 85.72432358828979, 89.94272910277661, 87.91971878106486, 115.16927286961928, 95.61303932668523, 97.71272257581289, 100.87941447042604, 121.09434269705935, 117.61078092719514, 116.28528726431617, 96.18421132229766, 126.66550613312413, 92.04216487509744, 91.77712692376673, 93.26295257119703, 92.592368857981, 89.079050222848, 98.22392791517262, 109.47022690604673, 94.64736595586828, 99.33735279143288, 111.05531308617812, 98.51914852066001, 92.71601475067214, 79.3335815333473, 99.95292774627065, 87.9201598512133, 94.51444676907309, 96.07217340949528, 106.24713351176817, 102.77683416977395, 99.55355165862079, 114.30439427524144, 99.11956288124372, 96.82610293016603, 107.69308759241437, 98.5354982727269, 89.69382323480843, 101.39938019899388, 93.11071834666572, 92.87848508503501, 73.43579424293752, 89.13799496127591, 111.66695023780193, 96.30069197088986, 79.37276888221984, 104.83110754721785, 102.20826654774216, 98.23368255407108, 96.55578807483008, 106.5358016684599, 99.94424825725031, 90.9179429962292, 79.99307002043444, 119.23319862528457, 104.9305195437571, 86.82816379648993, 105.02346722067642, 104.15174949125621, 99.42077234887734, 117.00334297930945, 90.07245943820348, 95.81670696377991, 103.37458195215537, 98.06610271816342, 96.69568385505997, 104.21931447349097, 106.01568334737824, 103.73044468952871, 91.13140875801828, 109.07964902812826, 93.26462162891816, 91.54612962802011, 95.34010975247264, 97.19727697074593, 86.36530666764071, 106.92847872737025, 116.78727286589321, 109.24032133625981, 93.38455841427299, 100.18689632076149, 83.85198904988916, 104.22866491675147, 121.68730570594518, 112.59032948109011, 88.9483408273332, 110.57931107919765, 102.46763816935926, 98.67925607070421, 99.9667244192891, 110.2828322846509, 93.71130761081315, 98.57166827111686, 96.43588667781954, 85.05663951720558, 101.6095537189243, 119.87438489210126, 117.77661577770806, 103.43714978956835, 106.56648867643632, 116.39966225987641, 105.99029386993887, 97.98483401087313, 103.53666481423939, 96.4945878679836, 102.04649307312448, 102.40761854227124, 105.48304692735935, 113.03125436613523, 97.78896980597959, 91.73234483355998, 110.5222280680426, 110.10641459356549, 78.03094323949867, 117.42618582418584, 101.53468104562731, 99.19131889257007, 112.59502201969416, 76.38539706854351, 113.84012879269662, 100.91484018770797, 95.65120890647142, 101.18224427367159, 83.54653486096646, 109.12962924098001, 91.43673842518047, 98.61407291115755, 96.21785185127024, 106.21446685581371, 101.91112098374512, 100.72517330919221, 101.37616841588233, 84.83579846501094, 100.93728001642116, 109.00118059984267, 96.39101630920612, 92.10234209727001, 79.47436821863081, 87.18407422469718, 79.91607170028436, 116.23611077538705, 91.73870915062214, 108.98851931662118, 86.803956978098, 83.0025679798234, 109.64576433874484, 78.62490220817249, 105.17271391041466, 88.06267479309584, 96.77553392533436, 115.74668017059405, 99.62478410547826, 94.86982331020565, 102.95051510761544, 101.05514671684894, 80.50450365016444, 103.46183620437104, 118.27072358864315, 91.82538789339861, 81.15749479440925, 111.74329061654461, 105.4507633511133, 103.6359766299786, 91.08114560527125, 122.11709546589026, 98.82059690947777, 107.91749230421088, 88.94733242624523, 102.04283680971044, 109.96803984605789, 104.22990416368545, 113.27356447273863, 84.80847587802576, 96.25272572351484, 118.83277293629399, 109.80095536332732, 116.39399943215314, 108.0287085285416, 99.7623891497633, 116.2725450699937, 90.53609138024761, 100.07795574351881, 113.46313899837152, 98.5827177080189, 105.34889428357191, 75.05132137570106, 103.22670325822543, 97.4427220782304, 91.02356525459312, 79.09932814411935, 113.6543033442452, 91.62254070133602, 104.41087285007086, 92.46159096753762, 103.21779434856816, 103.1448158547804, 107.52955473553797, 89.9581495150779, 97.934422736213, 100.70186432750917, 103.32587387761286, 92.10658896176797, 90.43258627184544, 98.69151949517446, 90.76158455957356, 85.4395699311753, 101.15897727548827, 99.77869338153036, 106.02297339885797, 109.92652900535953, 109.88293638608849, 102.2402212377785, 85.58702948423095, 88.91658682170787, 86.89153287849778, 94.72119900132905, 110.83670033078192, 93.74574348199768, 119.99637095505612, 96.94853726263219, 112.70857277038589, 127.66896007043103, 92.97262066492496, 104.77471639131691, 93.96446941854447, 85.78431220177593, 100.88591521955533, 109.45710266020762, 105.12673821597313, 87.59915564038253, 106.05796893939544, 88.31434701731615, 95.21237817197658, 100.88624385029642, 98.34803941785502, 103.41060671000133, 109.07870806519213, 88.81164101348544, 105.79881206487767, 112.44986940156657, 111.36188368977207, 119.73103949977207, 106.59539064602521, 86.92706572296031, 108.22631868035397, 120.11641194127937, 79.10396636980173, 104.32941098262441, 91.25939430344496, 98.88957320336371, 113.09454263785935, 106.42533359537902, 103.60208944707001, 111.6305765514574, 87.91189073055727, 100.30170229964901, 108.56997794072046, 99.36078956478958, 107.53258027953798, 76.98369170279688, 99.26844567189042, 101.90146235944714, 104.39668509014403, 106.03456579524408, 97.84368469780257, 101.33372006945551, 117.68148336220857, 104.00081736451136, 96.53318243074668, 90.22328093401956, 86.3911165234324, 96.4858492984969, 99.76446054688013, 101.84613961154668, 106.27254221317796, 84.44902556369442, 92.87938324840766, 115.78656773092058, 105.03367335506175, 84.77312356755054, 120.11193858287344, 97.32250120814673, 100.36530138271146, 82.76631785271768, 89.30420469750037, 106.07204719305086, 124.012243168921, 109.253495113041, 108.81952737887521, 112.50482753640416, 105.75779663248714, 98.18423650293683, 107.06311199335624, 89.28780651899906, 105.36111725862233, 107.28866012310343, 91.0854772645748, 107.4836855129076, 92.52195730106308, 94.47384210440022, 106.93550025790508, 98.42654361822265, 97.55409193281075, 97.08271184653545, 110.53698940414546, 96.90248452646883, 107.5753783476877, 94.3316217889359, 104.86489595256427, 102.41538248067965, 104.2007845440283, 82.1098685447972, 83.31030258578537, 113.90328315679643, 79.06165260051922, 106.23942886473338, 86.76698268405009, 90.37508852208666, 107.68883853820859, 106.50811174209275, 106.08076315559317, 90.84920958263949, 97.58349422706588, 89.27587576152743, 99.90305958313266, 104.95091518993922, 90.42026846777463, 103.7228669159878, 117.21888022003712, 90.03047367631122, 88.26234435533173, 110.24810052641584, 97.89584563888035, 94.80538501757916, 100.48905169042511, 111.37871849418815, 86.02953344863465, 102.17293366698911, 119.7410595266884, 88.0099434495801, 88.89102920370152, 112.63668727081541, 99.68820186951702, 95.21777152412955, 86.27187485145072, 75.6148000903926, 101.79321052051617, 102.28264475031916, 99.8478434889969, 92.26369746375396, 108.93989073498473, 108.92369335316796, 97.54884837092513, 92.95445466908181, 94.38381403754454, 98.46803901424956, 90.0203687298058, 105.07746257604205, 105.10334911309246, 108.40285788681652, 109.4380175444194, 79.39537156058563, 105.60666270528124, 92.67353778634369, 104.08224014679242, 108.11532817562639, 103.10335683131315, 99.22185220307924, 91.01236949076083, 101.94520383279976, 93.23111376274818, 102.96870783688192, 103.58040145947187, 95.63580930331696, 100.26959899769534, 102.94914743580156, 91.57090587436204, 88.89182040008403, 114.07914334989474, 81.99408810557829, 94.55886865049433, 104.53857341213264, 100.17098988094077, 102.72132525903527, 92.70591494297744, 97.01794234175296, 85.08578709224793, 86.71023274867069, 89.71921976706506, 73.83245160862369, 90.37299526617039, 106.26954460669043, 85.72663675907006, 116.06301941824017, 91.30219658237664, 83.61391595371484, 83.67154029624356, 109.66365012404005, 113.81356300941782, 99.37543626708327, 114.45311192483899, 110.6136094936129, 90.08121588013361, 114.30931374006556, 95.11222599280299, 103.32972554355521, 95.83083741372411, 97.76100168758062, 86.78689425314876, 92.81915772689256, 107.37954288076713, 103.67258781824663, 102.7470564671153, 102.61537316476449, 103.388935787325, 114.9445987146363, 103.90914308113211, 103.8624291713314, 103.47699315147757, 102.32528335190139, 98.61576460682791, 98.55193022524492, 99.92991322946126, 93.31070820513878, 95.60418024967221, 112.67578992012483, 93.27367486492982, 88.21760913405657, 89.77035787566756, 104.56997483660871, 94.68410193717483, 97.63143589790808, 107.66217218386761, 105.93947216944777, 89.93392105777991, 93.25916601924918, 97.60220987350705, 102.84403782735824, 106.04224071106768, 89.74936711570683, 102.33856697973883, 103.1320528212539, 103.37266648014248, 110.98423284935738, 99.18990577602237, 88.65645495136503, 92.6313584322127, 102.96916075348085, 92.03088199037286, 103.23333636507374, 106.2790942736996, 105.53907731571391, 118.0428844915803, 103.46311104925515, 103.00027470310307, 108.93718550238421, 93.78913463774725, 99.22290235356733, 106.9499280127654, 81.2664848312432, 90.97999879652576, 111.33364378778045, 104.46497684173842, 92.34494008289494, 115.92007475157438, 116.26306631145613, 104.83514969626447, 76.35117693976892, 99.3981944952032, 116.88464176438654, 88.78308136363417, 91.43340787423662, 93.64344051051522, 110.8183353504655, 98.47114749158791, 96.70080839615065, 88.17351455995319, 92.54224040574533, 106.77665583628307, 111.0271122601003, 101.337534555505, 107.36650216563214, 92.48019686080794, 115.05161097448283, 102.9305875065995, 101.52399233467338, 92.53781479628448, 88.35277702705338, 95.08358111771567, 115.67286163971991, 112.66383081302864, 103.74567657108447, 90.11581295723795, 94.78002058322912, 92.9948653451089, 102.26948655205908, 95.76828866677499, 99.35897825481297, 99.86379051507895, 92.59607441211875, 91.83319833531857, 115.35003511310802, 127.93495260155521, 93.64836260304283, 102.34304057618297, 88.14805849449588, 90.51119209399369, 105.54085972167378, 111.44576820061357, 115.44747063709247, 100.26028441943836, 105.68817627530363, 101.43640143721251, 92.72327704714523, 92.50236985598508, 85.35858487570036, 86.30206139723533, 91.47144420118823, 96.3426048106019, 107.20056238196243, 96.01846158875206, 104.24789699154451, 84.84628291723308, 105.2746821872497, 109.28550848256954, 102.86919377979979, 104.41803595880555, 99.0398583903627, 97.42968311350575, 102.1363311754459, 96.85834660902616, 93.70583918835683, 94.69192597432192, 109.29838480700937, 113.83961457449034, 102.0989455546019, 88.08959477950145, 104.05046929436098, 102.0224779470728, 99.08621973480551, 95.3434843795368, 105.8987097311405, 101.18084526927491, 97.11303975583263, 92.94483285531646, 125.22162864866216, 87.58871245092807, 92.68347191973656, 108.62413966261656, 75.42524411791516, 78.4886615833644, 112.51550371529616, 112.81915878477594, 104.04995513785741, 104.79183843249061, 108.3109653620544, 101.25150820099053, 96.94358787179698, 91.11592117273766, 97.15098272441135, 106.51548921711165, 93.33251667815466, 92.45109204354738, 95.28763985738266, 121.88649392862072, 93.78070681145063, 92.72105837007209, 96.66516628744984, 96.57962597871312, 117.45089394090024, 100.57090602754162, 109.33505971766577, 82.47476414815338, 113.36786874084463, 87.40900777333417, 107.2784734781922, 94.84622731709715, 98.41464993118139, 123.29888334317118, 110.11269254817549, 88.79754165396855, 88.73053042767222, 108.89489433294314, 97.83725949510155, 83.94878926362017, 111.91314013953703, 93.49292570080455, 85.14408374424356, 96.26907920422842, 100.77763705284886, 109.27792955359831, 93.03045688174782, 89.7074219655041, 108.80364359625077, 97.4688902742841, 112.40378214497986, 92.61091069461774, 111.89537045820458, 95.80505050578388, 112.862595880289, 92.54757859319986, 105.15182936369264, 88.7496972266005, 100.7446964806648, 125.04636564078238, 97.57860572724195, 89.43840865776552, 83.15394122748297, 105.84921321315134, 87.35049954063803, 91.81956933462945, 92.384730651318, 94.36155060618911, 93.1271496084918, 108.35711221825592, 85.24667881472736, 102.55617179278252, 107.98945974099395, 108.29782333114375, 117.08943647146528, 93.6400861432958, 119.9941923575261, 94.33018557516705, 101.11759275948711, 100.81479336467507, 92.15382824080447, 88.64365174337296, 96.02974784935049, 107.44990433993542, 79.13973314772704, 97.5177849085802, 106.07489189050943, 103.585564276925, 84.78983037543615, 114.03115522805824, 97.2153870345765, 105.40283246556179, 88.84727596566609, 90.62832191631874, 117.60844304473359, 102.53647426133146, 109.59857950054732, 90.500905519869, 105.95672401295019, 108.11528958975384, 95.32278579244587, 106.70194004862496, 118.73228026814279, 107.2941477616913, 92.57381739613814, 114.53338618833907, 96.70066821098646, 91.6925178727374, 98.94893279459065, 105.55026100419728, 98.9141419404966, 114.26339370517329, 87.94161376280394, 99.58410252254632, 121.97016743382869, 94.87072088436221, 90.26454886589549, 86.27670361670536, 102.14828357509586, 91.71509713232703, 102.41664268081388, 87.41984477451291, 87.24130711214602, 115.35663778554903, 103.33090037621812, 107.79926662517765, 90.45683519408674, 113.31746022502877, 102.10954458616196, 102.73714022467087, 82.96061389118017, 113.84120429639943, 96.15064402788836, 109.01779298020722, 87.24913162588668, 100.10479476428556, 93.6867162224481, 100.47248901504219, 104.8692355076799, 99.00134165192331, 90.83557594648848, 94.1727811995913, 97.81976193624459, 95.32596418068476, 82.5813392580807, 104.76999817831827, 119.29197516523584, 103.49476118644564, 115.97162551556929, 106.10209767466131]}], {\"title\": {\"text\": \"Mean of 100\"}, \"xaxis\": {\"title\": {\"text\": \"Value\"}}, \"yaxis\": {\"title\": {\"text\": \"Volume\"}}}, {\"showLink\": false, \"linkText\": \"Export to plot.ly\", \"plotlyServerURL\": \"https://plot.ly\", \"responsive\": true} ).then(function(){ var gd = document.getElementById('a88eee82-3b22-4b01-91c5-078e071902a1'); var x = new MutationObserver(function (mutations, observer) {{ var display = window.getComputedStyle(gd).display; if (!display || display === 'none') {{ console.log([gd, 'removed!']); Plotly.purge(gd); observer.disconnect(); }} }}); // Listen for the removal of the full notebook cells var notebookContainer = gd.closest('#notebook-container'); if (notebookContainer) {{ x.observe(notebookContainer, {childList: true}); }} // Listen for the clearing of the current output cell var outputEl = gd.closest('.output'); if (outputEl) {{ x.observe(outputEl, {childList: true}); }} }) }; }); In [56]: ex_1 . mean () Out[56]: 100.06843195281844 In [57]: ex_2 . mean () Out[57]: 99.93551822004906 We can now see how the spread of these distributions are quite different. How can we measure spread? Range The simplest measure of spread is known as the range . This is the largest value in the sample subtracted from the smallest value in the sample. This can give us an idea of where the possible values of the sample lay. That is: $$ \\bar{S}_{range} = x_{max} - x_{min} $$ For instance, in our alien example, we have: In [58]: max_alien_neurons , min_alien_neurons = alien_neurons . agg ([ 'max' , 'min' ]) rng = max_alien_neurons - min_alien_neurons print ( '''Maximum: {} Minimum: {} Range: {} ''' . format ( max_alien_neurons , min_alien_neurons , rng )) Maximum: 100856570 Minimum: 100223744 Range: 632826 From this, we know the difference between the largest and smallest values. To see how the original difference compares to this, we can look at the ratio of the difference and the range. In [59]: abs ( alien_mean - alien_median ) / rng Out[59]: 0.002525117488841235 Here we can get a sense of how \"close\" the median and mean are. This ratio is necessarily between 0 and 1, with 0 representing the same point, and 1 representing the largest difference in the sample (that is $x_1 - x_2 = x_{range}$). Although simple, the range suffers from some problems in that it only can measure the differences between the largest and smallest points. It is therefore as variable as those points. Suppose we had a dataset that looked like the following: 0, 50, 50, 50, 90, 95, 100. Then, the mean is: In [60]: example_ds = pd . Series ([ 0 , 50 , 50 , 50 , 90 , 95 , 100 ]) example_ds . mean () Out[60]: 62.142857142857146 In [61]: example_ds . median () Out[61]: 50.0 Using the ratio calculation as before, we would calculate: In [62]: ( example_ds . mean () - example_ds . median ()) / ( example_ds . max () - example_ds . min ()) Out[62]: 0.12142857142857146 In [63]: data = [ go . Histogram ( x = example_ds . tolist ())] shapes = [{ 'type' : 'line' , 'name' : 'Mean' , 'line' : { 'color' : 'red' }, 'xref' : 'x' , 'yref' : 'y' , 'x0' : example_ds . mean (), 'y0' : 0 , 'x1' : example_ds . mean (), 'y1' : 5 , }, { 'type' : 'line' , 'name' : 'Median' , 'line' : { 'color' : 'black' }, 'xref' : 'x' , 'yref' : 'y' , 'x0' : example_ds . median (), 'y0' : 0 , 'x1' : example_ds . median (), 'y1' : 5 , }] layout = go . Layout ( title = 'Dummy' , xaxis = dict ( title = 'Number' ), yaxis = dict ( title = 'Volume' ), shapes = shapes ) fig = go . Figure ( data = data , layout = layout ) plt . iplot ( fig ) require([\"plotly\"], function(Plotly) { window.PLOTLYENV=window.PLOTLYENV || {}; window.PLOTLYENV.BASE_URL='https://plot.ly'; if (document.getElementById(\"052fb4f4-b2a1-45c0-9b2b-7deadf919cac\")) { Plotly.newPlot( '052fb4f4-b2a1-45c0-9b2b-7deadf919cac', [{\"type\": \"histogram\", \"uid\": \"7ffbde38-eb02-4d50-866f-d1b754331407\", \"x\": [0, 50, 50, 50, 90, 95, 100]}], {\"shapes\": [{\"line\": {\"color\": \"red\"}, \"name\": \"Mean\", \"type\": \"line\", \"x0\": 62.142857142857146, \"x1\": 62.142857142857146, \"xref\": \"x\", \"y0\": 0, \"y1\": 5, \"yref\": \"y\"}, {\"line\": {\"color\": \"black\"}, \"name\": \"Median\", \"type\": \"line\", \"x0\": 50.0, \"x1\": 50.0, \"xref\": \"x\", \"y0\": 0, \"y1\": 5, \"yref\": \"y\"}], \"title\": {\"text\": \"Dummy\"}, \"xaxis\": {\"title\": {\"text\": \"Number\"}}, \"yaxis\": {\"title\": {\"text\": \"Volume\"}}}, {\"showLink\": false, \"linkText\": \"Export to plot.ly\", \"plotlyServerURL\": \"https://plot.ly\", \"responsive\": true} ).then(function(){ var gd = document.getElementById('052fb4f4-b2a1-45c0-9b2b-7deadf919cac'); var x = new MutationObserver(function (mutations, observer) {{ var display = window.getComputedStyle(gd).display; if (!display || display === 'none') {{ console.log([gd, 'removed!']); Plotly.purge(gd); observer.disconnect(); }} }}); // Listen for the removal of the full notebook cells var notebookContainer = gd.closest('#notebook-container'); if (notebookContainer) {{ x.observe(notebookContainer, {childList: true}); }} // Listen for the clearing of the current output cell var outputEl = gd.closest('.output'); if (outputEl) {{ x.observe(outputEl, {childList: true}); }} }) }; }); Now let's do something crazy -- let's change the last value of the series to 1 million, and see what happens to the \"ratio\" of the difference between the median and mean to the range. In [64]: example_ds . replace ({ 100 : 1000000 }, inplace = True ) In [65]: example_ds . median () Out[65]: 50.0 In [66]: ( example_ds . mean () - example_ds . median ()) / ( example_ds . max () - example_ds . min ()) Out[66]: 0.142855 In [67]: data = [ go . Histogram ( x = example_ds . tolist ())] shapes = [{ 'type' : 'line' , 'name' : 'Mean' , 'line' : { 'color' : 'red' }, 'xref' : 'x' , 'yref' : 'y' , 'x0' : example_ds . mean (), 'y0' : 0 , 'x1' : example_ds . mean (), 'y1' : 6 , }, { 'type' : 'line' , 'name' : 'Median' , 'line' : { 'color' : 'black' }, 'xref' : 'x' , 'yref' : 'y' , 'x0' : example_ds . median (), 'y0' : 0 , 'x1' : example_ds . median (), 'y1' : 6 , }] layout = go . Layout ( title = 'Dummy' , xaxis = dict ( title = 'Number' ), yaxis = dict ( title = 'Volume' ), shapes = shapes ) fig = go . Figure ( data = data , layout = layout ) plt . iplot ( fig ) require([\"plotly\"], function(Plotly) { window.PLOTLYENV=window.PLOTLYENV || {}; window.PLOTLYENV.BASE_URL='https://plot.ly'; if (document.getElementById(\"99fec4e8-d015-443a-a367-c1445f1d4778\")) { Plotly.newPlot( '99fec4e8-d015-443a-a367-c1445f1d4778', [{\"type\": \"histogram\", \"uid\": \"c6633ff1-9295-4013-bbcb-448423bc7426\", \"x\": [0, 50, 50, 50, 90, 95, 1000000]}], {\"shapes\": [{\"line\": {\"color\": \"red\"}, \"name\": \"Mean\", \"type\": \"line\", \"x0\": 142905.0, \"x1\": 142905.0, \"xref\": \"x\", \"y0\": 0, \"y1\": 6, \"yref\": \"y\"}, {\"line\": {\"color\": \"black\"}, \"name\": \"Median\", \"type\": \"line\", \"x0\": 50.0, \"x1\": 50.0, \"xref\": \"x\", \"y0\": 0, \"y1\": 6, \"yref\": \"y\"}], \"title\": {\"text\": \"Dummy\"}, \"xaxis\": {\"title\": {\"text\": \"Number\"}}, \"yaxis\": {\"title\": {\"text\": \"Volume\"}}}, {\"showLink\": false, \"linkText\": \"Export to plot.ly\", \"plotlyServerURL\": \"https://plot.ly\", \"responsive\": true} ).then(function(){ var gd = document.getElementById('99fec4e8-d015-443a-a367-c1445f1d4778'); var x = new MutationObserver(function (mutations, observer) {{ var display = window.getComputedStyle(gd).display; if (!display || display === 'none') {{ console.log([gd, 'removed!']); Plotly.purge(gd); observer.disconnect(); }} }}); // Listen for the removal of the full notebook cells var notebookContainer = gd.closest('#notebook-container'); if (notebookContainer) {{ x.observe(notebookContainer, {childList: true}); }} // Listen for the clearing of the current output cell var outputEl = gd.closest('.output'); if (outputEl) {{ x.observe(outputEl, {childList: true}); }} }) }; }); Huh. Here, the mean and median are very far apart -- and the mean is quite a bit off from the \"average\" person, as only one observation pushed it up into the thousands. This is, again, due to the lack of robustness of the mean. However, our ratio measure does not seem to think there is much of a difference between the difference in this case and in the previous case. We would expect that our most extreme values in the sample may be more variable then values closer to the center. In this case, we can take ranges of specific quartiles , as discussed in the previous post, to determine variability. Interquartile range In a similar way, we can define a range between any two percentiles of the data. In this case, the range is a specific case of this, where we take the 0th and 100th percentile of the data. As discussed earlier, this may be quite variant -- these are the most extreme values of our distribution. Suppose instead we took the difference between the 25th and 75th percentiles, or the 1st and 3rd quantiles. It would follow that this measure would be more robust then the max-min range. This is known as the inter-quartile range and is (unsurprisingly) robust to outliers. That is, we can say that the interquartile range in a finite sample is: $$ \\tilde{S}_{IQR} = Q_x(.75) - Q_x(.25) $$ Where $Q_x(p)$ is the quantile function, i.e. the function that finds data which is the above $p%$ of the data. Arithmetically, we can determine this by finding the medians of the values above and below the median. Most software packages contain functions which can determine this automatically. In the case of the alien brains, we have: In [68]: iqr = alien_neurons . quantile ( . 75 ) - alien_neurons . quantile ( . 25 ) iqr Out[68]: 210608.0 This represents how distant the closest two points which account for 50% of the data are. In other words, we have determined a measure of how far away things are. Taking a similar ratio, we can determine how distant two points are. For example: In [69]: abs ( alien_mean - alien_median ) / iqr Out[69]: 0.007587366101921311 This value has a range between 0 and infinity. In general, each \"unit\" of this ratio measures how far away the two points are relative to the center 50% of the data . A small value indicates that two points are relatively \"close\", while a large value (>1) indicates they are \"distant\" relative to the center 50%. For more information on this robust measure of spread, see here Boxplots Using the information we have learned about the measures of spread and measures of central tendency, we can now culminate it together into a plot called a box and whisker plot. This plot shows the median, the inter-quartile range, and the total range in one figure. This can give us a good \"overview\" of what the data looks like in terms of quantiles. In [70]: data = go . Box ({ 'x' : alien_neurons , 'name' : 'Alien Neurons' }) plt . iplot ([ data ]) require([\"plotly\"], function(Plotly) { window.PLOTLYENV=window.PLOTLYENV || {}; window.PLOTLYENV.BASE_URL='https://plot.ly'; if (document.getElementById(\"4deafc48-c995-4c04-94f2-58a5004b70e7\")) { Plotly.newPlot( '4deafc48-c995-4c04-94f2-58a5004b70e7', [{\"name\": \"Alien Neurons\", \"type\": \"box\", \"uid\": \"98592d07-dfc0-4fa2-acd2-8f27403193f3\", \"x\": [100507682, 100601005, 100336496, 100623165, 100754041, 100856570, 100702398, 100729273, 100411299, 100556471, 100697638, 100540953, 100411717, 100478614, 100574488, 100499210, 100852747, 100651745, 100697942, 100484243, 100397057, 100552299, 100388278, 100785268, 100546213, 100522820, 100426863, 100282560, 100397992, 100590144, 100248387, 100545909, 100517592, 100687610, 100657954, 100568996, 100569742, 100442644, 100411784, 100579139, 100520273, 100738283, 100342396, 100445818, 100624941, 100764764, 100430309, 100737396, 100761735, 100353133, 100467783, 100533562, 100415755, 100564377, 100444869, 100578210, 100630623, 100761510, 100550665, 100546729, 100360033, 100672311, 100472937, 100750441, 100616384, 100577225, 100397447, 100554639, 100617736, 100420158, 100568391, 100779155, 100415724, 100318415, 100496400, 100483601, 100511965, 100398418, 100613111, 100467889, 100696693, 100689413, 100656193, 100412745, 100548172, 100419812, 100603947, 100631853, 100453490, 100657843, 100290953, 100387413, 100512580, 100223744, 100436972, 100392013, 100836090, 100636159, 100540619, 100668141]}], {}, {\"showLink\": false, \"linkText\": \"Export to plot.ly\", \"plotlyServerURL\": \"https://plot.ly\", \"responsive\": true} ).then(function(){ var gd = document.getElementById('4deafc48-c995-4c04-94f2-58a5004b70e7'); var x = new MutationObserver(function (mutations, observer) {{ var display = window.getComputedStyle(gd).display; if (!display || display === 'none') {{ console.log([gd, 'removed!']); Plotly.purge(gd); observer.disconnect(); }} }}); // Listen for the removal of the full notebook cells var notebookContainer = gd.closest('#notebook-container'); if (notebookContainer) {{ x.observe(notebookContainer, {childList: true}); }} // Listen for the clearing of the current output cell var outputEl = gd.closest('.output'); if (outputEl) {{ x.observe(outputEl, {childList: true}); }} }) }; }); The center line represents the median, the two lines surrounding in the 25th and 75th quartiles, respectively, and the endpoints (and whiskers) represent the minimum and maximum. To compare to the non-symmetric simulated plot we discussed before, we can see large differences between the two: In [71]: data = go . Box ({ 'x' : sim , 'name' : 'Not Alien Neurons' }) plt . iplot ([ data ]) require([\"plotly\"], function(Plotly) { window.PLOTLYENV=window.PLOTLYENV || {}; window.PLOTLYENV.BASE_URL='https://plot.ly'; if (document.getElementById(\"fbd8e39c-e732-4ef5-907e-f0d095191183\")) { Plotly.newPlot( 'fbd8e39c-e732-4ef5-907e-f0d095191183', [{\"name\": \"Not Alien Neurons\", \"type\": \"box\", \"uid\": \"d2746a74-7bbe-4a50-8255-751a42831f92\", \"x\": [1815.2961130358603, 2320.218549594198, 1774.238950351985, 10129.329569604373, 1291.3107998367987, 223.3226019797967, 511.1190584745391, 2539.1462070254247, 1691.7984992130866, 3932.300750670352, 6793.957503120814, 1535.0287569346979, 2022.8973728018339, 1053.8154762349425, 973.5181073035899, 323.6513923572703, 9726.847031775475, 7135.352086198367, 3512.474945472328, 6227.505350176736, 13244.888216522466, 2867.9361099027983, 807.5146428567614, 2894.549648576427, 2244.178387714029, 3257.1038221480812, 1736.2230124900836, 924.3957750430835, 3939.8535567342283, 203.32884083827767, 14045.997332778845, 546.2147123850925, 417.5538715626165, 107.90409001348492, 1704.8438615097614, 113.8419174685519, 2439.006413127879, 1843.269218713016, 808.3472313135118, 866.3462227327186, 1505.053252145675, 1046.5330708322601, 2068.027719683339, 251.17616713782976, 141.12043094440338, 819.6818612377483, 2020.2503585291886, 417.7717118081688, 1978.642699972511, 4152.00901968332, 7141.121777756109, 294.25439730884705, 5055.263403490116, 2359.4096263832603, 737.0583169703585, 756.5588683955067, 1688.1995118447353, 1200.3525822057034, 5537.486837091894, 3052.5661838992432, 716.0370763823562, 9048.079440812544, 235.87876321395117, 779.4247291113422, 376.7574206190164, 1871.9125744152384, 1405.5064649823244, 1715.8137527463932, 8766.403226820257, 21225.42670423942, 4486.2549196354785, 416.20474169790657, 1517.5508166911504, 1267.3033729274018, 1133.9330477820738, 389.8746550213425, 67.45747393366179, 486.5432413205892, 7031.818751334337, 2086.3679690315575, 2097.541446182641, 2840.221558126296, 2919.222008028245, 5299.136151360571, 14501.064835070783, 1688.2746230691446, 3801.6947174533625, 1643.3099010076398, 204.99257950344463, 8409.984220817802, 1017.3364757112194, 1338.7638173892342, 404.5430086683285, 2607.930463755532, 171.50491673765143, 464.69817123005356, 2333.719993719836, 8551.131279451381, 8005.88791102838, 945.8413547396598]}], {}, {\"showLink\": false, \"linkText\": \"Export to plot.ly\", \"plotlyServerURL\": \"https://plot.ly\", \"responsive\": true} ).then(function(){ var gd = document.getElementById('fbd8e39c-e732-4ef5-907e-f0d095191183'); var x = new MutationObserver(function (mutations, observer) {{ var display = window.getComputedStyle(gd).display; if (!display || display === 'none') {{ console.log([gd, 'removed!']); Plotly.purge(gd); observer.disconnect(); }} }}); // Listen for the removal of the full notebook cells var notebookContainer = gd.closest('#notebook-container'); if (notebookContainer) {{ x.observe(notebookContainer, {childList: true}); }} // Listen for the clearing of the current output cell var outputEl = gd.closest('.output'); if (outputEl) {{ x.observe(outputEl, {childList: true}); }} }) }; }); We can see now how much of the inferences about spread can be understood through the use of quantiles and differences between them. These measures are quite robust, but suffer in the sense of efficiency. In a manner equivalent to the median and mean, these measures of variability do not take into account every data point, as the mean does, but only considers the quantiles. The next measure of spread, and the most common historically and in practice, is the variance which is defined in terms of the mean instead of in terms of quantiles. But first, we will discuss the degrees of freedom implicit in the mean. Freedom -- the dream, and the degree to which we have it It is at this point that we should discuss degrees of freedom , before jumping into variance. Degrees of freedom are a concept which many struggle with in elementary statistics, and is often glossed over in respect to statistics courses. I believe that understanding the degrees of freedom are essential in understanding how randomness ties into statistical treatment of data. It is for this reason that I have included this here. If this feels too math heavy, feel free to disregard it -- it is not necessary to understand, but helpful. If you're fond of mathematics, read on. Consider it this way. Let's say I told you we have 100 points. How many degrees of freedom do these points have? When I ask this, I essentially am asking the question how many different ways can these points vary? Well, we only know that there are 100 points -- we know nothing of how these points are distributed. Therefore, they can conceivably be any 100 points, since we have no prior information. Now, suppose that I tell you that the mean of these points is 100. Have the degrees of freedom changed? The answer is yes. We can no longer vary the numbers absolutely freely -- we are constrained in the fact that the number must have some property -- the mean -- which equals some known value. In this case, n - 1 of the points can vary, after which the final number is fixed. Let's consider an example. Imagine we pick some random numbers out of a hat and get the following: 9, 8, 2, 42, 100, -2. Suppose there is only one paper left in the hat and I told you that I, an omniscient observer, know that the mean of all the values in the hat is 1000. What is the final value? Well, we know that $$ \\bar{X}_{mean} = \\frac{\\sum_{1}&#94;{n} x_i}{n} = \\frac{\\sum_{1}&#94;{n - 1}}{n} + \\frac{x_n}{n} $$ So, it follows that: $$ x_n = n\\bar{X}_{mean} - \\sum_{1}&#94;{n-1} x_i $$ This is only using elementary algebra. In our case, the final value is $$ 7 \\bar{X}_{mean} - \\sum_{1}&#94;{6} x_i\\\\ 7 \\times 1000 - (9 + 8 + 2 + 42 + 100 - 2) $$ This is: In [72]: points_picked = pd . Series ([ 9 , 8 , 2 , 42 , 100 , - 2 ]) last_value = 7000 - points_picked . sum () last_value Out[72]: 6841 To confirm that this is correct, lets see what the mean looks like. In [73]: points_picked . append ( pd . Series ( last_value )) . mean () Out[73]: 1000.0 But we could do this for any mean! Suppose the mean was instead -1000. Then In [74]: last_value = - 7000 - points_picked . sum () last_value Out[74]: -7159 In [75]: points_picked . append ( pd . Series ( last_value )) . mean () Out[75]: -1000.0 This describes what the mean tells us about the data -- if we know the mean, one of the data points essentially becomes redundant. Now, suppose I wanted to create my own hat game, where I wanted the mean to be 42. How could I do this? There are infinitely many sets of numbers I could choose that have a mean of 42. However, they all have the constraint that if we were to remove one value, we could reconstruct it in the way above ! That is, the final value is not random but determined . This means that we have n - 1 degrees of freedom -- or that the dimensionality of our random vector is now n -1. Then, I could randomly select n - 1 numbers, and select the final number deterministically such that $$ x_7 = 7 \\times 42 - \\sum_{1}&#94;{6} x_i $$ This will ensure that my mean is always 42. In fact, there is no such other number I could choose that has a mean of 42. Conversely, the number I select will uniquely determine the mean. So the mean has one degree of freedom -- it can be determined entirely from one number, if the other numbers are known. This becomes important because the more degrees of freedom we have, the more we allow random variation to play a part in our estimates. Although randomness may seem bad, in fact having more degrees of freedom can be a good thing, as is the case in linear regression -- a topic for a different day. In general, we have In [76]: def find_point_from_mean ( series_of_less , mean ): n = len ( series_of_less ) + 1 n_final = n * mean - series_of_less . sum () return n_final In [77]: find_point_from_mean ( points_picked , 1000 ) Out[77]: 6841 Freedom isn't free Now let's tackle the first case -- we have 100 points with a mean of 100. How many different ways can we select these 100 points? Consider the following: knowing only the mean of the distribution, we can select any n - 1 points, in this case 99, arbitrarily and completely at random, and then select the final point such that: $$ x_{final} = n\\bar{X}_{mean} - \\sum_{i=1}&#94;{n-1} x_i $$ In this case, this is $$ x_{final} = 10,000 - \\sum_{i=1}&#94;{99} x_i $$ Taken another way, we can say the following: Knowing the mean, we can calculate: $$ \\tilde{x}_i = x_i - \\bar{X}_{mean}\\\\ \\forall x_i \\in S $$ Only n -1 of these values are allowed to vary -- once we know n-1 of them, the last is determined by the calculation of the mean. In general, we have that the degrees of freedom can be decomposed as follows: $$ \\begin{bmatrix}x_1 \\\\ x_2 \\\\ ... \\\\ x_n\\end{bmatrix} = \\begin{bmatrix}\\bar{X}_{mean} \\\\ \\bar{X}_{mean}\\\\ ... \\\\ \\bar{X}_{mean}\\end{bmatrix} + \\begin{bmatrix} x_1 - \\bar{X}_{mean} \\\\ x_2 - \\bar{X}_{mean}\\\\ ... \\\\ x_n - \\bar{X}_{mean}\\end{bmatrix} $$ Note that this is in vector notation, but it makes the results easier to see. The vector on the left, our data points $x_1, x_2, ..., x_n$ have n degrees of freedom -- given no additional information, they are free to vary randomly. The first vector on the right, the vector of means, has 1 degree of freedom -- if we do not know it, it can vary in one dimension. That means it can be any single number. The final vector on the right now has n - 1 degrees of freedom (the degrees of freedom of the original vector minus the degrees of freedom of the mean). This means that given a mean, our data points can vary with dimension n - 1. The final dimension is then a linear combination of the other data points. Variance But how does this have any connection to the spread of a dataset? Happy you asked! One way we can consider spread is: how far away are the observations from the mean? In order to do this, we could take the differences between each point and the mean. This would look something like this: In [78]: x_differences = alien_neurons - alien_mean x_differences Out[78]: 0 -37191.04 1 56131.96 2 -208377.04 3 78291.96 4 209167.96 5 311696.96 6 157524.96 7 184399.96 8 -133574.04 9 11597.96 10 152764.96 11 -3920.04 12 -133156.04 13 -66259.04 14 29614.96 15 -45663.04 16 307873.96 17 106871.96 18 153068.96 19 -60630.04 20 -147816.04 21 7425.96 22 -156595.04 23 240394.96 24 1339.96 25 -22053.04 26 -118010.04 27 -262313.04 28 -146881.04 29 45270.96 ... 70 23517.96 71 234281.96 72 -129149.04 73 -226458.04 74 -48473.04 75 -61272.04 76 -32908.04 77 -146455.04 78 68237.96 79 -76984.04 80 151819.96 81 144539.96 82 111319.96 83 -132128.04 84 3298.96 85 -125061.04 86 59073.96 87 86979.96 88 -91383.04 89 112969.96 90 -253920.04 91 -157460.04 92 -32293.04 93 -321129.04 94 -107901.04 95 -152860.04 96 291216.96 97 91285.96 98 -4254.04 99 123267.96 Length: 100, dtype: float64 This will give us differences for each of the points. It would be nicer to have one number to measure the variability of the data, so we can take the average of these values: In [79]: x_differences . mean () Out[79]: -6.556510925292969e-09 Hm. This value is very close to zero. This is actually expected, simply because of the definition of the arithmetic mean . Consider the following: $$ \\bar{X}_{mean} = \\frac{\\sum_{i=1}&#94;{n} x_i}{n}\\\\ \\sum_{i=1}&#94;{n}(x_i - \\bar{X}_{mean}) =\\\\ \\sum_{i=1}&#94;{n}x_i - n\\bar{X}_{mean} = \\\\ \\sum_{i=1}&#94;{n}x_i - n\\frac{\\sum_{i=1}&#94;{n} x_i}{n} =\\\\ 0 $$ Intuitively, the mean is the value which is in the \"center\" of the distribution, in the sense that the differences above the mean are equal to the differences below the mean. The mean is specifically selected such that this sum will equal to zero. But in our case, we are not very happy with this. We are not as concerned with the sign of the distance from the mean, but how far away it is. We are not interested in the direction but the magnitude . For example, if the mean is 2 and we have two points around it, 1 and 3, we would say that they are equally distanced from the mean -- the sign of the difference (-1 and 1) does not matter. How can we eliminate the sign? Mathematically, there are two general approaches to this -- we can take the absolute value or we can take the squares . The absolute value preserves the exact magnitude, while squaring does not. Why might we want to take the squares? Squaring the distance values will essentially put more weight on values which are far from the mean, and less on those close. In this sense, we get a penalization in the case of extreme values -- extreme values will make our variance larger than \"common\" values. Additionally, historically the squares have been used because they are analytically \"nicer\" -- they are smooth functions for which we can take the derivative, while the absolute value is not. In the computing age, this has become less of an issue as numerical approaches to optimization problems have taken hold, but I digress. Since the squared version is used the most in statistical literature, we will define this first. We can define the sum of squares as the following: $$ SS = \\sum_{i=1}&#94;{n}(x_i - \\bar{X}_{mean})&#94;2 $$ This gives us a sense of the total amount of squared deviations from the mean. This is a measure of spread. It may be useful to get an average of these values, i.e. the \"typical\" squared deviation from the mean. This is known as the mean squared deviation from the mean, or the variance . In the case of a known population mean , we can calculate this variance directly from our sample. In this case, all of our values are allowed to vary freely -- they are not reliant on this known population mean. So we can take the mean as follows: $$ \\hat\\sigma&#94;2 = \\frac{1}{n}\\sum_{i=1}&#94;{n}(x_i - \\mu)&#94;2 $$ Of course, this would not happen often in practice. But since the mean was known, our values are not linearly computable directly from it -- in this sense, they can be any values. If we do not, however, we must make a correction known as the Bessel's correction . The sample variance is the variance which takes this into account, as follows: $$ \\hat{s}&#94;2 = \\frac{1}{n-1}\\sum_{i=1}&#94;{n}(x_i - \\bar{X}_{mean})&#94;2 $$ Here, we divide by n-1 because the vector of $x_i - \\bar{x}_i$ is only allowed to vary in n-1 dimensions -- because it is determined once the other points are calculated. This is how degrees of freedom relates to the sample variance. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Beginner Statistics","url":"category/beginner-statistics/sumstatsmeasuresofspread.html","loc":"category/beginner-statistics/sumstatsmeasuresofspread.html"},{"title":"Summary Statistics Part 1: Central Tendency","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } Summary Statistics (and what they mean) Welcome! In this (very first) post, we are going to be going over a few basic statistical concepts involving summary statistics and how we can use them. This is a great place to start for getting some idea on how statistics can work for you! Statistics courses usually start with a discussion of summary statistics, and for good reason. Summary statistics are the essential building blocks of statistics. When we talk about expectation, or prediction, we are actually talking about a summary statistic -- in many cases, and algorithms, the mean. For the most part, summary statistics can give us a good idea of the underlying distribution and, in some cases, are sufficient in describing a set of data points for a particular algorithm. Don't Be Another Statistic The first question that will come up immediately when discussing this is what exactly a statistic is. In everyday language many people use statistic to mean a way of summarizing data into a single data point. When people say things like \"You are not just a statistic!\", what they are generally referring to is how statistics are aggregates of data. That is, statistics cannot capture all of the truth, but only an average. So is it fair to say that statistics are purporting to be cold-hard facts gathered from data? Not exactly. Statistics are gathered from sample data, and are often used as an estimation of the population. In statistician speak, a population is the theoretical overarching group that we wish to infer about. For instance, the population can be men living in the United States, all of the atoms in the universe, or the set of all possible combinations of people into couples. A sample is a subset of the population, a smaller group derived from it. We use statistics derived from the sample to make inferences about the population, but by definition these are not exact -- they depend on the sample that we choose. Almost surely, if we were to choose another sample we would come up with a different statistic. Therefore, a statistician would not take a summary statistic to be the hard, cold \"truth\", but a signal, or estimation, of the \"cold hard truth.\" Statistics vs Statistic Unfortunately, much of the confusion about the nature of a statistic has to do with the field known as statistics. Confusing, but true. Statistics is generally what people are referring to when they talk about the hand-wavy idea -- \"gathering insights from data.\" But this treats data as though it is a fixed, constant thing. This couldn't be further from the case! This is exactly what makes statistics such an interesting field -- statistics deals with random variation. Statistics isn't used for cases of absolute certainty, like many of the sciences do, but revels in the uncertainty of real life. Indeed, nearly everything has random variation involved in it, and therefore nearly everything is in the scope of statistics. The way we can quantify uncertainty is by using the theories of probability. But that is for another post! In general, we do not say that a statistic is the \"ground truth\" but a description of sample data. This sample statistic is then used to estimate the </b> population parameters.</b> This comes from the initial distinction that many people make -- samples themselves are not a representation of the ground truth. When a statistic is used as a statement about the population, we call this statistic an estimator of the population parameter. In fact, population parameters are not nearly as interesting as sample statistics. A population parameter is not probabilistic at all -- if it is obtainable, then it will be a single value with no variation. Sample statistics, however, do vary, and sometimes considerably based on how the data is sampled and how large the sample is. Throughout this exercise, I am going to be using some code to give examples of how these things work. I will only be displaying code that I believe is helpful for the task at hand, and I will create a future article describing how this code is written using python. In this post, which I will be calling a \"framework\" post, I will only be describing how these things work. Then, in a \"application\" post, I will show how to write code to solve these problems with real-world data. Class Grades Now, onto an example. Suppose we have a class of 7th graders who had gotten the following grades on the previous exam: 95, 80, 50, 80, 100, 94. Let's start with the situation where this is the entire class. In this case, we are dealing with the population. That means, if we take the common 'statistics', we will not have a statistic at all but a parameter. This distinction makes it clear that we are not estimating anything, but are looking at the \"cold, hard truth.\" The population is then \"the grades of 7th graders on math test last week.\" If, however, we were trying to estimate their performance in the class overall from this test alone, then this is a sample , presuming there were other tests. Thus, the phrasing of the question is a large distinction. In [1]: from itertools import combinations import numpy as np import pandas as pd from scipy import stats import matplotlib as plt % matplotlib inline In [2]: class_grades = pd . Series ({ 'John' : 95 , 'Mary' : 80 , 'Jacob' : 50 , 'Jose' : 80 , 'Sarah' : 100 , 'Laura' : 94 }) class_grades Out[2]: John 95 Mary 80 Jacob 50 Jose 80 Sarah 100 Laura 94 dtype: int64 Central Tendency Given a set of data points, where do we start? A good start is determining the central tendency or what we often call the average. Here, I use the word average as a general case of central tendency -- we want to know what the average student in this class looks like. All of the following examples assumes that we have some finite sample of a finite population, but can be extended in the more general case. Arithmetic Mean One common example of an average is the arithmetic mean. We are all familiar with this from our schooling days: \\begin{equation} \\bar{X}_{mean} = \\frac{ \\sum_{i=0}&#94;{n} x_{i} }{n} \\end{equation} Here, we say that we sum over all of the possible values, and divide by the total number. We can see the results on our simple dataset above: $$ 95 + 80 + 50 + 80 + 100 + 94 = 499 = T \\\\ \\bar{x} = \\frac{T}{6} = 83.166 $$ In [3]: mean = class_grades . mean () mean Out[3]: 83.16666666666667 Median Another measure of central tendency is the median. The median is the value which half of the data is smaller and half is larger than. If there is an even number of points, we take the average of the two closest to the \"center\" of the ranked numbers. For example, we first list the points from smallest to largest: $$ 50, 80, 80, 94, 95, 100 $$ Then, we iteratively remove points from each side until we arrive at a single value (if the total number of points is odd) or two values (if it is even). This is shown below: $$ 50, 80, 80, 94, 95, 100\\\\ 80, 80, 94, 95\\\\ 80, 94\\\\ $$ Now that we have two values (since 6 = n is even), we take an average of these values. That is: $$ \\frac{(80 + 94)}{2} = 87 $$ Note that we can also express this as follows: Rank the $X_i$ from smallest to largest, where $i = 1, ..., n$. Define $X&#94;{(i)}$ as the $i$th order statistic , where $i$ is the rank in this list. Then: $$ \\tilde{X}_{median} = \\begin{cases} X&#94;{(\\frac{n+1}{2})}, & \\text{if n is odd}\\\\ \\frac{X&#94;{(\\frac{n+2}{2})} + X&#94;{(\\frac{n}{2})}}{2}, & \\text{if n is even} \\end{cases} $$ Then, $n$ in this case is 6, which is even. So we take the average of the 3rd and 4th order statistic, 80 and 94. This is the same result we had derived earlier. In [4]: median = class_grades . median () median Out[4]: 87.0 Mode Finally there is the mode. The mode is simply the most likely value, or the most recurring value. Thus there can be multiple modes if there are two values which are equally likely and are the most recurring in the dataset. We can summarize this by looking at the frequencies of each data point. For convenience, I have done this using pandas. In [5]: class_grades . value_counts () Out[5]: 80 2 95 1 94 1 100 1 50 1 dtype: int64 Because 80 occurs twice, it is the mode. In [6]: mode = class_grades . mode () mode Out[6]: 0 80 dtype: int64 For all unique values $u_j$ of $x_i$ in the sample, let $f(u_j) = \\sum_{x_i} 1, \\forall x_i = u_j$ Then, $f(u_j)$ is the frequency of unique value $u_j$. Then: $$ \\hat{X}_{mode} = \\{ u_j \\mid f(u_j) = \\max_{u_j}f(u_j) \\} $$ The set notation implies that it is possible for there to be multiple modes. If there is only one mode, such as in the case of the class grades, then we say that the sample is unimodal. Other Measures of Central Tendency These are all of the canonical measures of central tendency that you have likely heard about before. However, there are others as well such as those listed here . Check them out -- they're pretty interesting! For fun, I will show some examples below. Trimean The trimean is the weighted arithmetic mean of the median and two quartiles. That's a lot to unpack, so let me explain. By weighted, we mean that the observations are multiplied by some set of constants that place a magnitude on a particular observation. Higher weighted variables are considered more \"important\" to the calculation. Instead of dividing by the sample size, we divide instead by the sum of the weights . Another way of looking at this is that each observation is considered to have a probability of occurring, $\\frac{w_i}{\\sum_{i}w_i}$. Then, the weighted average is a generalization of the arithmetic average explained before, where the arithmetic average weighs each value equally, i.e, $w_i = c$ for all $i$. Then we arrive at the same formula we saw in equation (1). A quartile is the point that is greater then some multiple of 25% of the data. If there is no such discrete number, we take a weighted average to determine its value. It is called a quartile because it separates the data into four segments. The first quartile is the data point which is greater than 25% of the data, the second is the median (50% of the data), the third is for 75% of the data, and the forth quartile is also the maximum, greater than all of the data. Interestingly, this is often not considered a quartile, but by the same logic it can be considered one. The trimean is then defined as: $$ TM = \\frac{Q_1 + 2M + Q_3}{4} $$ Intuitively, this is the average of the Median (M) and the midhinge, defined as: $$ MH = \\frac{Q_1 + Q_3}{2} $$ This is calculated below: In [7]: def trimean ( series ): T = series . quantile ( . 25 ) + 2 * series . median () + series . quantile ( . 75 ) TM = T / 4 return ( TM ) TM = trimean ( class_grades ) TM Out[7]: 87.1875 In practice, it turns out that this estimator is a remarkably efficient estimator of the population, meaning it can accurately estimate the population mean if calculated on a sample with relatively fewer points than other estimators. For a symmetric distribution like the normal distribution, it is the most efficient as compared with the median, and other L-3 estimators. See here for more information. It is also is more robust than the mean, which will be discussed further below. Winsorized Mean This will be a good segue into the next section, which examines the most appropriate method of central tendency to use. The Winsorized Mean attempts to mitigate the effect of outliers -- values that are very far from what we would call the \"average\" value. If this doesn't make sense yet, don't worry. I'll be discussing it further later in the section on robustness. For now, we will just examine what this will look like. In the Winsorized mean, we will take the most extreme values of our sample and replace them with the most extreme remaining values. In this case, this is 50 and 100. So, our new, adjusted, sample to calculate the central tendency is: $$ \\tilde{S} = {80, 80, 80, 94, 95, 95} $$ Here, we replaced 50 with 80 -- the next smallest value -- and 100 with 95 -- the next largest value. In this case, the data is quite small, so we would likely not want to do this, but for a large dataset this can be useful. We then take the average of the remaining values. $$ \\frac{ \\sum_i \\tilde{s}_{i} }{n},\\\\ \\forall \\tilde{s}_i \\in \\tilde{S} $$ If you don't understand the notation, don't worry. We're just taking an average of our \"new\" sample. I just did it to be precise. In general, we can take the largest and smallest p% of data and replace it with the most extreme values within this range. This value is arbitrary, but is often taken to be 10 to 25% of the ends replaced. In this example, we take the top and bottom 10%, which trims the most extreme values on both sides. In [8]: def winsorized_mean ( series , percent_removed ): ## Taking the value which is greater than/less than percent_removed bot_quant = series . quantile ( percent_removed ) top_quant = series . quantile ( 1 - percent_removed ) #Finding the values to replace bottom = series [ series < bot_quant ] top = series [ series > top_quant ] #Replacements rep_bottom = min ( series [ series > bot_quant ]) rep_top = max ( series [ series < top_quant ]) replacement_dic = { b : rep_bottom for b in bottom } replacement_dic . update ({ t : rep_top for t in top }) # Make replacements, find mean S_tilde = series . replace ( replacement_dic ) winsorized_mean = S_tilde . mean () return ( winsorized_mean ) wm = winsorized_mean ( class_grades , . 1 ) wm Out[8]: 87.33333333333333 But wait! How can you just replace values like that! I know, it seems dishonest. The idea is that these values are extremely unlikely. In the case of 6 people, this is probably not the case. But imagine we had the following values: $$ 0, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 100 $$ In [9]: ex_outliers = pd . Series ( np . concatenate ([[ 0 ], np . repeat ( 95 , 18 ), np . repeat ( 96 , 12 ), [ 100 ]])) ex_outliers . mean () Out[9]: 92.5625 But, would we say that the average student received a grade of 92? This seems like an underestimation. Naively, if we choose the Winsorized mean, we would get the following: In [10]: winsorized_mean ( ex_outliers , . 1 ) Out[10]: 95.40625 This seems like a more accurate representation of the data. In the cases of outliers, one must be careful to examine the distribution of the data well before naively using one measure of central tendency, as the results may be very misleading. Which to choose? This is not always clear, as we saw above for the Windsorized mean. If we look at a histogram of the values, we can get a sense of the shape of the distribution. It turns out that the shape can help us determine which measure of central tendency best describes the distribution. In [11]: plt . pyplot . figure ( figsize = ( 15 , 10 )) plot = class_grades . hist () plot . axvline ( x = mean , color = 'red' , label = 'Arithmetic Mean' ) plot . axvline ( x = median , color = 'black' , label = 'Median' ) plot . axvline ( x = mode [ 0 ], color = 'green' , label = 'Mode' ) plot . axvline ( x = TM , color = 'yellow' , label = 'Trimean' ) plot . axvline ( x = wm , color = 'purple' , label = 'Winsorized Mean' ) plot . legend () Out[11]: <matplotlib.legend.Legend at 0x11662c5da58> All of these represent central tendency. To see this more easily, let's consider it on a larger dataset. In [12]: likelihood_estim = stats . beta . fit ( class_grades / 100 ) random_var = pd . Series ( np . random . beta ( likelihood_estim [ 0 ], likelihood_estim [ 1 ], 100 )) * 100 random_var = random_var . floordiv ( 1 ) C:\\Users\\ginge\\Anaconda3\\lib\\site-packages\\scipy\\stats\\_continuous_distns.py:437: RuntimeWarning: invalid value encountered in sqrt sk = 2*(b-a)*np.sqrt(a + b + 1) / (a + b + 2) / np.sqrt(a*b) In [13]: plt . pyplot . figure ( figsize = ( 15 , 10 )) plot = random_var . hist ( bins = 30 ) plot . axvline ( x = random_var . mean (), color = 'red' , label = 'Arithmetic Mean' ) plot . axvline ( x = random_var . median (), color = 'black' , label = 'Median' ) plot . axvline ( x = random_var . mode ()[ 0 ], color = 'green' , label = 'Mode' ) plot . axvline ( x = winsorized_mean ( random_var , . 1 ), color = 'yellow' , label = 'Winsorized Mean' ) plot . axvline ( x = trimean ( random_var ), color = 'purple' , label = \"Trimean\" ) plot . legend () Out[13]: <matplotlib.legend.Legend at 0x11662e02d30> We see that this is a skewed distribution -- in particular it is left skewed . A majority of the students did well on the exam, but there were some who did particularly poorly, with some extreme values on the far left. In this case, where there are many extreme values, the mean is not a good \"average\" -- it is dragged down by the very small values in the tail. We can see this as the mean is close to 70, but it appears that the \"average\" student did better than this. The median is a more robust measure, because it is less sensitive to anomalies in the sample. The mode is not very useful in this case, as it is at the bin with the largest values. The \"average\" student likely did worse than this. In general, as a rule of thumb, for a unimodal distribution (meaning there is only one mode), it is often but not always the case that: Let $\\bar{X}_{median}$ be the median of a distribution and $\\bar{X}_{mean}$ be the arithmetic mean. Then: if $\\bar{X}_{median} << \\bar{X}_{mean}$, X is right skewed if $\\bar{X}_{median} \\approx \\bar{X}_{mean}$, X is approximately symmetric if $\\bar{X}_{median} >> \\bar{X}_{mean}$, X is left skewed This can be used as a guideline to see how skewed our distribution is. However, it is not foolproof - in some cases this fails. See this wikipedia article for more information. For instance, consider -6, -4, 0, 0, 2, 8. The mean and median are zero, but this distribution is skewed to the left, i.e. not symmetric. In [14]: plt . pyplot . figure ( figsize = ( 15 , 10 )) example = pd . Series ([ - 6 , - 4 , 0 , 0 , 2 , 8 ]) example . hist () plot . axvline ( x = example . mean (), color = 'red' , label = 'Arithmetic Mean' ) plot . axvline ( x = example . median (), color = 'black' , label = 'Median' ) plot . legend () Out[14]: <matplotlib.legend.Legend at 0x11662ea32e8> In general, since the median is a more robust measure, if we are given a sample and wish to estimate the behavior of the population and we believe that the skewed values are anomalies , the median is a better \"guess\" of the central tendency. Interestingly, the two \"non-typical\" central tendency estimators, the Windsorized mean and the Trimean, lay between the mean and the median. The Windsorized mean and Trimean are both more robust then the mean, meaning they are less sensitive to extreme values. This is directly dealt with in the Windsorized mean and is implicit in the Trimean in a method similar to taking the median. Notice also that the median and mean tell us different things about the data. The mean uses all of the information available, and each data point contributes equally to the evaluation of it. On the other hand, the median \"cuts away\" all of the data not at the 50% mark. In this way, the median can be seen as an extreme version of the Windsorized Mean where we cut out the bottom 49% and 51%. In this case, we are seeing a trade-off between robustness which is the variability of the estimator under anomalies and varying sample distributions, and power (or efficiency ), which can determine a more stable solution with less data assuming certain assumptions are met. For instance, if we know that the population distribution follows some \"known\" distribution, it can often be shown that the mean is a sufficient, unbiased estimator of the true population mean. In the case of the normal distribution, it is the most efficient estimator of the population mean, while the median is relatively inefficient. This means that the median will require more data to obtain the same level of accuracy as the mean. To sum it all up -- the mean is often the most efficient estimator in certain simplifying conditions, but is not robust. On the other hand, the median is robust , but not as efficient. Samples of samples of samples, oh my! Why do we care about these measures of central tendency? Well, let's take a look at how they function in terms of predicting a population parameter. Suppose, as we talked about before, the population in a simplistic example is 95, 80, 50, 80, 100, 94. Let's consider all possible samples of 3 of this data. There are 6 data points and we wish to choose 3. This means there are 6 choose 3, or 20 possible samples. The possible samples are: In [15]: possible_samples = combinations ( class_grades , 3 ) list ( possible_samples ) Out[15]: [(95, 80, 50), (95, 80, 80), (95, 80, 100), (95, 80, 94), (95, 50, 80), (95, 50, 100), (95, 50, 94), (95, 80, 100), (95, 80, 94), (95, 100, 94), (80, 50, 80), (80, 50, 100), (80, 50, 94), (80, 80, 100), (80, 80, 94), (80, 100, 94), (50, 80, 100), (50, 80, 94), (50, 100, 94), (80, 100, 94)] We remember from before that the population mean is 83.16666. This is a population parameter -- it is not a statistic. However, suppose we sampled randomly from this population and retrieved the sample data: 80, 94, 80. Then our estimate of the population mean would be 84.6. Remember when I said that the statistic is never the \"cold hard\" truth? Here is a direct example. However, there are some nice properties of this. Consider the means and medians of all the samples: In [16]: sample_dict = {} for i , x in enumerate ( combinations ( class_grades , 3 )): sample_dict [ i ] = x sample_results = pd . DataFrame ( sample_dict ) . T sample_results [ 'mean' ] = sample_results . mean ( axis = 1 ) sample_results [ 'median' ] = sample_results . iloc [:, 0 : 3 ] . median ( axis = 1 ) sample_results Out[16]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 0 1 2 mean median 0 95 80 50 75.000000 80.0 1 95 80 80 85.000000 80.0 2 95 80 100 91.666667 95.0 3 95 80 94 89.666667 94.0 4 95 50 80 75.000000 80.0 5 95 50 100 81.666667 95.0 6 95 50 94 79.666667 94.0 7 95 80 100 91.666667 95.0 8 95 80 94 89.666667 94.0 9 95 100 94 96.333333 95.0 10 80 50 80 70.000000 80.0 11 80 50 100 76.666667 80.0 12 80 50 94 74.666667 80.0 13 80 80 100 86.666667 80.0 14 80 80 94 84.666667 80.0 15 80 100 94 91.333333 94.0 16 50 80 100 76.666667 80.0 17 50 80 94 74.666667 80.0 18 50 100 94 81.333333 94.0 19 80 100 94 91.333333 94.0 We see that both the mean and the median vary around the true population mean for each sample. This is the sampling distribution of the sample mean. This is what has a distribution and can vary! Remember, our population parameter is fixed, but the variation implicit in each sample is what controls the distribution here. Since this too is a distribution, we can examine statistics about it. In [17]: sample_results . drop ([ 0 , 1 , 2 ], axis = 1 , inplace = True ) sample_results . mean ( axis = 0 ) Out[17]: mean 83.166667 median 87.200000 dtype: float64 In [18]: mean Out[18]: 83.16666666666667 Hmm, that seems odd. It turns out that the expectation, or arithmetic mean, of the sampling distribution of the sample mean is equal to the true population mean! This property actually follows directly from the definition of the arithmetic mean. We're going to go into some maths here, but feel free to skip over it if you don't want to. The point here is that the sample mean is an unbiased estimator of the population mean . Theorum 1: If $S$ is a sample of size $k$ from a population of size $N$ drawn randomly and without replacement , then the mean of the sample, $\\bar{X}_S$, is an unbiased estimator of the population mean. Let $\\bar{X}_P$ be the population mean. Then $$ \\bar{X}_P = \\frac{ \\sum_{i=1}&#94;{N} x_{i} }{N}\\\\ $$ Let $\\bar{X}_s$ be the mean of a sample of size k, called $S_s$. Then, $$ \\bar{X}_s = \\frac{ \\sum_j x_{j, s} }{k}\\\\ $$ Where $X_{j,s}$ is the $j$th observation from sample $s$. It follows that there are ${N}\\choose{k}$ possible samples, ie, $s$ runs from $1$ to ${N}\\choose{k}$. Let $M =$ ${N}\\choose{k}$. Then: $$ \\sum_{s=1}&#94;{M} \\frac{\\bar{X}_s}{M} =\\frac{\\sum_{s=1}&#94;{M} \\sum_j \\frac{x_{j, s}}{k}}{M}\\\\ =\\frac{\\sum_{s=1}&#94;{M} \\sum_j x_{j, s}}{kM} $$ Each value of the population will appear in ${N}\\choose{k}$ - ${N-1}\\choose{k}$ = $M - \\frac{M(N-k)}{N}$ samples. We can say this because it is the total number of possible samples ${N}\\choose{k}$ minus the total number of samples of size $k$ which do not contain observation $j$, ${N-1}\\choose{k}$. So then we have: $$ \\frac{M - \\frac{M(N-k)}{N}}{kM} \\sum_i x_i $$ Expanding the left hand side: $$ \\frac{M - \\frac{M(N-k)}{N}}{kM} = \\frac{1}{k} - \\frac{N-k}{kN} =\\frac{1}{N} $$ so $$ \\sum_{s=1}&#94;{M} \\frac{\\bar{X}_s}{M} = \\frac{ \\sum_{i=1}&#94;{N} x_{i} }{N}\\\\ $$ But, we now see that this is exactly equal to the population mean, $\\bar{X}_P$! Since we weighed each sample equally in this expectation, this is equivalent to sampling randomly without replacement. This means that we have proven the result -- the sample mean is an unbiased estimator of the population mean. This is a powerful result! Hopefully you can begin to see why statistics is so exciting now! We have proven that any inference about the population mean using a sample mean will, on average, be accurate. However, it is important to note that while the sample mean is unbiased, it does not make it the most accurate estimator. This will be covered in the next post, when we discuss the Measures of Spread. We've seemed to disregard the median in this case. Why is this? Well, the median is not an unbiased estimator of the population mean. However, we see that the case changes quite a bit when we take the medians! In [19]: sample_results . median ( axis = 0 ) Out[19]: mean 83.166667 median 87.000000 dtype: float64 In [20]: median Out[20]: 87.0 In this case we see that both the mean and the median are equal to the population values. What gives?! Well, it turns out that the sample median is a median unbiased estimator of the population median. This one is a bit tougher to prove, so I will leave it for now. Perhaps we can get back to it when we discuss probability density functions, as it requires some use of this. What about the mean? Why is the mean a median unbiased estimator of the population mean? The reason is because of the Central Limit Theorum, but this is something that will take some time to discuss! However, because the sampling distribution of the sample mean will tend to a normal distribution relatively quickly, it also becomes symmetric quickly. In this case, the median converges towards the mean. That is why we see that the mean in this case is again equal to the median. We can look at a histogram to see the details: In [21]: plt . pyplot . figure ( figsize = ( 15 , 10 )) sample_results [ 'mean' ] . hist () Out[21]: <matplotlib.axes._subplots.AxesSubplot at 0x11662e70278> Conclusion In this first post, we went over what a statistic is and the distinction between a sample and a population. We also discussed measures of central tendencies and their relation to sampling distributions. In the next post, we will be discussing the Measures of Spread which will shed light further on the sampling distribution of the sample mean. Hope you enjoyed! if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Beginner Statistics","url":"category/beginner-statistics/sumstatscentraltendency.html","loc":"category/beginner-statistics/sumstatscentraltendency.html"},{"title":"Bootstrapping Exercise","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } This is a simple example of using the boot function in R to produce bootstrapped estimates of the bias and standard error of the parameters. In [2]: install.packages ( 'ISLR' ) Updating HTML index of packages in '.Library' Making 'packages.html' ... done In [3]: library ( ISLR ) library ( boot ) attach ( Default ) head ( Default ) glm.fit <- glm ( default ~ income + balance , family = \"binomial\" , data = Default ) summary ( glm.fit ) boot.fn <- function ( data , index ) { return ( glm ( default ~ income + balance , family = \"binomial\" , data = data , subset = index ) $ coefficients ) } boot.fn ( Default , 1 : 100 ) boot ( Default , boot.fn , 1000 ) summary ( glm.fit ) default student balance income No No 729.5265 44361.625 No Yes 817.1804 12106.135 No No 1073.5492 31767.139 No No 529.2506 35704.494 No No 785.6559 38463.496 No Yes 919.5885 7491.559 Call: glm(formula = default ~ income + balance, family = \"binomial\", data = Default) Deviance Residuals: Min 1Q Median 3Q Max -2.4725 -0.1444 -0.0574 -0.0211 3.7245 Coefficients: Estimate Std. Error z value Pr(>|z|) (Intercept) -1.154e+01 4.348e-01 -26.545 < 2e-16 *** income 2.081e-05 4.985e-06 4.174 2.99e-05 *** balance 5.647e-03 2.274e-04 24.836 < 2e-16 *** --- Signif. codes: 0 ‘***' 0.001 ‘**' 0.01 ‘*' 0.05 ‘.' 0.1 ‘ ' 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 2920.6 on 9999 degrees of freedom Residual deviance: 1579.0 on 9997 degrees of freedom AIC: 1585 Number of Fisher Scoring iterations: 8 (Intercept) -26.5660685235383 income 9.0174230280541e-20 balance -3.21887798899407e-20 ORDINARY NONPARAMETRIC BOOTSTRAP Call: boot(data = Default, statistic = boot.fn, R = 1000) Bootstrap Statistics : original bias std. error t1* -1.154047e+01 -4.009952e-02 4.329822e-01 t2* 2.080898e-05 1.740632e-07 4.721751e-06 t3* 5.647103e-03 1.964705e-05 2.331222e-04 Call: glm(formula = default ~ income + balance, family = \"binomial\", data = Default) Deviance Residuals: Min 1Q Median 3Q Max -2.4725 -0.1444 -0.0574 -0.0211 3.7245 Coefficients: Estimate Std. Error z value Pr(>|z|) (Intercept) -1.154e+01 4.348e-01 -26.545 < 2e-16 *** income 2.081e-05 4.985e-06 4.174 2.99e-05 *** balance 5.647e-03 2.274e-04 24.836 < 2e-16 *** --- Signif. codes: 0 ‘***' 0.001 ‘**' 0.01 ‘*' 0.05 ‘.' 0.1 ‘ ' 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 2920.6 on 9999 degrees of freedom Residual deviance: 1579.0 on 9997 degrees of freedom AIC: 1585 Number of Fisher Scoring iterations: 8 As we can see above, the boot function found standard errors that were greater than the standard errors of the summary function. This makes sense, as the bootstrap method does not depend on estimates of the deviations of the error terms -- it simply samples observations repeatedly and creates models with them, and uses the difference between that and the full model to determine the standard error. So, as expected, the true standard error is likely larger than that given by the summary, since the summary is dependent on the type of model itself, while the bootstrap is not. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Model Validation","url":"category/model-validation/bootstrapping-exercise.html","loc":"category/model-validation/bootstrapping-exercise.html"},{"title":"Mixed Models vs GEE","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } This is an example using 'fake' data for the difference between lmer (which assumes a constant (independent) covariance matrix for the error terms) and geepack (general estimating equations, which can handle an unknown convariance structure)) This example highlights the power of using a GEE model over a HLM model when the covariance structure differs at different levels of the data. The GEE model can be seen as a population estimating model -- i.e., it is preferable when we are trying to make inferences about the population rather than the individuals in the sample. We do not explicitly parametrize over the groups -- instead, we assign some covariance structure between members of each group and find the marginal distribution. The problem is formulated as follows: consider 6 athletes with characteristics given by: In [1]: library ( lme4 ) library ( geepack ) Loading required package: Matrix In [2]: athlete <- c ( 1 , 1 , 1 , 2 , 2 , 2 , 2 , 3 , 3 , 3 , 4 , 4 , 4 , 5 , 5 , 6 , 6 , 6 ) age <- c ( 38 , 40 , 43 , 53 , 55 , 56 , 58 , 37 , 40 , 42 , 41 , 45 , 46 , 54 , 58 , 57 , 60 , 62 ) club <- c ( 0 , 0 , 1 , 1 , 1 , 1 , 1 , 1 , 1 , 0 , 0 , 1 , 0 , 1 , 1 , 1 , 1 , 1 ) time <- c ( 95 , 94 , 93 , 96 , 98 , 91 , 93 , 83 , 82 , 82 , 91 , 94 , 99 , 105 , 111 , 90 , 89 , 95 ) logtime <- log ( time ) This is an example of a repeated measures problem. We create a dataframe from these elements: In [3]: df <- data.frame ( athlete , age , club , time , logtime ) df athlete age club time logtime 1 38 0 95 4.553877 1 40 0 94 4.543295 1 43 1 93 4.532599 2 53 1 96 4.564348 2 55 1 98 4.584967 2 56 1 91 4.510860 2 58 1 93 4.532599 3 37 1 83 4.418841 3 40 1 82 4.406719 3 42 0 82 4.406719 4 41 0 91 4.510860 4 45 1 94 4.543295 4 46 0 99 4.595120 5 54 1 105 4.653960 5 58 1 111 4.709530 6 57 1 90 4.499810 6 60 1 89 4.488636 6 62 1 95 4.553877 Now, we want to estimate the (log) time based on age and club. However, the data is clearly correlated -- each individual will have different specifications. Consider that we believe that the average (log) time will be different for each individual, as a baseline. This is a mixed model more specifically a Random Intercept model. This is highlighted by the following equations. In [4]: mod1 <- lmer ( logtime ~ club + log ( age ) + ( 1 | athlete ), data = df , REML = FALSE ) mod2 <- lmer ( logtime ~ log ( age ) + ( 1 | athlete ), data = df , REML = FALSE ) summary ( mod1 ) summary ( mod2 ) Linear mixed model fit by maximum likelihood ['lmerMod'] Formula: logtime ~ club + log(age) + (1 | athlete) Data: df AIC BIC logLik deviance df.resid -49.2 -44.7 29.6 -59.2 13 Scaled residuals: Min 1Q Median 3Q Max -1.3445 -0.7551 -0.1840 0.7895 1.2651 Random effects: Groups Name Variance Std.Dev. athlete (Intercept) 0.0042173 0.06494 Residual 0.0008858 0.02976 Number of obs: 18, groups: athlete, 6 Fixed effects: Estimate Std. Error t value (Intercept) 3.78158 0.45714 8.272 club -0.01049 0.02101 -0.499 log(age) 0.19753 0.11837 1.669 Correlation of Fixed Effects: (Intr) club club 0.184 log(age) -0.998 -0.216 Linear mixed model fit by maximum likelihood ['lmerMod'] Formula: logtime ~ log(age) + (1 | athlete) Data: df AIC BIC logLik deviance df.resid -50.9 -47.4 29.5 -58.9 14 Scaled residuals: Min 1Q Median 3Q Max -1.3343 -0.6924 -0.3215 0.7936 1.2927 Random effects: Groups Name Variance Std.Dev. athlete (Intercept) 0.0042948 0.06554 Residual 0.0008962 0.02994 Number of obs: 18, groups: athlete, 6 Fixed effects: Estimate Std. Error t value (Intercept) 3.8241 0.4527 8.448 log(age) 0.1846 0.1164 1.586 Correlation of Fixed Effects: (Intr) log(age) -0.998 However, this assumes that the covariance structure of the errors at each level are independent. This assumption is too simplifying -- it is likely that the variables are correlated across individuals (for instance, it appears that the clubs are for particular age ranges). To account for this, we could add more random effects to the model (which would subsequently break the data down into even smaller groups), or we could use a GEE to forgo the subject-level estimations and estimate on the populations, assuming some covariance structure between groups. In [5]: mod3 <- geeglm ( logtime ~ club + log ( age ), data = df , id = athlete , family = gaussian , corstr = \"exchangeable\" ) mod4 <- geeglm ( logtime ~ log ( age ), data = df , id = athlete , family = gaussian , corstr = \"exchangeable\" ) summary ( mod3 ) summary ( mod4 ) Call: geeglm(formula = logtime ~ club + log(age), family = gaussian, data = df, id = athlete, corstr = \"exchangeable\") Coefficients: Estimate Std.err Wald Pr(>|W|) (Intercept) 3.67345 0.42962 73.109 <2e-16 *** club -0.01429 0.01422 1.010 0.3149 log(age) 0.22584 0.11276 4.011 0.0452 * --- Signif. codes: 0 ‘***' 0.001 ‘**' 0.01 ‘*' 0.05 ‘.' 0.1 ‘ ' 1 Estimated Scale Parameters: Estimate Std.err (Intercept) 0.004443 0.001609 Correlation: Structure = exchangeable Link = identity Estimated Correlation Parameters: Estimate Std.err alpha 0.6112 0.1829 Number of clusters: 6 Maximum cluster size: 4 Call: geeglm(formula = logtime ~ log(age), family = gaussian, data = df, id = athlete, corstr = \"exchangeable\") Coefficients: Estimate Std.err Wald Pr(>|W|) (Intercept) 3.742 0.488 58.84 1.7e-14 *** log(age) 0.206 0.127 2.61 0.11 --- Signif. codes: 0 ‘***' 0.001 ‘**' 0.01 ‘*' 0.05 ‘.' 0.1 ‘ ' 1 Estimated Scale Parameters: Estimate Std.err (Intercept) 0.00458 0.00154 Correlation: Structure = exchangeable Link = identity Estimated Correlation Parameters: Estimate Std.err alpha 0.624 0.181 Number of clusters: 6 Maximum cluster size: 4 The main shift in inference here is from likelihood models (which are generally prefered) to a semi-parametric model that depends only on the first two moments. GEEs are better estimators of a population-level variance -- they cannot account for individual differences explicitly, as a GLMM could. In this example, however, we see that the GEE finds the log(age) value significant where the previous model had not. Depending on the goal of the analysis, the GEE will produce better estimates asymptotically at the cost of sample-level inference. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Linear Models","url":"category/linear-models/mixed-models-vs-gee.html","loc":"category/linear-models/mixed-models-vs-gee.html"}]};